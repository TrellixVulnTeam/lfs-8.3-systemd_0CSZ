Running from installcheck: no
Test Protocol: tap
PATH = /sources/automake-1.16.1/bin:/sources/automake-1.16.1/t/ax:/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin
++ pwd
/sources/automake-1.16.1/t/add-missing.dir
+ plan_ later
+ test 1 -eq 0
+ test 1 -ge 2
+ test xnone '!=' xnone
+ test xlater = xunknown
+ test xlater = xlater
+ planned_=later
+ return 0
+ build_aux=build-aux
++ pwd
+ ocwd=/sources/automake-1.16.1/t/add-missing.dir
+ diff -u /dev/null /dev/null
+ am_diff='diff -u'
+ echo dummy
+ ln -s foo bar
+ test -h bar
+ have_true_symlinks=yes
+ rm -f foo bar
+ cat
+ cat configure.stub -
+ aclocal-1.16 -Werror
configure.ac:8: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:8: the top level
+ rm -rf configure.ac autom4te.cache
+ mv aclocal.m4 aclocal.stub
+ cat configure.stub
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
+ cat aclocal.stub
# generated automatically by aclocal 1.16.1 -*- Autoconf -*-

# Copyright (C) 1996-2018 Free Software Foundation, Inc.

# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.

m4_ifndef([AC_CONFIG_MACRO_DIRS], [m4_defun([_AM_CONFIG_MACRO_DIRS], [])m4_defun([AC_CONFIG_MACRO_DIRS], [_AM_CONFIG_MACRO_DIRS($@)])])
m4_ifndef([AC_AUTOCONF_VERSION],
  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
m4_if(m4_defn([AC_AUTOCONF_VERSION]), [2.69],,
[m4_warning([this file was generated for autoconf 2.69.
You have another version of autoconf.  It may work, but is not guaranteed to.
If you have problems, you may need to regenerate the build system entirely.
To do so, use the procedure documented by the package, typically 'autoreconf'.])])

# Copyright (C) 2002-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_AUTOMAKE_VERSION(VERSION)
# ----------------------------
# Automake X.Y traces this macro to ensure aclocal.m4 has been
# generated from the m4 files accompanying Automake X.Y.
# (This private macro should not be called outside this file.)
AC_DEFUN([AM_AUTOMAKE_VERSION],
[am__api_version='1.16'
dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
dnl require some minimum version.  Point them to the right macro.
m4_if([$1], [1.16.1], [],
      [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
])

# _AM_AUTOCONF_VERSION(VERSION)
# -----------------------------
# aclocal traces this macro to find the Autoconf version.
# This is a private macro too.  Using m4_define simplifies
# the logic in aclocal, which can simply ignore this definition.
m4_define([_AM_AUTOCONF_VERSION], [])

# AM_SET_CURRENT_AUTOMAKE_VERSION
# -------------------------------
# Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
# This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
[AM_AUTOMAKE_VERSION([1.16.1])dnl
m4_ifndef([AC_AUTOCONF_VERSION],
  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
_AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])

# AM_AUX_DIR_EXPAND                                         -*- Autoconf -*-

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# For projects using AC_CONFIG_AUX_DIR([foo]), Autoconf sets
# $ac_aux_dir to '$srcdir/foo'.  In other projects, it is set to
# '$srcdir', '$srcdir/..', or '$srcdir/../..'.
#
# Of course, Automake must honor this variable whenever it calls a
# tool from the auxiliary directory.  The problem is that $srcdir (and
# therefore $ac_aux_dir as well) can be either absolute or relative,
# depending on how configure is run.  This is pretty annoying, since
# it makes $ac_aux_dir quite unusable in subdirectories: in the top
# source directory, any form will work fine, but in subdirectories a
# relative path needs to be adjusted first.
#
# $ac_aux_dir/missing
#    fails when called from a subdirectory if $ac_aux_dir is relative
# $top_srcdir/$ac_aux_dir/missing
#    fails if $ac_aux_dir is absolute,
#    fails when called from a subdirectory in a VPATH build with
#          a relative $ac_aux_dir
#
# The reason of the latter failure is that $top_srcdir and $ac_aux_dir
# are both prefixed by $srcdir.  In an in-source build this is usually
# harmless because $srcdir is '.', but things will broke when you
# start a VPATH build or use an absolute $srcdir.
#
# So we could use something similar to $top_srcdir/$ac_aux_dir/missing,
# iff we strip the leading $srcdir from $ac_aux_dir.  That would be:
#   am_aux_dir='\$(top_srcdir)/'`expr "$ac_aux_dir" : "$srcdir//*\(.*\)"`
# and then we would define $MISSING as
#   MISSING="\${SHELL} $am_aux_dir/missing"
# This will work as long as MISSING is not called from configure, because
# unfortunately $(top_srcdir) has no meaning in configure.
# However there are other variables, like CC, which are often used in
# configure, and could therefore not use this "fixed" $ac_aux_dir.
#
# Another solution, used here, is to always expand $ac_aux_dir to an
# absolute PATH.  The drawback is that using absolute paths prevent a
# configured tree to be moved without reconfiguration.

AC_DEFUN([AM_AUX_DIR_EXPAND],
[AC_REQUIRE([AC_CONFIG_AUX_DIR_DEFAULT])dnl
# Expand $ac_aux_dir to an absolute path.
am_aux_dir=`cd "$ac_aux_dir" && pwd`
])

# AM_CONDITIONAL                                            -*- Autoconf -*-

# Copyright (C) 1997-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_CONDITIONAL(NAME, SHELL-CONDITION)
# -------------------------------------
# Define a conditional.
AC_DEFUN([AM_CONDITIONAL],
[AC_PREREQ([2.52])dnl
 m4_if([$1], [TRUE],  [AC_FATAL([$0: invalid condition: $1])],
       [$1], [FALSE], [AC_FATAL([$0: invalid condition: $1])])dnl
AC_SUBST([$1_TRUE])dnl
AC_SUBST([$1_FALSE])dnl
_AM_SUBST_NOTMAKE([$1_TRUE])dnl
_AM_SUBST_NOTMAKE([$1_FALSE])dnl
m4_define([_AM_COND_VALUE_$1], [$2])dnl
if $2; then
  $1_TRUE=
  $1_FALSE='#'
else
  $1_TRUE='#'
  $1_FALSE=
fi
AC_CONFIG_COMMANDS_PRE(
[if test -z "${$1_TRUE}" && test -z "${$1_FALSE}"; then
  AC_MSG_ERROR([[conditional "$1" was never defined.
Usually this means the macro was only invoked conditionally.]])
fi])])

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.


# There are a few dirty hacks below to avoid letting 'AC_PROG_CC' be
# written in clear, in which case automake, when reading aclocal.m4,
# will think it sees a *use*, and therefore will trigger all it's
# C support machinery.  Also note that it means that autoscan, seeing
# CC etc. in the Makefile, will ask for an AC_PROG_CC use...


# _AM_DEPENDENCIES(NAME)
# ----------------------
# See how the compiler implements dependency checking.
# NAME is "CC", "CXX", "OBJC", "OBJCXX", "UPC", or "GJC".
# We try a few techniques and use that to set a single cache variable.
#
# We don't AC_REQUIRE the corresponding AC_PROG_CC since the latter was
# modified to invoke _AM_DEPENDENCIES(CC); we would have a circular
# dependency, and given that the user is not expected to run this macro,
# just rely on AC_PROG_CC.
AC_DEFUN([_AM_DEPENDENCIES],
[AC_REQUIRE([AM_SET_DEPDIR])dnl
AC_REQUIRE([AM_OUTPUT_DEPENDENCY_COMMANDS])dnl
AC_REQUIRE([AM_MAKE_INCLUDE])dnl
AC_REQUIRE([AM_DEP_TRACK])dnl

m4_if([$1], [CC],   [depcc="$CC"   am_compiler_list=],
      [$1], [CXX],  [depcc="$CXX"  am_compiler_list=],
      [$1], [OBJC], [depcc="$OBJC" am_compiler_list='gcc3 gcc'],
      [$1], [OBJCXX], [depcc="$OBJCXX" am_compiler_list='gcc3 gcc'],
      [$1], [UPC],  [depcc="$UPC"  am_compiler_list=],
      [$1], [GCJ],  [depcc="$GCJ"  am_compiler_list='gcc3 gcc'],
                    [depcc="$$1"   am_compiler_list=])

AC_CACHE_CHECK([dependency style of $depcc],
               [am_cv_$1_dependencies_compiler_type],
[if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
  # We make a subdir and do the tests there.  Otherwise we can end up
  # making bogus files that we don't know about and never remove.  For
  # instance it was reported that on HP-UX the gcc test will end up
  # making a dummy file named 'D' -- because '-MD' means "put the output
  # in D".
  rm -rf conftest.dir
  mkdir conftest.dir
  # Copy depcomp to subdir because otherwise we won't find it if we're
  # using a relative directory.
  cp "$am_depcomp" conftest.dir
  cd conftest.dir
  # We will build objects and dependencies in a subdirectory because
  # it helps to detect inapplicable dependency modes.  For instance
  # both Tru64's cc and ICC support -MD to output dependencies as a
  # side effect of compilation, but ICC will put the dependencies in
  # the current directory while Tru64 will put them in the object
  # directory.
  mkdir sub

  am_cv_$1_dependencies_compiler_type=none
  if test "$am_compiler_list" = ""; then
     am_compiler_list=`sed -n ['s/^#*\([a-zA-Z0-9]*\))$/\1/p'] < ./depcomp`
  fi
  am__universal=false
  m4_case([$1], [CC],
    [case " $depcc " in #(
     *\ -arch\ *\ -arch\ *) am__universal=true ;;
     esac],
    [CXX],
    [case " $depcc " in #(
     *\ -arch\ *\ -arch\ *) am__universal=true ;;
     esac])

  for depmode in $am_compiler_list; do
    # Setup a source with many dependencies, because some compilers
    # like to wrap large dependency lists on column 80 (with \), and
    # we should not choose a depcomp mode which is confused by this.
    #
    # We need to recreate these files for each test, as the compiler may
    # overwrite some of them when testing with obscure command lines.
    # This happens at least with the AIX C compiler.
    : > sub/conftest.c
    for i in 1 2 3 4 5 6; do
      echo '#include "conftst'$i'.h"' >> sub/conftest.c
      # Using ": > sub/conftst$i.h" creates only sub/conftst1.h with
      # Solaris 10 /bin/sh.
      echo '/* dummy */' > sub/conftst$i.h
    done
    echo "${am__include} ${am__quote}sub/conftest.Po${am__quote}" > confmf

    # We check with '-c' and '-o' for the sake of the "dashmstdout"
    # mode.  It turns out that the SunPro C++ compiler does not properly
    # handle '-M -o', and we need to detect this.  Also, some Intel
    # versions had trouble with output in subdirs.
    am__obj=sub/conftest.${OBJEXT-o}
    am__minus_obj="-o $am__obj"
    case $depmode in
    gcc)
      # This depmode causes a compiler race in universal mode.
      test "$am__universal" = false || continue
      ;;
    nosideeffect)
      # After this tag, mechanisms are not by side-effect, so they'll
      # only be used when explicitly requested.
      if test "x$enable_dependency_tracking" = xyes; then
	continue
      else
	break
      fi
      ;;
    msvc7 | msvc7msys | msvisualcpp | msvcmsys)
      # This compiler won't grok '-c -o', but also, the minuso test has
      # not run yet.  These depmodes are late enough in the game, and
      # so weak that their functioning should not be impacted.
      am__obj=conftest.${OBJEXT-o}
      am__minus_obj=
      ;;
    none) break ;;
    esac
    if depmode=$depmode \
       source=sub/conftest.c object=$am__obj \
       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
       $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
         >/dev/null 2>conftest.err &&
       grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
       grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
       grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
      # icc doesn't choke on unknown options, it will just issue warnings
      # or remarks (even with -Werror).  So we grep stderr for any message
      # that says an option was ignored or not supported.
      # When given -MP, icc 7.0 and 7.1 complain thusly:
      #   icc: Command line warning: ignoring option '-M'; no argument required
      # The diagnosis changed in icc 8.0:
      #   icc: Command line remark: option '-MP' not supported
      if (grep 'ignoring option' conftest.err ||
          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else
        am_cv_$1_dependencies_compiler_type=$depmode
        break
      fi
    fi
  done

  cd ..
  rm -rf conftest.dir
else
  am_cv_$1_dependencies_compiler_type=none
fi
])
AC_SUBST([$1DEPMODE], [depmode=$am_cv_$1_dependencies_compiler_type])
AM_CONDITIONAL([am__fastdep$1], [
  test "x$enable_dependency_tracking" != xno \
  && test "$am_cv_$1_dependencies_compiler_type" = gcc3])
])


# AM_SET_DEPDIR
# -------------
# Choose a directory name for dependency files.
# This macro is AC_REQUIREd in _AM_DEPENDENCIES.
AC_DEFUN([AM_SET_DEPDIR],
[AC_REQUIRE([AM_SET_LEADING_DOT])dnl
AC_SUBST([DEPDIR], ["${am__leading_dot}deps"])dnl
])


# AM_DEP_TRACK
# ------------
AC_DEFUN([AM_DEP_TRACK],
[AC_ARG_ENABLE([dependency-tracking], [dnl
AS_HELP_STRING(
  [--enable-dependency-tracking],
  [do not reject slow dependency extractors])
AS_HELP_STRING(
  [--disable-dependency-tracking],
  [speeds up one-time build])])
if test "x$enable_dependency_tracking" != xno; then
  am_depcomp="$ac_aux_dir/depcomp"
  AMDEPBACKSLASH='\'
  am__nodep='_no'
fi
AM_CONDITIONAL([AMDEP], [test "x$enable_dependency_tracking" != xno])
AC_SUBST([AMDEPBACKSLASH])dnl
_AM_SUBST_NOTMAKE([AMDEPBACKSLASH])dnl
AC_SUBST([am__nodep])dnl
_AM_SUBST_NOTMAKE([am__nodep])dnl
])

# Generate code to set up dependency tracking.              -*- Autoconf -*-

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_OUTPUT_DEPENDENCY_COMMANDS
# ------------------------------
AC_DEFUN([_AM_OUTPUT_DEPENDENCY_COMMANDS],
[{
  # Older Autoconf quotes --file arguments for eval, but not when files
  # are listed without --file.  Let's play safe and only enable the eval
  # if we detect the quoting.
  # TODO: see whether this extra hack can be removed once we start
  # requiring Autoconf 2.70 or later.
  AS_CASE([$CONFIG_FILES],
          [*\'*], [eval set x "$CONFIG_FILES"],
          [*], [set x $CONFIG_FILES])
  shift
  # Used to flag and report bootstrapping failures.
  am_rc=0
  for am_mf
  do
    # Strip MF so we end up with the name of the file.
    am_mf=`AS_ECHO(["$am_mf"]) | sed -e 's/:.*$//'`
    # Check whether this is an Automake generated Makefile which includes
    # dependency-tracking related rules and includes.
    # Grep'ing the whole file directly is not great: AIX grep has a line
    # limit of 2048, but all sed's we know have understand at least 4000.
    sed -n 's,^am--depfiles:.*,X,p' "$am_mf" | grep X >/dev/null 2>&1 \
      || continue
    am_dirpart=`AS_DIRNAME(["$am_mf"])`
    am_filepart=`AS_BASENAME(["$am_mf"])`
    AM_RUN_LOG([cd "$am_dirpart" \
      && sed -e '/# am--include-marker/d' "$am_filepart" \
        | $MAKE -f - am--depfiles]) || am_rc=$?
  done
  if test $am_rc -ne 0; then
    AC_MSG_FAILURE([Something went wrong bootstrapping makefile fragments
    for automatic dependency tracking.  Try re-running configure with the
    '--disable-dependency-tracking' option to at least be able to build
    the package (albeit without support for automatic dependency tracking).])
  fi
  AS_UNSET([am_dirpart])
  AS_UNSET([am_filepart])
  AS_UNSET([am_mf])
  AS_UNSET([am_rc])
  rm -f conftest-deps.mk
}
])# _AM_OUTPUT_DEPENDENCY_COMMANDS


# AM_OUTPUT_DEPENDENCY_COMMANDS
# -----------------------------
# This macro should only be invoked once -- use via AC_REQUIRE.
#
# This code is only required when automatic dependency tracking is enabled.
# This creates each '.Po' and '.Plo' makefile fragment that we'll need in
# order to bootstrap the dependency handling code.
AC_DEFUN([AM_OUTPUT_DEPENDENCY_COMMANDS],
[AC_CONFIG_COMMANDS([depfiles],
     [test x"$AMDEP_TRUE" != x"" || _AM_OUTPUT_DEPENDENCY_COMMANDS],
     [AMDEP_TRUE="$AMDEP_TRUE" MAKE="${MAKE-make}"])])

# Do all the work for Automake.                             -*- Autoconf -*-

# Copyright (C) 1996-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This macro actually does too much.  Some checks are only needed if
# your package does certain things.  But this isn't really a big deal.

dnl Redefine AC_PROG_CC to automatically invoke _AM_PROG_CC_C_O.
m4_define([AC_PROG_CC],
m4_defn([AC_PROG_CC])
[_AM_PROG_CC_C_O
])

# AM_INIT_AUTOMAKE(PACKAGE, VERSION, [NO-DEFINE])
# AM_INIT_AUTOMAKE([OPTIONS])
# -----------------------------------------------
# The call with PACKAGE and VERSION arguments is the old style
# call (pre autoconf-2.50), which is being phased out.  PACKAGE
# and VERSION should now be passed to AC_INIT and removed from
# the call to AM_INIT_AUTOMAKE.
# We support both call styles for the transition.  After
# the next Automake release, Autoconf can make the AC_INIT
# arguments mandatory, and then we can depend on a new Autoconf
# release and drop the old call support.
AC_DEFUN([AM_INIT_AUTOMAKE],
[AC_PREREQ([2.65])dnl
dnl Autoconf wants to disallow AM_ names.  We explicitly allow
dnl the ones we care about.
m4_pattern_allow([^AM_[A-Z]+FLAGS$])dnl
AC_REQUIRE([AM_SET_CURRENT_AUTOMAKE_VERSION])dnl
AC_REQUIRE([AC_PROG_INSTALL])dnl
if test "`cd $srcdir && pwd`" != "`pwd`"; then
  # Use -I$(srcdir) only when $(srcdir) != ., so that make's output
  # is not polluted with repeated "-I."
  AC_SUBST([am__isrc], [' -I$(srcdir)'])_AM_SUBST_NOTMAKE([am__isrc])dnl
  # test to see if srcdir already configured
  if test -f $srcdir/config.status; then
    AC_MSG_ERROR([source directory already configured; run "make distclean" there first])
  fi
fi

# test whether we have cygpath
if test -z "$CYGPATH_W"; then
  if (cygpath --version) >/dev/null 2>/dev/null; then
    CYGPATH_W='cygpath -w'
  else
    CYGPATH_W=echo
  fi
fi
AC_SUBST([CYGPATH_W])

# Define the identity of the package.
dnl Distinguish between old-style and new-style calls.
m4_ifval([$2],
[AC_DIAGNOSE([obsolete],
             [$0: two- and three-arguments forms are deprecated.])
m4_ifval([$3], [_AM_SET_OPTION([no-define])])dnl
 AC_SUBST([PACKAGE], [$1])dnl
 AC_SUBST([VERSION], [$2])],
[_AM_SET_OPTIONS([$1])dnl
dnl Diagnose old-style AC_INIT with new-style AM_AUTOMAKE_INIT.
m4_if(
  m4_ifdef([AC_PACKAGE_NAME], [ok]):m4_ifdef([AC_PACKAGE_VERSION], [ok]),
  [ok:ok],,
  [m4_fatal([AC_INIT should be called with package and version arguments])])dnl
 AC_SUBST([PACKAGE], ['AC_PACKAGE_TARNAME'])dnl
 AC_SUBST([VERSION], ['AC_PACKAGE_VERSION'])])dnl

_AM_IF_OPTION([no-define],,
[AC_DEFINE_UNQUOTED([PACKAGE], ["$PACKAGE"], [Name of package])
 AC_DEFINE_UNQUOTED([VERSION], ["$VERSION"], [Version number of package])])dnl

# Some tools Automake needs.
AC_REQUIRE([AM_SANITY_CHECK])dnl
AC_REQUIRE([AC_ARG_PROGRAM])dnl
AM_MISSING_PROG([ACLOCAL], [aclocal-${am__api_version}])
AM_MISSING_PROG([AUTOCONF], [autoconf])
AM_MISSING_PROG([AUTOMAKE], [automake-${am__api_version}])
AM_MISSING_PROG([AUTOHEADER], [autoheader])
AM_MISSING_PROG([MAKEINFO], [makeinfo])
AC_REQUIRE([AM_PROG_INSTALL_SH])dnl
AC_REQUIRE([AM_PROG_INSTALL_STRIP])dnl
AC_REQUIRE([AC_PROG_MKDIR_P])dnl
# For better backward compatibility.  To be removed once Automake 1.9.x
# dies out for good.  For more background, see:
# <https://lists.gnu.org/archive/html/automake/2012-07/msg00001.html>
# <https://lists.gnu.org/archive/html/automake/2012-07/msg00014.html>
AC_SUBST([mkdir_p], ['$(MKDIR_P)'])
# We need awk for the "check" target (and possibly the TAP driver).  The
# system "awk" is bad on some platforms.
AC_REQUIRE([AC_PROG_AWK])dnl
AC_REQUIRE([AC_PROG_MAKE_SET])dnl
AC_REQUIRE([AM_SET_LEADING_DOT])dnl
_AM_IF_OPTION([tar-ustar], [_AM_PROG_TAR([ustar])],
	      [_AM_IF_OPTION([tar-pax], [_AM_PROG_TAR([pax])],
			     [_AM_PROG_TAR([v7])])])
_AM_IF_OPTION([no-dependencies],,
[AC_PROVIDE_IFELSE([AC_PROG_CC],
		  [_AM_DEPENDENCIES([CC])],
		  [m4_define([AC_PROG_CC],
			     m4_defn([AC_PROG_CC])[_AM_DEPENDENCIES([CC])])])dnl
AC_PROVIDE_IFELSE([AC_PROG_CXX],
		  [_AM_DEPENDENCIES([CXX])],
		  [m4_define([AC_PROG_CXX],
			     m4_defn([AC_PROG_CXX])[_AM_DEPENDENCIES([CXX])])])dnl
AC_PROVIDE_IFELSE([AC_PROG_OBJC],
		  [_AM_DEPENDENCIES([OBJC])],
		  [m4_define([AC_PROG_OBJC],
			     m4_defn([AC_PROG_OBJC])[_AM_DEPENDENCIES([OBJC])])])dnl
AC_PROVIDE_IFELSE([AC_PROG_OBJCXX],
		  [_AM_DEPENDENCIES([OBJCXX])],
		  [m4_define([AC_PROG_OBJCXX],
			     m4_defn([AC_PROG_OBJCXX])[_AM_DEPENDENCIES([OBJCXX])])])dnl
])
AC_REQUIRE([AM_SILENT_RULES])dnl
dnl The testsuite driver may need to know about EXEEXT, so add the
dnl 'am__EXEEXT' conditional if _AM_COMPILER_EXEEXT was seen.  This
dnl macro is hooked onto _AC_COMPILER_EXEEXT early, see below.
AC_CONFIG_COMMANDS_PRE(dnl
[m4_provide_if([_AM_COMPILER_EXEEXT],
  [AM_CONDITIONAL([am__EXEEXT], [test -n "$EXEEXT"])])])dnl

# POSIX will say in a future version that running "rm -f" with no argument
# is OK; and we want to be able to make that assumption in our Makefile
# recipes.  So use an aggressive probe to check that the usage we want is
# actually supported "in the wild" to an acceptable degree.
# See automake bug#10828.
# To make any issue more visible, cause the running configure to be aborted
# by default if the 'rm' program in use doesn't match our expectations; the
# user can still override this though.
if rm -f && rm -fr && rm -rf; then : OK; else
  cat >&2 <<'END'
Oops!

Your 'rm' program seems unable to run without file operands specified
on the command line, even when the '-f' option is present.  This is contrary
to the behaviour of most rm programs out there, and not conforming with
the upcoming POSIX standard: <http://austingroupbugs.net/view.php?id=542>

Please tell bug-automake@gnu.org about your system, including the value
of your $PATH and any error possibly output before this message.  This
can help us improve future automake versions.

END
  if test x"$ACCEPT_INFERIOR_RM_PROGRAM" = x"yes"; then
    echo 'Configuration will proceed anyway, since you have set the' >&2
    echo 'ACCEPT_INFERIOR_RM_PROGRAM variable to "yes"' >&2
    echo >&2
  else
    cat >&2 <<'END'
Aborting the configuration process, to ensure you take notice of the issue.

You can download and install GNU coreutils to get an 'rm' implementation
that behaves properly: <https://www.gnu.org/software/coreutils/>.

If you want to complete the configuration process using your problematic
'rm' anyway, export the environment variable ACCEPT_INFERIOR_RM_PROGRAM
to "yes", and re-run configure.

END
    AC_MSG_ERROR([Your 'rm' program is bad, sorry.])
  fi
fi
dnl The trailing newline in this macro's definition is deliberate, for
dnl backward compatibility and to allow trailing 'dnl'-style comments
dnl after the AM_INIT_AUTOMAKE invocation. See automake bug#16841.
])

dnl Hook into '_AC_COMPILER_EXEEXT' early to learn its expansion.  Do not
dnl add the conditional right here, as _AC_COMPILER_EXEEXT may be further
dnl mangled by Autoconf and run in a shell conditional statement.
m4_define([_AC_COMPILER_EXEEXT],
m4_defn([_AC_COMPILER_EXEEXT])[m4_provide([_AM_COMPILER_EXEEXT])])

# When config.status generates a header, we must update the stamp-h file.
# This file resides in the same directory as the config header
# that is generated.  The stamp files are numbered to have different names.

# Autoconf calls _AC_AM_CONFIG_HEADER_HOOK (when defined) in the
# loop where config.status creates the headers, so we can generate
# our stamp files there.
AC_DEFUN([_AC_AM_CONFIG_HEADER_HOOK],
[# Compute $1's index in $config_headers.
_am_arg=$1
_am_stamp_count=1
for _am_header in $config_headers :; do
  case $_am_header in
    $_am_arg | $_am_arg:* )
      break ;;
    * )
      _am_stamp_count=`expr $_am_stamp_count + 1` ;;
  esac
done
echo "timestamp for $_am_arg" >`AS_DIRNAME(["$_am_arg"])`/stamp-h[]$_am_stamp_count])

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_PROG_INSTALL_SH
# ------------------
# Define $install_sh.
AC_DEFUN([AM_PROG_INSTALL_SH],
[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
if test x"${install_sh+set}" != xset; then
  case $am_aux_dir in
  *\ * | *\	*)
    install_sh="\${SHELL} '$am_aux_dir/install-sh'" ;;
  *)
    install_sh="\${SHELL} $am_aux_dir/install-sh"
  esac
fi
AC_SUBST([install_sh])])

# Copyright (C) 2003-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# Check whether the underlying file-system supports filenames
# with a leading dot.  For instance MS-DOS doesn't.
AC_DEFUN([AM_SET_LEADING_DOT],
[rm -rf .tst 2>/dev/null
mkdir .tst 2>/dev/null
if test -d .tst; then
  am__leading_dot=.
else
  am__leading_dot=_
fi
rmdir .tst 2>/dev/null
AC_SUBST([am__leading_dot])])

# Copyright (C) 1996-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_PATH_LISPDIR
# ---------------
AC_DEFUN([AM_PATH_LISPDIR],
[AC_PREREQ([2.60])dnl
 # If set to t, that means we are running in a shell under Emacs.
 # If you have an Emacs named "t", then use the full path.
 test x"$EMACS" = xt && EMACS=
 AC_CHECK_PROGS([EMACS], [emacs xemacs], [no])
 AC_ARG_VAR([EMACS], [the Emacs editor command])
 AC_ARG_VAR([EMACSLOADPATH], [the Emacs library search path])
 AC_ARG_WITH([lispdir],
 [AS_HELP_STRING([--with-lispdir],
                 [override the default lisp directory])],
 [ lispdir="$withval"
   AC_MSG_CHECKING([where .elc files should go])
   AC_MSG_RESULT([$lispdir])],
 [
 AC_CACHE_CHECK([where .elc files should go], [am_cv_lispdir], [
   if test $EMACS != "no"; then
     if test x${lispdir+set} != xset; then
  # If $EMACS isn't GNU Emacs or XEmacs, this can blow up pretty badly
  # Some emacsen will start up in interactive mode, requiring C-x C-c to exit,
  #  which is non-obvious for non-emacs users.
  # Redirecting /dev/null should help a bit; pity we can't detect "broken"
  #  emacsen earlier and avoid running this altogether.
  AC_RUN_LOG([$EMACS -batch -Q -eval '(while load-path (princ (concat (car load-path) "\n")) (setq load-path (cdr load-path)))' </dev/null >conftest.out])
	am_cv_lispdir=`sed -n \
       -e 's,/$,,' \
       -e '/.*\/lib\/x*emacs\/site-lisp$/{s,.*/lib/\(x*emacs/site-lisp\)$,${libdir}/\1,;p;q;}' \
       -e '/.*\/share\/x*emacs\/site-lisp$/{s,.*/share/\(x*emacs/site-lisp\),${datarootdir}/\1,;p;q;}' \
       conftest.out`
       rm conftest.out
     fi
   fi
   test -z "$am_cv_lispdir" && am_cv_lispdir='${datadir}/emacs/site-lisp'
  ])
  lispdir="$am_cv_lispdir"
])
AC_SUBST([lispdir])
])# AM_PATH_LISPDIR

# Check to see how 'make' treats includes.	            -*- Autoconf -*-

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_MAKE_INCLUDE()
# -----------------
# Check whether make has an 'include' directive that can support all
# the idioms we need for our automatic dependency tracking code.
AC_DEFUN([AM_MAKE_INCLUDE],
[AC_MSG_CHECKING([whether ${MAKE-make} supports the include directive])
cat > confinc.mk << 'END'
am__doit:
	@echo this is the am__doit target >confinc.out
.PHONY: am__doit
END
am__include="#"
am__quote=
# BSD make does it like this.
echo '.include "confinc.mk" # ignored' > confmf.BSD
# Other make implementations (GNU, Solaris 10, AIX) do it like this.
echo 'include confinc.mk # ignored' > confmf.GNU
_am_result=no
for s in GNU BSD; do
  AM_RUN_LOG([${MAKE-make} -f confmf.$s && cat confinc.out])
  AS_CASE([$?:`cat confinc.out 2>/dev/null`],
      ['0:this is the am__doit target'],
      [AS_CASE([$s],
          [BSD], [am__include='.include' am__quote='"'],
          [am__include='include' am__quote=''])])
  if test "$am__include" != "#"; then
    _am_result="yes ($s style)"
    break
  fi
done
rm -f confinc.* confmf.*
AC_MSG_RESULT([${_am_result}])
AC_SUBST([am__include])])
AC_SUBST([am__quote])])

# Fake the existence of programs that GNU maintainers use.  -*- Autoconf -*-

# Copyright (C) 1997-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_MISSING_PROG(NAME, PROGRAM)
# ------------------------------
AC_DEFUN([AM_MISSING_PROG],
[AC_REQUIRE([AM_MISSING_HAS_RUN])
$1=${$1-"${am_missing_run}$2"}
AC_SUBST($1)])

# AM_MISSING_HAS_RUN
# ------------------
# Define MISSING if not defined so far and test if it is modern enough.
# If it is, set am_missing_run to use it, otherwise, to nothing.
AC_DEFUN([AM_MISSING_HAS_RUN],
[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
AC_REQUIRE_AUX_FILE([missing])dnl
if test x"${MISSING+set}" != xset; then
  case $am_aux_dir in
  *\ * | *\	*)
    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
  *)
    MISSING="\${SHELL} $am_aux_dir/missing" ;;
  esac
fi
# Use eval to expand $SHELL
if eval "$MISSING --is-lightweight"; then
  am_missing_run="$MISSING "
else
  am_missing_run=
  AC_MSG_WARN(['missing' script is too old or missing])
fi
])

# Helper functions for option handling.                     -*- Autoconf -*-

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_MANGLE_OPTION(NAME)
# -----------------------
AC_DEFUN([_AM_MANGLE_OPTION],
[[_AM_OPTION_]m4_bpatsubst($1, [[^a-zA-Z0-9_]], [_])])

# _AM_SET_OPTION(NAME)
# --------------------
# Set option NAME.  Presently that only means defining a flag for this option.
AC_DEFUN([_AM_SET_OPTION],
[m4_define(_AM_MANGLE_OPTION([$1]), [1])])

# _AM_SET_OPTIONS(OPTIONS)
# ------------------------
# OPTIONS is a space-separated list of Automake options.
AC_DEFUN([_AM_SET_OPTIONS],
[m4_foreach_w([_AM_Option], [$1], [_AM_SET_OPTION(_AM_Option)])])

# _AM_IF_OPTION(OPTION, IF-SET, [IF-NOT-SET])
# -------------------------------------------
# Execute IF-SET if OPTION is set, IF-NOT-SET otherwise.
AC_DEFUN([_AM_IF_OPTION],
[m4_ifset(_AM_MANGLE_OPTION([$1]), [$2], [$3])])

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_PROG_CC_C_O
# ---------------
# Like AC_PROG_CC_C_O, but changed for automake.  We rewrite AC_PROG_CC
# to automatically call this.
AC_DEFUN([_AM_PROG_CC_C_O],
[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
AC_REQUIRE_AUX_FILE([compile])dnl
AC_LANG_PUSH([C])dnl
AC_CACHE_CHECK(
  [whether $CC understands -c and -o together],
  [am_cv_prog_cc_c_o],
  [AC_LANG_CONFTEST([AC_LANG_PROGRAM([])])
  # Make sure it works both with $CC and with simple cc.
  # Following AC_PROG_CC_C_O, we do the test twice because some
  # compilers refuse to overwrite an existing .o file with -o,
  # though they will create one.
  am_cv_prog_cc_c_o=yes
  for am_i in 1 2; do
    if AM_RUN_LOG([$CC -c conftest.$ac_ext -o conftest2.$ac_objext]) \
         && test -f conftest2.$ac_objext; then
      : OK
    else
      am_cv_prog_cc_c_o=no
      break
    fi
  done
  rm -f core conftest*
  unset am_i])
if test "$am_cv_prog_cc_c_o" != yes; then
   # Losing compiler, so override with the script.
   # FIXME: It is wrong to rewrite CC.
   # But if we don't then we get into trouble of one sort or another.
   # A longer-term fix would be to have automake use am__CC in this case,
   # and then we could set am__CC="\$(top_srcdir)/compile \$(CC)"
   CC="$am_aux_dir/compile $CC"
fi
AC_LANG_POP([C])])

# For backward compatibility.
AC_DEFUN_ONCE([AM_PROG_CC_C_O], [AC_REQUIRE([AC_PROG_CC])])

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.


# AM_PATH_PYTHON([MINIMUM-VERSION], [ACTION-IF-FOUND], [ACTION-IF-NOT-FOUND])
# ---------------------------------------------------------------------------
# Adds support for distributing Python modules and packages.  To
# install modules, copy them to $(pythondir), using the python_PYTHON
# automake variable.  To install a package with the same name as the
# automake package, install to $(pkgpythondir), or use the
# pkgpython_PYTHON automake variable.
#
# The variables $(pyexecdir) and $(pkgpyexecdir) are provided as
# locations to install python extension modules (shared libraries).
# Another macro is required to find the appropriate flags to compile
# extension modules.
#
# If your package is configured with a different prefix to python,
# users will have to add the install directory to the PYTHONPATH
# environment variable, or create a .pth file (see the python
# documentation for details).
#
# If the MINIMUM-VERSION argument is passed, AM_PATH_PYTHON will
# cause an error if the version of python installed on the system
# doesn't meet the requirement.  MINIMUM-VERSION should consist of
# numbers and dots only.
AC_DEFUN([AM_PATH_PYTHON],
 [
  dnl Find a Python interpreter.  Python versions prior to 2.0 are not
  dnl supported. (2.0 was released on October 16, 2000).
  m4_define_default([_AM_PYTHON_INTERPRETER_LIST],
[python python2 python3 dnl
 python3.9 python3.8 python3.7 python3.6 python3.5 python3.4 python3.3 dnl
 python3.2 python3.1 python3.0 dnl
 python2.7 python2.6 python2.5 python2.4 python2.3 python2.2 python2.1 dnl
 python2.0])

  AC_ARG_VAR([PYTHON], [the Python interpreter])

  m4_if([$1],[],[
    dnl No version check is needed.
    # Find any Python interpreter.
    if test -z "$PYTHON"; then
      AC_PATH_PROGS([PYTHON], _AM_PYTHON_INTERPRETER_LIST, :)
    fi
    am_display_PYTHON=python
  ], [
    dnl A version check is needed.
    if test -n "$PYTHON"; then
      # If the user set $PYTHON, use it and don't search something else.
      AC_MSG_CHECKING([whether $PYTHON version is >= $1])
      AM_PYTHON_CHECK_VERSION([$PYTHON], [$1],
			      [AC_MSG_RESULT([yes])],
			      [AC_MSG_RESULT([no])
			       AC_MSG_ERROR([Python interpreter is too old])])
      am_display_PYTHON=$PYTHON
    else
      # Otherwise, try each interpreter until we find one that satisfies
      # VERSION.
      AC_CACHE_CHECK([for a Python interpreter with version >= $1],
	[am_cv_pathless_PYTHON],[
	for am_cv_pathless_PYTHON in _AM_PYTHON_INTERPRETER_LIST none; do
	  test "$am_cv_pathless_PYTHON" = none && break
	  AM_PYTHON_CHECK_VERSION([$am_cv_pathless_PYTHON], [$1], [break])
	done])
      # Set $PYTHON to the absolute path of $am_cv_pathless_PYTHON.
      if test "$am_cv_pathless_PYTHON" = none; then
	PYTHON=:
      else
        AC_PATH_PROG([PYTHON], [$am_cv_pathless_PYTHON])
      fi
      am_display_PYTHON=$am_cv_pathless_PYTHON
    fi
  ])

  if test "$PYTHON" = :; then
  dnl Run any user-specified action, or abort.
    m4_default([$3], [AC_MSG_ERROR([no suitable Python interpreter found])])
  else

  dnl Query Python for its version number.  Getting [:3] seems to be
  dnl the best way to do this; it's what "site.py" does in the standard
  dnl library.

  AC_CACHE_CHECK([for $am_display_PYTHON version], [am_cv_python_version],
    [am_cv_python_version=`$PYTHON -c "import sys; sys.stdout.write(sys.version[[:3]])"`])
  AC_SUBST([PYTHON_VERSION], [$am_cv_python_version])

  dnl Use the values of $prefix and $exec_prefix for the corresponding
  dnl values of PYTHON_PREFIX and PYTHON_EXEC_PREFIX.  These are made
  dnl distinct variables so they can be overridden if need be.  However,
  dnl general consensus is that you shouldn't need this ability.

  AC_SUBST([PYTHON_PREFIX], ['${prefix}'])
  AC_SUBST([PYTHON_EXEC_PREFIX], ['${exec_prefix}'])

  dnl At times (like when building shared libraries) you may want
  dnl to know which OS platform Python thinks this is.

  AC_CACHE_CHECK([for $am_display_PYTHON platform], [am_cv_python_platform],
    [am_cv_python_platform=`$PYTHON -c "import sys; sys.stdout.write(sys.platform)"`])
  AC_SUBST([PYTHON_PLATFORM], [$am_cv_python_platform])

  # Just factor out some code duplication.
  am_python_setup_sysconfig="\
import sys
# Prefer sysconfig over distutils.sysconfig, for better compatibility
# with python 3.x.  See automake bug#10227.
try:
    import sysconfig
except ImportError:
    can_use_sysconfig = 0
else:
    can_use_sysconfig = 1
# Can't use sysconfig in CPython 2.7, since it's broken in virtualenvs:
# <https://github.com/pypa/virtualenv/issues/118>
try:
    from platform import python_implementation
    if python_implementation() == 'CPython' and sys.version[[:3]] == '2.7':
        can_use_sysconfig = 0
except ImportError:
    pass"

  dnl Set up 4 directories:

  dnl pythondir -- where to install python scripts.  This is the
  dnl   site-packages directory, not the python standard library
  dnl   directory like in previous automake betas.  This behavior
  dnl   is more consistent with lispdir.m4 for example.
  dnl Query distutils for this directory.
  AC_CACHE_CHECK([for $am_display_PYTHON script directory],
    [am_cv_python_pythondir],
    [if test "x$prefix" = xNONE
     then
       am_py_prefix=$ac_default_prefix
     else
       am_py_prefix=$prefix
     fi
     am_cv_python_pythondir=`$PYTHON -c "
$am_python_setup_sysconfig
if can_use_sysconfig:
    sitedir = sysconfig.get_path('purelib', vars={'base':'$am_py_prefix'})
else:
    from distutils import sysconfig
    sitedir = sysconfig.get_python_lib(0, 0, prefix='$am_py_prefix')
sys.stdout.write(sitedir)"`
     case $am_cv_python_pythondir in
     $am_py_prefix*)
       am__strip_prefix=`echo "$am_py_prefix" | sed 's|.|.|g'`
       am_cv_python_pythondir=`echo "$am_cv_python_pythondir" | sed "s,^$am__strip_prefix,$PYTHON_PREFIX,"`
       ;;
     *)
       case $am_py_prefix in
         /usr|/System*) ;;
         *)
	  am_cv_python_pythondir=$PYTHON_PREFIX/lib/python$PYTHON_VERSION/site-packages
	  ;;
       esac
       ;;
     esac
    ])
  AC_SUBST([pythondir], [$am_cv_python_pythondir])

  dnl pkgpythondir -- $PACKAGE directory under pythondir.  Was
  dnl   PYTHON_SITE_PACKAGE in previous betas, but this naming is
  dnl   more consistent with the rest of automake.

  AC_SUBST([pkgpythondir], [\${pythondir}/$PACKAGE])

  dnl pyexecdir -- directory for installing python extension modules
  dnl   (shared libraries)
  dnl Query distutils for this directory.
  AC_CACHE_CHECK([for $am_display_PYTHON extension module directory],
    [am_cv_python_pyexecdir],
    [if test "x$exec_prefix" = xNONE
     then
       am_py_exec_prefix=$am_py_prefix
     else
       am_py_exec_prefix=$exec_prefix
     fi
     am_cv_python_pyexecdir=`$PYTHON -c "
$am_python_setup_sysconfig
if can_use_sysconfig:
    sitedir = sysconfig.get_path('platlib', vars={'platbase':'$am_py_prefix'})
else:
    from distutils import sysconfig
    sitedir = sysconfig.get_python_lib(1, 0, prefix='$am_py_prefix')
sys.stdout.write(sitedir)"`
     case $am_cv_python_pyexecdir in
     $am_py_exec_prefix*)
       am__strip_prefix=`echo "$am_py_exec_prefix" | sed 's|.|.|g'`
       am_cv_python_pyexecdir=`echo "$am_cv_python_pyexecdir" | sed "s,^$am__strip_prefix,$PYTHON_EXEC_PREFIX,"`
       ;;
     *)
       case $am_py_exec_prefix in
         /usr|/System*) ;;
         *)
	   am_cv_python_pyexecdir=$PYTHON_EXEC_PREFIX/lib/python$PYTHON_VERSION/site-packages
	   ;;
       esac
       ;;
     esac
    ])
  AC_SUBST([pyexecdir], [$am_cv_python_pyexecdir])

  dnl pkgpyexecdir -- $(pyexecdir)/$(PACKAGE)

  AC_SUBST([pkgpyexecdir], [\${pyexecdir}/$PACKAGE])

  dnl Run any user-specified action.
  $2
  fi

])


# AM_PYTHON_CHECK_VERSION(PROG, VERSION, [ACTION-IF-TRUE], [ACTION-IF-FALSE])
# ---------------------------------------------------------------------------
# Run ACTION-IF-TRUE if the Python interpreter PROG has version >= VERSION.
# Run ACTION-IF-FALSE otherwise.
# This test uses sys.hexversion instead of the string equivalent (first
# word of sys.version), in order to cope with versions such as 2.2c1.
# This supports Python 2.0 or higher. (2.0 was released on October 16, 2000).
AC_DEFUN([AM_PYTHON_CHECK_VERSION],
 [prog="import sys
# split strings by '.' and convert to numeric.  Append some zeros
# because we need at least 4 digits for the hex conversion.
# map returns an iterator in Python 3.0 and a list in 2.x
minver = list(map(int, '$2'.split('.'))) + [[0, 0, 0]]
minverhex = 0
# xrange is not present in Python 3.0 and range returns an iterator
for i in list(range(0, 4)): minverhex = (minverhex << 8) + minver[[i]]
sys.exit(sys.hexversion < minverhex)"
  AS_IF([AM_RUN_LOG([$1 -c "$prog"])], [$3], [$4])])

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_RUN_LOG(COMMAND)
# -------------------
# Run COMMAND, save the exit status in ac_status, and log it.
# (This has been adapted from Autoconf's _AC_RUN_LOG macro.)
AC_DEFUN([AM_RUN_LOG],
[{ echo "$as_me:$LINENO: $1" >&AS_MESSAGE_LOG_FD
   ($1) >&AS_MESSAGE_LOG_FD 2>&AS_MESSAGE_LOG_FD
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&AS_MESSAGE_LOG_FD
   (exit $ac_status); }])

# Check to make sure that the build environment is sane.    -*- Autoconf -*-

# Copyright (C) 1996-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_SANITY_CHECK
# ---------------
AC_DEFUN([AM_SANITY_CHECK],
[AC_MSG_CHECKING([whether build environment is sane])
# Reject unsafe characters in $srcdir or the absolute working directory
# name.  Accept space and tab only in the latter.
am_lf='
'
case `pwd` in
  *[[\\\"\#\$\&\'\`$am_lf]]*)
    AC_MSG_ERROR([unsafe absolute working directory name]);;
esac
case $srcdir in
  *[[\\\"\#\$\&\'\`$am_lf\ \	]]*)
    AC_MSG_ERROR([unsafe srcdir value: '$srcdir']);;
esac

# Do 'set' in a subshell so we don't clobber the current shell's
# arguments.  Must try -L first in case configure is actually a
# symlink; some systems play weird games with the mod time of symlinks
# (eg FreeBSD returns the mod time of the symlink's containing
# directory).
if (
   am_has_slept=no
   for am_try in 1 2; do
     echo "timestamp, slept: $am_has_slept" > conftest.file
     set X `ls -Lt "$srcdir/configure" conftest.file 2> /dev/null`
     if test "$[*]" = "X"; then
	# -L didn't work.
	set X `ls -t "$srcdir/configure" conftest.file`
     fi
     if test "$[*]" != "X $srcdir/configure conftest.file" \
	&& test "$[*]" != "X conftest.file $srcdir/configure"; then

	# If neither matched, then we have a broken ls.  This can happen
	# if, for instance, CONFIG_SHELL is bash and it inherits a
	# broken ls alias from the environment.  This has actually
	# happened.  Such a system could not be considered "sane".
	AC_MSG_ERROR([ls -t appears to fail.  Make sure there is not a broken
  alias in your environment])
     fi
     if test "$[2]" = conftest.file || test $am_try -eq 2; then
       break
     fi
     # Just in case.
     sleep 1
     am_has_slept=yes
   done
   test "$[2]" = conftest.file
   )
then
   # Ok.
   :
else
   AC_MSG_ERROR([newly created file is older than distributed files!
Check your system clock])
fi
AC_MSG_RESULT([yes])
# If we didn't sleep, we still need to ensure time stamps of config.status and
# generated files are strictly newer.
am_sleep_pid=
if grep 'slept: no' conftest.file >/dev/null 2>&1; then
  ( sleep 1 ) &
  am_sleep_pid=$!
fi
AC_CONFIG_COMMANDS_PRE(
  [AC_MSG_CHECKING([that generated files are newer than configure])
   if test -n "$am_sleep_pid"; then
     # Hide warnings about reused PIDs.
     wait $am_sleep_pid 2>/dev/null
   fi
   AC_MSG_RESULT([done])])
rm -f conftest.file
])

# Copyright (C) 2009-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_SILENT_RULES([DEFAULT])
# --------------------------
# Enable less verbose build rules; with the default set to DEFAULT
# ("yes" being less verbose, "no" or empty being verbose).
AC_DEFUN([AM_SILENT_RULES],
[AC_ARG_ENABLE([silent-rules], [dnl
AS_HELP_STRING(
  [--enable-silent-rules],
  [less verbose build output (undo: "make V=1")])
AS_HELP_STRING(
  [--disable-silent-rules],
  [verbose build output (undo: "make V=0")])dnl
])
case $enable_silent_rules in @%:@ (((
  yes) AM_DEFAULT_VERBOSITY=0;;
   no) AM_DEFAULT_VERBOSITY=1;;
    *) AM_DEFAULT_VERBOSITY=m4_if([$1], [yes], [0], [1]);;
esac
dnl
dnl A few 'make' implementations (e.g., NonStop OS and NextStep)
dnl do not support nested variable expansions.
dnl See automake bug#9928 and bug#10237.
am_make=${MAKE-make}
AC_CACHE_CHECK([whether $am_make supports nested variables],
   [am_cv_make_support_nested_variables],
   [if AS_ECHO([['TRUE=$(BAR$(V))
BAR0=false
BAR1=true
V=1
am__doit:
	@$(TRUE)
.PHONY: am__doit']]) | $am_make -f - >/dev/null 2>&1; then
  am_cv_make_support_nested_variables=yes
else
  am_cv_make_support_nested_variables=no
fi])
if test $am_cv_make_support_nested_variables = yes; then
  dnl Using '$V' instead of '$(V)' breaks IRIX make.
  AM_V='$(V)'
  AM_DEFAULT_V='$(AM_DEFAULT_VERBOSITY)'
else
  AM_V=$AM_DEFAULT_VERBOSITY
  AM_DEFAULT_V=$AM_DEFAULT_VERBOSITY
fi
AC_SUBST([AM_V])dnl
AM_SUBST_NOTMAKE([AM_V])dnl
AC_SUBST([AM_DEFAULT_V])dnl
AM_SUBST_NOTMAKE([AM_DEFAULT_V])dnl
AC_SUBST([AM_DEFAULT_VERBOSITY])dnl
AM_BACKSLASH='\'
AC_SUBST([AM_BACKSLASH])dnl
_AM_SUBST_NOTMAKE([AM_BACKSLASH])dnl
])

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_PROG_INSTALL_STRIP
# ---------------------
# One issue with vendor 'install' (even GNU) is that you can't
# specify the program used to strip binaries.  This is especially
# annoying in cross-compiling environments, where the build's strip
# is unlikely to handle the host's binaries.
# Fortunately install-sh will honor a STRIPPROG variable, so we
# always use install-sh in "make install-strip", and initialize
# STRIPPROG with the value of the STRIP variable (set by the user).
AC_DEFUN([AM_PROG_INSTALL_STRIP],
[AC_REQUIRE([AM_PROG_INSTALL_SH])dnl
# Installed binaries are usually stripped using 'strip' when the user
# run "make install-strip".  However 'strip' might not be the right
# tool to use in cross-compilation environments, therefore Automake
# will honor the 'STRIP' environment variable to overrule this program.
dnl Don't test for $cross_compiling = yes, because it might be 'maybe'.
if test "$cross_compiling" != no; then
  AC_CHECK_TOOL([STRIP], [strip], :)
fi
INSTALL_STRIP_PROGRAM="\$(install_sh) -c -s"
AC_SUBST([INSTALL_STRIP_PROGRAM])])

# Copyright (C) 2006-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_SUBST_NOTMAKE(VARIABLE)
# ---------------------------
# Prevent Automake from outputting VARIABLE = @VARIABLE@ in Makefile.in.
# This macro is traced by Automake.
AC_DEFUN([_AM_SUBST_NOTMAKE])

# AM_SUBST_NOTMAKE(VARIABLE)
# --------------------------
# Public sister of _AM_SUBST_NOTMAKE.
AC_DEFUN([AM_SUBST_NOTMAKE], [_AM_SUBST_NOTMAKE($@)])

# Check how to create a tarball.                            -*- Autoconf -*-

# Copyright (C) 2004-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_PROG_TAR(FORMAT)
# --------------------
# Check how to create a tarball in format FORMAT.
# FORMAT should be one of 'v7', 'ustar', or 'pax'.
#
# Substitute a variable $(am__tar) that is a command
# writing to stdout a FORMAT-tarball containing the directory
# $tardir.
#     tardir=directory && $(am__tar) > result.tar
#
# Substitute a variable $(am__untar) that extract such
# a tarball read from stdin.
#     $(am__untar) < result.tar
#
AC_DEFUN([_AM_PROG_TAR],
[# Always define AMTAR for backward compatibility.  Yes, it's still used
# in the wild :-(  We should find a proper way to deprecate it ...
AC_SUBST([AMTAR], ['$${TAR-tar}'])

# We'll loop over all known methods to create a tar archive until one works.
_am_tools='gnutar m4_if([$1], [ustar], [plaintar]) pax cpio none'

m4_if([$1], [v7],
  [am__tar='$${TAR-tar} chof - "$$tardir"' am__untar='$${TAR-tar} xf -'],

  [m4_case([$1],
    [ustar],
     [# The POSIX 1988 'ustar' format is defined with fixed-size fields.
      # There is notably a 21 bits limit for the UID and the GID.  In fact,
      # the 'pax' utility can hang on bigger UID/GID (see automake bug#8343
      # and bug#13588).
      am_max_uid=2097151 # 2^21 - 1
      am_max_gid=$am_max_uid
      # The $UID and $GID variables are not portable, so we need to resort
      # to the POSIX-mandated id(1) utility.  Errors in the 'id' calls
      # below are definitely unexpected, so allow the users to see them
      # (that is, avoid stderr redirection).
      am_uid=`id -u || echo unknown`
      am_gid=`id -g || echo unknown`
      AC_MSG_CHECKING([whether UID '$am_uid' is supported by ustar format])
      if test $am_uid -le $am_max_uid; then
         AC_MSG_RESULT([yes])
      else
         AC_MSG_RESULT([no])
         _am_tools=none
      fi
      AC_MSG_CHECKING([whether GID '$am_gid' is supported by ustar format])
      if test $am_gid -le $am_max_gid; then
         AC_MSG_RESULT([yes])
      else
        AC_MSG_RESULT([no])
        _am_tools=none
      fi],

  [pax],
    [],

  [m4_fatal([Unknown tar format])])

  AC_MSG_CHECKING([how to create a $1 tar archive])

  # Go ahead even if we have the value already cached.  We do so because we
  # need to set the values for the 'am__tar' and 'am__untar' variables.
  _am_tools=${am_cv_prog_tar_$1-$_am_tools}

  for _am_tool in $_am_tools; do
    case $_am_tool in
    gnutar)
      for _am_tar in tar gnutar gtar; do
        AM_RUN_LOG([$_am_tar --version]) && break
      done
      am__tar="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$$tardir"'
      am__tar_="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$tardir"'
      am__untar="$_am_tar -xf -"
      ;;
    plaintar)
      # Must skip GNU tar: if it does not support --format= it doesn't create
      # ustar tarball either.
      (tar --version) >/dev/null 2>&1 && continue
      am__tar='tar chf - "$$tardir"'
      am__tar_='tar chf - "$tardir"'
      am__untar='tar xf -'
      ;;
    pax)
      am__tar='pax -L -x $1 -w "$$tardir"'
      am__tar_='pax -L -x $1 -w "$tardir"'
      am__untar='pax -r'
      ;;
    cpio)
      am__tar='find "$$tardir" -print | cpio -o -H $1 -L'
      am__tar_='find "$tardir" -print | cpio -o -H $1 -L'
      am__untar='cpio -i -H $1 -d'
      ;;
    none)
      am__tar=false
      am__tar_=false
      am__untar=false
      ;;
    esac

    # If the value was cached, stop now.  We just wanted to have am__tar
    # and am__untar set.
    test -n "${am_cv_prog_tar_$1}" && break

    # tar/untar a dummy directory, and stop if the command works.
    rm -rf conftest.dir
    mkdir conftest.dir
    echo GrepMe > conftest.dir/file
    AM_RUN_LOG([tardir=conftest.dir && eval $am__tar_ >conftest.tar])
    rm -rf conftest.dir
    if test -s conftest.tar; then
      AM_RUN_LOG([$am__untar <conftest.tar])
      AM_RUN_LOG([cat conftest.dir/file])
      grep GrepMe conftest.dir/file >/dev/null 2>&1 && break
    fi
  done
  rm -rf conftest.dir

  AC_CACHE_VAL([am_cv_prog_tar_$1], [am_cv_prog_tar_$1=$_am_tool])
  AC_MSG_RESULT([$am_cv_prog_tar_$1])])

AC_SUBST([am__tar])
AC_SUBST([am__untar])
]) # _AM_PROG_TAR

+ check_count=0
+ check_
+ set +x
check count: 1
== Makefile.am ==
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
Expected files: install-sh missing
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-1
+ ls -l generic
total 60
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link minimal]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link minimal] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link minimal] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link minimal] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[link minimal] missing files, automake fails'
+ command_ok_ '[link minimal] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link minimal] missing files, automake fails'
+ set +x
ok 1 - [link minimal] missing files, automake fails
PASS: t/add-missing.tap 1 - [link minimal] missing files, automake fails
+ for f in $files
+ command_ok_ '[link minimal] warn about missing file install-sh' /bin/grep -F 'required file '\''build-aux/install-sh'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] warn about missing file install-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/install-sh'\'' not found' stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
+ result_ ok -D '' -r '' -- '[link minimal] warn about missing file install-sh'
+ set +x
ok 2 - [link minimal] warn about missing file install-sh
PASS: t/add-missing.tap 2 - [link minimal] warn about missing file install-sh
+ command_ok_ '[link minimal] suggest --add-missing for install-sh' grep '.*--add-missing.* install .*'\''install-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link minimal] suggest --add-missing for install-sh'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''install-sh'\''' stderr
configure.ac:3:   'automake --add-missing' can install 'install-sh'
+ result_ ok -D '' -r '' -- '[link minimal] suggest --add-missing for install-sh'
+ set +x
ok 3 - [link minimal] suggest --add-missing for install-sh
PASS: t/add-missing.tap 3 - [link minimal] suggest --add-missing for install-sh
+ for f in $files
+ command_ok_ '[link minimal] warn about missing file missing' /bin/grep -F 'required file '\''build-aux/missing'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] warn about missing file missing'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/missing'\'' not found' stderr
configure.ac:3: error: required file 'build-aux/missing' not found
+ result_ ok -D '' -r '' -- '[link minimal] warn about missing file missing'
+ set +x
ok 4 - [link minimal] warn about missing file missing
PASS: t/add-missing.tap 4 - [link minimal] warn about missing file missing
+ command_ok_ '[link minimal] suggest --add-missing for missing' grep '.*--add-missing.* install .*'\''missing'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link minimal] suggest --add-missing for missing'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''missing'\''' stderr
configure.ac:3:   'automake --add-missing' can install 'missing'
+ result_ ok -D '' -r '' -- '[link minimal] suggest --add-missing for missing'
+ set +x
ok 5 - [link minimal] suggest --add-missing for missing
PASS: t/add-missing.tap 5 - [link minimal] suggest --add-missing for missing
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link minimal] no extra files installed'
+ set +x
ok 6 - [link minimal] no extra files installed
PASS: t/add-missing.tap 6 - [link minimal] no extra files installed
+ AUTOMAKE_run -d '[link minimal] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link minimal] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[link minimal] automake run successfully'
+ command_ok_ '[link minimal] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link minimal] automake run successfully'
+ set +x
ok 7 - [link minimal] automake run successfully
PASS: t/add-missing.tap 7 - [link minimal] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16541 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    97 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link minimal] file install-sh installed' test -f build-aux/install-sh
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link minimal] file install-sh installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/install-sh
+ result_ ok -D '' -r '' -- '[link minimal] file install-sh installed'
+ set +x
ok 8 - [link minimal] file install-sh installed
PASS: t/add-missing.tap 8 - [link minimal] file install-sh installed
+ for f in $files
+ command_ok_ '[link minimal] file missing installed' test -f build-aux/missing
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link minimal] file missing installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/missing
+ result_ ok -D '' -r '' -- '[link minimal] file missing installed'
+ set +x
ok 9 - [link minimal] file missing installed
PASS: t/add-missing.tap 9 - [link minimal] file missing installed
+ for f in $files
+ command_ok_ '[link minimal] report installation of install-sh' /bin/grep -F ': installing '\''build-aux/install-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] report installation of install-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/install-sh'\''' stderr
configure.ac:3: installing 'build-aux/install-sh'
+ result_ ok -D '' -r '' -- '[link minimal] report installation of install-sh'
+ set +x
ok 10 - [link minimal] report installation of install-sh
PASS: t/add-missing.tap 10 - [link minimal] report installation of install-sh
+ for f in $files
+ command_ok_ '[link minimal] report installation of missing' /bin/grep -F ': installing '\''build-aux/missing'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] report installation of missing'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/missing'\''' stderr
configure.ac:3: installing 'build-aux/missing'
+ result_ ok -D '' -r '' -- '[link minimal] report installation of missing'
+ set +x
ok 11 - [link minimal] report installation of missing
PASS: t/add-missing.tap 11 - [link minimal] report installation of missing
+ all_files='install-sh missing  install-sh missing'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
missing
+ cat files.got
install-sh
missing
+ command_ok_ '[link minimal] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link minimal] all and only expected files installed'
+ set +x
ok 12 - [link minimal] all and only expected files installed
PASS: t/add-missing.tap 12 - [link minimal] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/install-sh
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link minimal] install-sh has been symlinked'
+ result_ ok '[link minimal] install-sh has been symlinked'
+ set +x
ok 13 - [link minimal] install-sh has been symlinked
PASS: t/add-missing.tap 13 - [link minimal] install-sh has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/missing
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link minimal] missing has been symlinked'
+ result_ ok '[link minimal] missing has been symlinked'
+ set +x
ok 14 - [link minimal] missing has been symlinked
PASS: t/add-missing.tap 14 - [link minimal] missing has been symlinked
+ AUTOMAKE_run -d '[link minimal] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link minimal] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link minimal] automake finds all added files'
+ command_ok_ '[link minimal] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link minimal] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link minimal] automake finds all added files'
+ set +x
ok 15 - [link minimal] automake finds all added files
PASS: t/add-missing.tap 15 - [link minimal] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy minimal]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy minimal] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy minimal] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy minimal] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[copy minimal] missing files, automake fails'
+ command_ok_ '[copy minimal] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy minimal] missing files, automake fails'
+ set +x
ok 16 - [copy minimal] missing files, automake fails
PASS: t/add-missing.tap 16 - [copy minimal] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy minimal] warn about missing file install-sh' /bin/grep -F 'required file '\''build-aux/install-sh'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] warn about missing file install-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/install-sh'\'' not found' stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
+ result_ ok -D '' -r '' -- '[copy minimal] warn about missing file install-sh'
+ set +x
ok 17 - [copy minimal] warn about missing file install-sh
PASS: t/add-missing.tap 17 - [copy minimal] warn about missing file install-sh
+ command_ok_ '[copy minimal] suggest --add-missing for install-sh' grep '.*--add-missing.* install .*'\''install-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy minimal] suggest --add-missing for install-sh'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''install-sh'\''' stderr
configure.ac:3:   'automake --add-missing' can install 'install-sh'
+ result_ ok -D '' -r '' -- '[copy minimal] suggest --add-missing for install-sh'
+ set +x
ok 18 - [copy minimal] suggest --add-missing for install-sh
PASS: t/add-missing.tap 18 - [copy minimal] suggest --add-missing for install-sh
+ for f in $files
+ command_ok_ '[copy minimal] warn about missing file missing' /bin/grep -F 'required file '\''build-aux/missing'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] warn about missing file missing'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/missing'\'' not found' stderr
configure.ac:3: error: required file 'build-aux/missing' not found
+ result_ ok -D '' -r '' -- '[copy minimal] warn about missing file missing'
+ set +x
ok 19 - [copy minimal] warn about missing file missing
PASS: t/add-missing.tap 19 - [copy minimal] warn about missing file missing
+ command_ok_ '[copy minimal] suggest --add-missing for missing' grep '.*--add-missing.* install .*'\''missing'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy minimal] suggest --add-missing for missing'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''missing'\''' stderr
configure.ac:3:   'automake --add-missing' can install 'missing'
+ result_ ok -D '' -r '' -- '[copy minimal] suggest --add-missing for missing'
+ set +x
ok 20 - [copy minimal] suggest --add-missing for missing
PASS: t/add-missing.tap 20 - [copy minimal] suggest --add-missing for missing
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy minimal] no extra files installed'
+ set +x
ok 21 - [copy minimal] no extra files installed
PASS: t/add-missing.tap 21 - [copy minimal] no extra files installed
+ AUTOMAKE_run -d '[copy minimal] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy minimal] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[copy minimal] automake run successfully'
+ command_ok_ '[copy minimal] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy minimal] automake run successfully'
+ set +x
ok 22 - [copy minimal] automake run successfully
PASS: t/add-missing.tap 22 - [copy minimal] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16541 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    97 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 24
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy minimal] file install-sh installed' test -f build-aux/install-sh
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy minimal] file install-sh installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/install-sh
+ result_ ok -D '' -r '' -- '[copy minimal] file install-sh installed'
+ set +x
ok 23 - [copy minimal] file install-sh installed
PASS: t/add-missing.tap 23 - [copy minimal] file install-sh installed
+ for f in $files
+ command_ok_ '[copy minimal] file missing installed' test -f build-aux/missing
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy minimal] file missing installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/missing
+ result_ ok -D '' -r '' -- '[copy minimal] file missing installed'
+ set +x
ok 24 - [copy minimal] file missing installed
PASS: t/add-missing.tap 24 - [copy minimal] file missing installed
+ for f in $files
+ command_ok_ '[copy minimal] report installation of install-sh' /bin/grep -F ': installing '\''build-aux/install-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] report installation of install-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/install-sh'\''' stderr
configure.ac:3: installing 'build-aux/install-sh'
+ result_ ok -D '' -r '' -- '[copy minimal] report installation of install-sh'
+ set +x
ok 25 - [copy minimal] report installation of install-sh
PASS: t/add-missing.tap 25 - [copy minimal] report installation of install-sh
+ for f in $files
+ command_ok_ '[copy minimal] report installation of missing' /bin/grep -F ': installing '\''build-aux/missing'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] report installation of missing'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/missing'\''' stderr
configure.ac:3: installing 'build-aux/missing'
+ result_ ok -D '' -r '' -- '[copy minimal] report installation of missing'
+ set +x
ok 26 - [copy minimal] report installation of missing
PASS: t/add-missing.tap 26 - [copy minimal] report installation of missing
+ all_files='install-sh missing  install-sh missing'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
missing
+ cat files.got
install-sh
missing
+ command_ok_ '[copy minimal] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy minimal] all and only expected files installed'
+ set +x
ok 27 - [copy minimal] all and only expected files installed
PASS: t/add-missing.tap 27 - [copy minimal] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/install-sh
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy minimal] install-sh has not been symlinked'
+ result_ ok '[copy minimal] install-sh has not been symlinked'
+ set +x
ok 28 - [copy minimal] install-sh has not been symlinked
PASS: t/add-missing.tap 28 - [copy minimal] install-sh has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/missing
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy minimal] missing has not been symlinked'
+ result_ ok '[copy minimal] missing has not been symlinked'
+ set +x
ok 29 - [copy minimal] missing has not been symlinked
PASS: t/add-missing.tap 29 - [copy minimal] missing has not been symlinked
+ AUTOMAKE_run -d '[copy minimal] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy minimal] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy minimal] automake finds all added files'
+ command_ok_ '[copy minimal] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy minimal] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy minimal] automake finds all added files'
+ set +x
ok 30 - [copy minimal] automake finds all added files
PASS: t/add-missing.tap 30 - [copy minimal] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ check_
+ set +x
check count: 2
== Makefile.am ==
bin_PROGRAMS = foo
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_PROG_CC
Expected files: depcomp compile
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-2
+ ls -l generic
total 64
-rw-r--r-- 1 root root    19 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   117 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link depcomp/C]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link depcomp/C] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link depcomp/C] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link depcomp/C] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/compile' not found
configure.ac:5:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am: error: required file 'build-aux/depcomp' not found
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ cat stdout
+ test tap = none
+ test -z '[link depcomp/C] missing files, automake fails'
+ command_ok_ '[link depcomp/C] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link depcomp/C] missing files, automake fails'
+ set +x
ok 31 - [link depcomp/C] missing files, automake fails
PASS: t/add-missing.tap 31 - [link depcomp/C] missing files, automake fails
+ for f in $files
+ command_ok_ '[link depcomp/C] warn about missing file depcomp' /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] warn about missing file depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
Makefile.am: error: required file 'build-aux/depcomp' not found
+ result_ ok -D '' -r '' -- '[link depcomp/C] warn about missing file depcomp'
+ set +x
ok 32 - [link depcomp/C] warn about missing file depcomp
PASS: t/add-missing.tap 32 - [link depcomp/C] warn about missing file depcomp
+ command_ok_ '[link depcomp/C] suggest --add-missing for depcomp' grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link depcomp/C] suggest --add-missing for depcomp'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ result_ ok -D '' -r '' -- '[link depcomp/C] suggest --add-missing for depcomp'
+ set +x
ok 33 - [link depcomp/C] suggest --add-missing for depcomp
PASS: t/add-missing.tap 33 - [link depcomp/C] suggest --add-missing for depcomp
+ for f in $files
+ command_ok_ '[link depcomp/C] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[link depcomp/C] warn about missing file compile'
+ set +x
ok 34 - [link depcomp/C] warn about missing file compile
PASS: t/add-missing.tap 34 - [link depcomp/C] warn about missing file compile
+ command_ok_ '[link depcomp/C] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link depcomp/C] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[link depcomp/C] suggest --add-missing for compile'
+ set +x
ok 35 - [link depcomp/C] suggest --add-missing for compile
PASS: t/add-missing.tap 35 - [link depcomp/C] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link depcomp/C] no extra files installed'
+ set +x
ok 36 - [link depcomp/C] no extra files installed
PASS: t/add-missing.tap 36 - [link depcomp/C] no extra files installed
+ AUTOMAKE_run -d '[link depcomp/C] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link depcomp/C] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
+ cat stdout
+ test tap = none
+ test -z '[link depcomp/C] automake run successfully'
+ command_ok_ '[link depcomp/C] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link depcomp/C] automake run successfully'
+ set +x
ok 37 - [link depcomp/C] automake run successfully
PASS: t/add-missing.tap 37 - [link depcomp/C] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    19 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 23364 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   117 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   188 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 36 Nov 27 06:37 compile -> /sources/automake-1.16.1/lib/compile
lrwxrwxrwx 1 root root 36 Nov 27 06:37 depcomp -> /sources/automake-1.16.1/lib/depcomp
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link depcomp/C] file depcomp installed' test -f build-aux/depcomp
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link depcomp/C] file depcomp installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/depcomp
+ result_ ok -D '' -r '' -- '[link depcomp/C] file depcomp installed'
+ set +x
ok 38 - [link depcomp/C] file depcomp installed
PASS: t/add-missing.tap 38 - [link depcomp/C] file depcomp installed
+ for f in $files
+ command_ok_ '[link depcomp/C] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link depcomp/C] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[link depcomp/C] file compile installed'
+ set +x
ok 39 - [link depcomp/C] file compile installed
PASS: t/add-missing.tap 39 - [link depcomp/C] file compile installed
+ for f in $files
+ command_ok_ '[link depcomp/C] report installation of depcomp' /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] report installation of depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
Makefile.am: installing 'build-aux/depcomp'
+ result_ ok -D '' -r '' -- '[link depcomp/C] report installation of depcomp'
+ set +x
ok 40 - [link depcomp/C] report installation of depcomp
PASS: t/add-missing.tap 40 - [link depcomp/C] report installation of depcomp
+ for f in $files
+ command_ok_ '[link depcomp/C] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:5: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[link depcomp/C] report installation of compile'
+ set +x
ok 41 - [link depcomp/C] report installation of compile
PASS: t/add-missing.tap 41 - [link depcomp/C] report installation of compile
+ all_files='install-sh missing  depcomp compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ sort
+ echo missing
+ for f in $all_files
+ echo depcomp
+ for f in $all_files
+ echo compile
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
compile
depcomp
install-sh
missing
+ cat files.got
compile
depcomp
install-sh
missing
+ command_ok_ '[link depcomp/C] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link depcomp/C] all and only expected files installed'
+ set +x
ok 42 - [link depcomp/C] all and only expected files installed
PASS: t/add-missing.tap 42 - [link depcomp/C] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/depcomp
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link depcomp/C] depcomp has been symlinked'
+ result_ ok '[link depcomp/C] depcomp has been symlinked'
+ set +x
ok 43 - [link depcomp/C] depcomp has been symlinked
PASS: t/add-missing.tap 43 - [link depcomp/C] depcomp has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link depcomp/C] compile has been symlinked'
+ result_ ok '[link depcomp/C] compile has been symlinked'
+ set +x
ok 44 - [link depcomp/C] compile has been symlinked
PASS: t/add-missing.tap 44 - [link depcomp/C] compile has been symlinked
+ AUTOMAKE_run -d '[link depcomp/C] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link depcomp/C] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link depcomp/C] automake finds all added files'
+ command_ok_ '[link depcomp/C] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link depcomp/C] automake finds all added files'
+ set +x
ok 45 - [link depcomp/C] automake finds all added files
PASS: t/add-missing.tap 45 - [link depcomp/C] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy depcomp/C]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy depcomp/C] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy depcomp/C] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy depcomp/C] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/compile' not found
configure.ac:5:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am: error: required file 'build-aux/depcomp' not found
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ cat stdout
+ test tap = none
+ test -z '[copy depcomp/C] missing files, automake fails'
+ command_ok_ '[copy depcomp/C] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy depcomp/C] missing files, automake fails'
+ set +x
ok 46 - [copy depcomp/C] missing files, automake fails
PASS: t/add-missing.tap 46 - [copy depcomp/C] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy depcomp/C] warn about missing file depcomp' /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] warn about missing file depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
Makefile.am: error: required file 'build-aux/depcomp' not found
+ result_ ok -D '' -r '' -- '[copy depcomp/C] warn about missing file depcomp'
+ set +x
ok 47 - [copy depcomp/C] warn about missing file depcomp
PASS: t/add-missing.tap 47 - [copy depcomp/C] warn about missing file depcomp
+ command_ok_ '[copy depcomp/C] suggest --add-missing for depcomp' grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy depcomp/C] suggest --add-missing for depcomp'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ result_ ok -D '' -r '' -- '[copy depcomp/C] suggest --add-missing for depcomp'
+ set +x
ok 48 - [copy depcomp/C] suggest --add-missing for depcomp
PASS: t/add-missing.tap 48 - [copy depcomp/C] suggest --add-missing for depcomp
+ for f in $files
+ command_ok_ '[copy depcomp/C] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[copy depcomp/C] warn about missing file compile'
+ set +x
ok 49 - [copy depcomp/C] warn about missing file compile
PASS: t/add-missing.tap 49 - [copy depcomp/C] warn about missing file compile
+ command_ok_ '[copy depcomp/C] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy depcomp/C] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[copy depcomp/C] suggest --add-missing for compile'
+ set +x
ok 50 - [copy depcomp/C] suggest --add-missing for compile
PASS: t/add-missing.tap 50 - [copy depcomp/C] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy depcomp/C] no extra files installed'
+ set +x
ok 51 - [copy depcomp/C] no extra files installed
PASS: t/add-missing.tap 51 - [copy depcomp/C] no extra files installed
+ AUTOMAKE_run -d '[copy depcomp/C] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy depcomp/C] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
+ cat stdout
+ test tap = none
+ test -z '[copy depcomp/C] automake run successfully'
+ command_ok_ '[copy depcomp/C] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy depcomp/C] automake run successfully'
+ set +x
ok 52 - [copy depcomp/C] automake run successfully
PASS: t/add-missing.tap 52 - [copy depcomp/C] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    19 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 23364 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   117 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   188 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 56
-rwxr-xr-x 1 root root  7383 Nov 27 06:37 compile
-rwxr-xr-x 1 root root 23568 Nov 27 06:37 depcomp
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy depcomp/C] file depcomp installed' test -f build-aux/depcomp
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy depcomp/C] file depcomp installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/depcomp
+ result_ ok -D '' -r '' -- '[copy depcomp/C] file depcomp installed'
+ set +x
ok 53 - [copy depcomp/C] file depcomp installed
PASS: t/add-missing.tap 53 - [copy depcomp/C] file depcomp installed
+ for f in $files
+ command_ok_ '[copy depcomp/C] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy depcomp/C] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[copy depcomp/C] file compile installed'
+ set +x
ok 54 - [copy depcomp/C] file compile installed
PASS: t/add-missing.tap 54 - [copy depcomp/C] file compile installed
+ for f in $files
+ command_ok_ '[copy depcomp/C] report installation of depcomp' /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] report installation of depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
Makefile.am: installing 'build-aux/depcomp'
+ result_ ok -D '' -r '' -- '[copy depcomp/C] report installation of depcomp'
+ set +x
ok 55 - [copy depcomp/C] report installation of depcomp
PASS: t/add-missing.tap 55 - [copy depcomp/C] report installation of depcomp
+ for f in $files
+ command_ok_ '[copy depcomp/C] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:5: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[copy depcomp/C] report installation of compile'
+ set +x
ok 56 - [copy depcomp/C] report installation of compile
PASS: t/add-missing.tap 56 - [copy depcomp/C] report installation of compile
+ all_files='install-sh missing  depcomp compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo depcomp
+ for f in $all_files
+ echo compile
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
compile
depcomp
install-sh
missing
+ cat files.got
compile
depcomp
install-sh
missing
+ command_ok_ '[copy depcomp/C] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy depcomp/C] all and only expected files installed'
+ set +x
ok 57 - [copy depcomp/C] all and only expected files installed
PASS: t/add-missing.tap 57 - [copy depcomp/C] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/depcomp
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy depcomp/C] depcomp has not been symlinked'
+ result_ ok '[copy depcomp/C] depcomp has not been symlinked'
+ set +x
ok 58 - [copy depcomp/C] depcomp has not been symlinked
PASS: t/add-missing.tap 58 - [copy depcomp/C] depcomp has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy depcomp/C] compile has not been symlinked'
+ result_ ok '[copy depcomp/C] compile has not been symlinked'
+ set +x
ok 59 - [copy depcomp/C] compile has not been symlinked
PASS: t/add-missing.tap 59 - [copy depcomp/C] compile has not been symlinked
+ AUTOMAKE_run -d '[copy depcomp/C] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy depcomp/C] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy depcomp/C] automake finds all added files'
+ command_ok_ '[copy depcomp/C] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy depcomp/C] automake finds all added files'
+ set +x
ok 60 - [copy depcomp/C] automake finds all added files
PASS: t/add-missing.tap 60 - [copy depcomp/C] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ check_
+ set +x
check count: 3
== Makefile.am ==
bin_PROGRAMS = foo
foo_SOURCES = foo.cc
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_PROG_CXX
Expected files: depcomp
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-3
+ ls -l generic
total 64
-rw-r--r-- 1 root root    40 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   118 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link depcomp/C++]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link depcomp/C++] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link depcomp/C++] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link depcomp/C++] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am: error: required file 'build-aux/depcomp' not found
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ cat stdout
+ test tap = none
+ test -z '[link depcomp/C++] missing files, automake fails'
+ command_ok_ '[link depcomp/C++] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C++] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link depcomp/C++] missing files, automake fails'
+ set +x
ok 61 - [link depcomp/C++] missing files, automake fails
PASS: t/add-missing.tap 61 - [link depcomp/C++] missing files, automake fails
+ for f in $files
+ command_ok_ '[link depcomp/C++] warn about missing file depcomp' /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C++] warn about missing file depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
Makefile.am: error: required file 'build-aux/depcomp' not found
+ result_ ok -D '' -r '' -- '[link depcomp/C++] warn about missing file depcomp'
+ set +x
ok 62 - [link depcomp/C++] warn about missing file depcomp
PASS: t/add-missing.tap 62 - [link depcomp/C++] warn about missing file depcomp
+ command_ok_ '[link depcomp/C++] suggest --add-missing for depcomp' grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link depcomp/C++] suggest --add-missing for depcomp'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ result_ ok -D '' -r '' -- '[link depcomp/C++] suggest --add-missing for depcomp'
+ set +x
ok 63 - [link depcomp/C++] suggest --add-missing for depcomp
PASS: t/add-missing.tap 63 - [link depcomp/C++] suggest --add-missing for depcomp
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link depcomp/C++] no extra files installed'
+ set +x
ok 64 - [link depcomp/C++] no extra files installed
PASS: t/add-missing.tap 64 - [link depcomp/C++] no extra files installed
+ AUTOMAKE_run -d '[link depcomp/C++] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link depcomp/C++] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
+ cat stdout
+ test tap = none
+ test -z '[link depcomp/C++] automake run successfully'
+ command_ok_ '[link depcomp/C++] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C++] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link depcomp/C++] automake run successfully'
+ set +x
ok 65 - [link depcomp/C++] automake run successfully
PASS: t/add-missing.tap 65 - [link depcomp/C++] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    40 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 23445 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   118 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   141 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 36 Nov 27 06:37 depcomp -> /sources/automake-1.16.1/lib/depcomp
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link depcomp/C++] file depcomp installed' test -f build-aux/depcomp
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link depcomp/C++] file depcomp installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/depcomp
+ result_ ok -D '' -r '' -- '[link depcomp/C++] file depcomp installed'
+ set +x
ok 66 - [link depcomp/C++] file depcomp installed
PASS: t/add-missing.tap 66 - [link depcomp/C++] file depcomp installed
+ for f in $files
+ command_ok_ '[link depcomp/C++] report installation of depcomp' /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C++] report installation of depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
Makefile.am: installing 'build-aux/depcomp'
+ result_ ok -D '' -r '' -- '[link depcomp/C++] report installation of depcomp'
+ set +x
ok 67 - [link depcomp/C++] report installation of depcomp
PASS: t/add-missing.tap 67 - [link depcomp/C++] report installation of depcomp
+ all_files='install-sh missing  depcomp'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo depcomp
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
depcomp
install-sh
missing
+ cat files.got
depcomp
install-sh
missing
+ command_ok_ '[link depcomp/C++] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C++] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link depcomp/C++] all and only expected files installed'
+ set +x
ok 68 - [link depcomp/C++] all and only expected files installed
PASS: t/add-missing.tap 68 - [link depcomp/C++] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/depcomp
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link depcomp/C++] depcomp has been symlinked'
+ result_ ok '[link depcomp/C++] depcomp has been symlinked'
+ set +x
ok 69 - [link depcomp/C++] depcomp has been symlinked
PASS: t/add-missing.tap 69 - [link depcomp/C++] depcomp has been symlinked
+ AUTOMAKE_run -d '[link depcomp/C++] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link depcomp/C++] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link depcomp/C++] automake finds all added files'
+ command_ok_ '[link depcomp/C++] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link depcomp/C++] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link depcomp/C++] automake finds all added files'
+ set +x
ok 70 - [link depcomp/C++] automake finds all added files
PASS: t/add-missing.tap 70 - [link depcomp/C++] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy depcomp/C++]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy depcomp/C++] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy depcomp/C++] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy depcomp/C++] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am: error: required file 'build-aux/depcomp' not found
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ cat stdout
+ test tap = none
+ test -z '[copy depcomp/C++] missing files, automake fails'
+ command_ok_ '[copy depcomp/C++] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C++] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] missing files, automake fails'
+ set +x
ok 71 - [copy depcomp/C++] missing files, automake fails
PASS: t/add-missing.tap 71 - [copy depcomp/C++] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy depcomp/C++] warn about missing file depcomp' /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C++] warn about missing file depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
Makefile.am: error: required file 'build-aux/depcomp' not found
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] warn about missing file depcomp'
+ set +x
ok 72 - [copy depcomp/C++] warn about missing file depcomp
PASS: t/add-missing.tap 72 - [copy depcomp/C++] warn about missing file depcomp
+ command_ok_ '[copy depcomp/C++] suggest --add-missing for depcomp' grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy depcomp/C++] suggest --add-missing for depcomp'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] suggest --add-missing for depcomp'
+ set +x
ok 73 - [copy depcomp/C++] suggest --add-missing for depcomp
PASS: t/add-missing.tap 73 - [copy depcomp/C++] suggest --add-missing for depcomp
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy depcomp/C++] no extra files installed'
+ set +x
ok 74 - [copy depcomp/C++] no extra files installed
PASS: t/add-missing.tap 74 - [copy depcomp/C++] no extra files installed
+ AUTOMAKE_run -d '[copy depcomp/C++] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy depcomp/C++] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
+ cat stdout
+ test tap = none
+ test -z '[copy depcomp/C++] automake run successfully'
+ command_ok_ '[copy depcomp/C++] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C++] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] automake run successfully'
+ set +x
ok 75 - [copy depcomp/C++] automake run successfully
PASS: t/add-missing.tap 75 - [copy depcomp/C++] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    40 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 23445 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   118 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   141 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 48
-rwxr-xr-x 1 root root 23568 Nov 27 06:37 depcomp
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy depcomp/C++] file depcomp installed' test -f build-aux/depcomp
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy depcomp/C++] file depcomp installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/depcomp
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] file depcomp installed'
+ set +x
ok 76 - [copy depcomp/C++] file depcomp installed
PASS: t/add-missing.tap 76 - [copy depcomp/C++] file depcomp installed
+ for f in $files
+ command_ok_ '[copy depcomp/C++] report installation of depcomp' /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C++] report installation of depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
Makefile.am: installing 'build-aux/depcomp'
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] report installation of depcomp'
+ set +x
ok 77 - [copy depcomp/C++] report installation of depcomp
PASS: t/add-missing.tap 77 - [copy depcomp/C++] report installation of depcomp
+ all_files='install-sh missing  depcomp'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo depcomp
+ sort
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
depcomp
install-sh
missing
+ cat files.got
depcomp
install-sh
missing
+ command_ok_ '[copy depcomp/C++] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C++] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] all and only expected files installed'
+ set +x
ok 78 - [copy depcomp/C++] all and only expected files installed
PASS: t/add-missing.tap 78 - [copy depcomp/C++] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/depcomp
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy depcomp/C++] depcomp has not been symlinked'
+ result_ ok '[copy depcomp/C++] depcomp has not been symlinked'
+ set +x
ok 79 - [copy depcomp/C++] depcomp has not been symlinked
PASS: t/add-missing.tap 79 - [copy depcomp/C++] depcomp has not been symlinked
+ AUTOMAKE_run -d '[copy depcomp/C++] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy depcomp/C++] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy depcomp/C++] automake finds all added files'
+ command_ok_ '[copy depcomp/C++] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy depcomp/C++] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy depcomp/C++] automake finds all added files'
+ set +x
ok 80 - [copy depcomp/C++] automake finds all added files
PASS: t/add-missing.tap 80 - [copy depcomp/C++] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ check_ --run-aclocal
+ set +x
check count: 4
ok 81 - [compile] aclocal.m4 rebuilt
PASS: t/add-missing.tap 81 - [compile] aclocal.m4 rebuilt
+ echo == aclocal.m4 ==
== aclocal.m4 ==
+ cat aclocal.m4
# generated automatically by aclocal 1.16.1 -*- Autoconf -*-

# Copyright (C) 1996-2018 Free Software Foundation, Inc.

# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.

m4_ifndef([AC_CONFIG_MACRO_DIRS], [m4_defun([_AM_CONFIG_MACRO_DIRS], [])m4_defun([AC_CONFIG_MACRO_DIRS], [_AM_CONFIG_MACRO_DIRS($@)])])
m4_ifndef([AC_AUTOCONF_VERSION],
  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
m4_if(m4_defn([AC_AUTOCONF_VERSION]), [2.69],,
[m4_warning([this file was generated for autoconf 2.69.
You have another version of autoconf.  It may work, but is not guaranteed to.
If you have problems, you may need to regenerate the build system entirely.
To do so, use the procedure documented by the package, typically 'autoreconf'.])])

# Copyright (C) 2002-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_AUTOMAKE_VERSION(VERSION)
# ----------------------------
# Automake X.Y traces this macro to ensure aclocal.m4 has been
# generated from the m4 files accompanying Automake X.Y.
# (This private macro should not be called outside this file.)
AC_DEFUN([AM_AUTOMAKE_VERSION],
[am__api_version='1.16'
dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
dnl require some minimum version.  Point them to the right macro.
m4_if([$1], [1.16.1], [],
      [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
])

# _AM_AUTOCONF_VERSION(VERSION)
# -----------------------------
# aclocal traces this macro to find the Autoconf version.
# This is a private macro too.  Using m4_define simplifies
# the logic in aclocal, which can simply ignore this definition.
m4_define([_AM_AUTOCONF_VERSION], [])

# AM_SET_CURRENT_AUTOMAKE_VERSION
# -------------------------------
# Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
# This function is AC_REQUIREd by AM_INIT_AUTOMAKE.
AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
[AM_AUTOMAKE_VERSION([1.16.1])dnl
m4_ifndef([AC_AUTOCONF_VERSION],
  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
_AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])

# AM_AUX_DIR_EXPAND                                         -*- Autoconf -*-

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# For projects using AC_CONFIG_AUX_DIR([foo]), Autoconf sets
# $ac_aux_dir to '$srcdir/foo'.  In other projects, it is set to
# '$srcdir', '$srcdir/..', or '$srcdir/../..'.
#
# Of course, Automake must honor this variable whenever it calls a
# tool from the auxiliary directory.  The problem is that $srcdir (and
# therefore $ac_aux_dir as well) can be either absolute or relative,
# depending on how configure is run.  This is pretty annoying, since
# it makes $ac_aux_dir quite unusable in subdirectories: in the top
# source directory, any form will work fine, but in subdirectories a
# relative path needs to be adjusted first.
#
# $ac_aux_dir/missing
#    fails when called from a subdirectory if $ac_aux_dir is relative
# $top_srcdir/$ac_aux_dir/missing
#    fails if $ac_aux_dir is absolute,
#    fails when called from a subdirectory in a VPATH build with
#          a relative $ac_aux_dir
#
# The reason of the latter failure is that $top_srcdir and $ac_aux_dir
# are both prefixed by $srcdir.  In an in-source build this is usually
# harmless because $srcdir is '.', but things will broke when you
# start a VPATH build or use an absolute $srcdir.
#
# So we could use something similar to $top_srcdir/$ac_aux_dir/missing,
# iff we strip the leading $srcdir from $ac_aux_dir.  That would be:
#   am_aux_dir='\$(top_srcdir)/'`expr "$ac_aux_dir" : "$srcdir//*\(.*\)"`
# and then we would define $MISSING as
#   MISSING="\${SHELL} $am_aux_dir/missing"
# This will work as long as MISSING is not called from configure, because
# unfortunately $(top_srcdir) has no meaning in configure.
# However there are other variables, like CC, which are often used in
# configure, and could therefore not use this "fixed" $ac_aux_dir.
#
# Another solution, used here, is to always expand $ac_aux_dir to an
# absolute PATH.  The drawback is that using absolute paths prevent a
# configured tree to be moved without reconfiguration.

AC_DEFUN([AM_AUX_DIR_EXPAND],
[AC_REQUIRE([AC_CONFIG_AUX_DIR_DEFAULT])dnl
# Expand $ac_aux_dir to an absolute path.
am_aux_dir=`cd "$ac_aux_dir" && pwd`
])

# AM_CONDITIONAL                                            -*- Autoconf -*-

# Copyright (C) 1997-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_CONDITIONAL(NAME, SHELL-CONDITION)
# -------------------------------------
# Define a conditional.
AC_DEFUN([AM_CONDITIONAL],
[AC_PREREQ([2.52])dnl
 m4_if([$1], [TRUE],  [AC_FATAL([$0: invalid condition: $1])],
       [$1], [FALSE], [AC_FATAL([$0: invalid condition: $1])])dnl
AC_SUBST([$1_TRUE])dnl
AC_SUBST([$1_FALSE])dnl
_AM_SUBST_NOTMAKE([$1_TRUE])dnl
_AM_SUBST_NOTMAKE([$1_FALSE])dnl
m4_define([_AM_COND_VALUE_$1], [$2])dnl
if $2; then
  $1_TRUE=
  $1_FALSE='#'
else
  $1_TRUE='#'
  $1_FALSE=
fi
AC_CONFIG_COMMANDS_PRE(
[if test -z "${$1_TRUE}" && test -z "${$1_FALSE}"; then
  AC_MSG_ERROR([[conditional "$1" was never defined.
Usually this means the macro was only invoked conditionally.]])
fi])])

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.


# There are a few dirty hacks below to avoid letting 'AC_PROG_CC' be
# written in clear, in which case automake, when reading aclocal.m4,
# will think it sees a *use*, and therefore will trigger all it's
# C support machinery.  Also note that it means that autoscan, seeing
# CC etc. in the Makefile, will ask for an AC_PROG_CC use...


# _AM_DEPENDENCIES(NAME)
# ----------------------
# See how the compiler implements dependency checking.
# NAME is "CC", "CXX", "OBJC", "OBJCXX", "UPC", or "GJC".
# We try a few techniques and use that to set a single cache variable.
#
# We don't AC_REQUIRE the corresponding AC_PROG_CC since the latter was
# modified to invoke _AM_DEPENDENCIES(CC); we would have a circular
# dependency, and given that the user is not expected to run this macro,
# just rely on AC_PROG_CC.
AC_DEFUN([_AM_DEPENDENCIES],
[AC_REQUIRE([AM_SET_DEPDIR])dnl
AC_REQUIRE([AM_OUTPUT_DEPENDENCY_COMMANDS])dnl
AC_REQUIRE([AM_MAKE_INCLUDE])dnl
AC_REQUIRE([AM_DEP_TRACK])dnl

m4_if([$1], [CC],   [depcc="$CC"   am_compiler_list=],
      [$1], [CXX],  [depcc="$CXX"  am_compiler_list=],
      [$1], [OBJC], [depcc="$OBJC" am_compiler_list='gcc3 gcc'],
      [$1], [OBJCXX], [depcc="$OBJCXX" am_compiler_list='gcc3 gcc'],
      [$1], [UPC],  [depcc="$UPC"  am_compiler_list=],
      [$1], [GCJ],  [depcc="$GCJ"  am_compiler_list='gcc3 gcc'],
                    [depcc="$$1"   am_compiler_list=])

AC_CACHE_CHECK([dependency style of $depcc],
               [am_cv_$1_dependencies_compiler_type],
[if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
  # We make a subdir and do the tests there.  Otherwise we can end up
  # making bogus files that we don't know about and never remove.  For
  # instance it was reported that on HP-UX the gcc test will end up
  # making a dummy file named 'D' -- because '-MD' means "put the output
  # in D".
  rm -rf conftest.dir
  mkdir conftest.dir
  # Copy depcomp to subdir because otherwise we won't find it if we're
  # using a relative directory.
  cp "$am_depcomp" conftest.dir
  cd conftest.dir
  # We will build objects and dependencies in a subdirectory because
  # it helps to detect inapplicable dependency modes.  For instance
  # both Tru64's cc and ICC support -MD to output dependencies as a
  # side effect of compilation, but ICC will put the dependencies in
  # the current directory while Tru64 will put them in the object
  # directory.
  mkdir sub

  am_cv_$1_dependencies_compiler_type=none
  if test "$am_compiler_list" = ""; then
     am_compiler_list=`sed -n ['s/^#*\([a-zA-Z0-9]*\))$/\1/p'] < ./depcomp`
  fi
  am__universal=false
  m4_case([$1], [CC],
    [case " $depcc " in #(
     *\ -arch\ *\ -arch\ *) am__universal=true ;;
     esac],
    [CXX],
    [case " $depcc " in #(
     *\ -arch\ *\ -arch\ *) am__universal=true ;;
     esac])

  for depmode in $am_compiler_list; do
    # Setup a source with many dependencies, because some compilers
    # like to wrap large dependency lists on column 80 (with \), and
    # we should not choose a depcomp mode which is confused by this.
    #
    # We need to recreate these files for each test, as the compiler may
    # overwrite some of them when testing with obscure command lines.
    # This happens at least with the AIX C compiler.
    : > sub/conftest.c
    for i in 1 2 3 4 5 6; do
      echo '#include "conftst'$i'.h"' >> sub/conftest.c
      # Using ": > sub/conftst$i.h" creates only sub/conftst1.h with
      # Solaris 10 /bin/sh.
      echo '/* dummy */' > sub/conftst$i.h
    done
    echo "${am__include} ${am__quote}sub/conftest.Po${am__quote}" > confmf

    # We check with '-c' and '-o' for the sake of the "dashmstdout"
    # mode.  It turns out that the SunPro C++ compiler does not properly
    # handle '-M -o', and we need to detect this.  Also, some Intel
    # versions had trouble with output in subdirs.
    am__obj=sub/conftest.${OBJEXT-o}
    am__minus_obj="-o $am__obj"
    case $depmode in
    gcc)
      # This depmode causes a compiler race in universal mode.
      test "$am__universal" = false || continue
      ;;
    nosideeffect)
      # After this tag, mechanisms are not by side-effect, so they'll
      # only be used when explicitly requested.
      if test "x$enable_dependency_tracking" = xyes; then
	continue
      else
	break
      fi
      ;;
    msvc7 | msvc7msys | msvisualcpp | msvcmsys)
      # This compiler won't grok '-c -o', but also, the minuso test has
      # not run yet.  These depmodes are late enough in the game, and
      # so weak that their functioning should not be impacted.
      am__obj=conftest.${OBJEXT-o}
      am__minus_obj=
      ;;
    none) break ;;
    esac
    if depmode=$depmode \
       source=sub/conftest.c object=$am__obj \
       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
       $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
         >/dev/null 2>conftest.err &&
       grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
       grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
       grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
      # icc doesn't choke on unknown options, it will just issue warnings
      # or remarks (even with -Werror).  So we grep stderr for any message
      # that says an option was ignored or not supported.
      # When given -MP, icc 7.0 and 7.1 complain thusly:
      #   icc: Command line warning: ignoring option '-M'; no argument required
      # The diagnosis changed in icc 8.0:
      #   icc: Command line remark: option '-MP' not supported
      if (grep 'ignoring option' conftest.err ||
          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else
        am_cv_$1_dependencies_compiler_type=$depmode
        break
      fi
    fi
  done

  cd ..
  rm -rf conftest.dir
else
  am_cv_$1_dependencies_compiler_type=none
fi
])
AC_SUBST([$1DEPMODE], [depmode=$am_cv_$1_dependencies_compiler_type])
AM_CONDITIONAL([am__fastdep$1], [
  test "x$enable_dependency_tracking" != xno \
  && test "$am_cv_$1_dependencies_compiler_type" = gcc3])
])


# AM_SET_DEPDIR
# -------------
# Choose a directory name for dependency files.
# This macro is AC_REQUIREd in _AM_DEPENDENCIES.
AC_DEFUN([AM_SET_DEPDIR],
[AC_REQUIRE([AM_SET_LEADING_DOT])dnl
AC_SUBST([DEPDIR], ["${am__leading_dot}deps"])dnl
])


# AM_DEP_TRACK
# ------------
AC_DEFUN([AM_DEP_TRACK],
[AC_ARG_ENABLE([dependency-tracking], [dnl
AS_HELP_STRING(
  [--enable-dependency-tracking],
  [do not reject slow dependency extractors])
AS_HELP_STRING(
  [--disable-dependency-tracking],
  [speeds up one-time build])])
if test "x$enable_dependency_tracking" != xno; then
  am_depcomp="$ac_aux_dir/depcomp"
  AMDEPBACKSLASH='\'
  am__nodep='_no'
fi
AM_CONDITIONAL([AMDEP], [test "x$enable_dependency_tracking" != xno])
AC_SUBST([AMDEPBACKSLASH])dnl
_AM_SUBST_NOTMAKE([AMDEPBACKSLASH])dnl
AC_SUBST([am__nodep])dnl
_AM_SUBST_NOTMAKE([am__nodep])dnl
])

# Generate code to set up dependency tracking.              -*- Autoconf -*-

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_OUTPUT_DEPENDENCY_COMMANDS
# ------------------------------
AC_DEFUN([_AM_OUTPUT_DEPENDENCY_COMMANDS],
[{
  # Older Autoconf quotes --file arguments for eval, but not when files
  # are listed without --file.  Let's play safe and only enable the eval
  # if we detect the quoting.
  # TODO: see whether this extra hack can be removed once we start
  # requiring Autoconf 2.70 or later.
  AS_CASE([$CONFIG_FILES],
          [*\'*], [eval set x "$CONFIG_FILES"],
          [*], [set x $CONFIG_FILES])
  shift
  # Used to flag and report bootstrapping failures.
  am_rc=0
  for am_mf
  do
    # Strip MF so we end up with the name of the file.
    am_mf=`AS_ECHO(["$am_mf"]) | sed -e 's/:.*$//'`
    # Check whether this is an Automake generated Makefile which includes
    # dependency-tracking related rules and includes.
    # Grep'ing the whole file directly is not great: AIX grep has a line
    # limit of 2048, but all sed's we know have understand at least 4000.
    sed -n 's,^am--depfiles:.*,X,p' "$am_mf" | grep X >/dev/null 2>&1 \
      || continue
    am_dirpart=`AS_DIRNAME(["$am_mf"])`
    am_filepart=`AS_BASENAME(["$am_mf"])`
    AM_RUN_LOG([cd "$am_dirpart" \
      && sed -e '/# am--include-marker/d' "$am_filepart" \
        | $MAKE -f - am--depfiles]) || am_rc=$?
  done
  if test $am_rc -ne 0; then
    AC_MSG_FAILURE([Something went wrong bootstrapping makefile fragments
    for automatic dependency tracking.  Try re-running configure with the
    '--disable-dependency-tracking' option to at least be able to build
    the package (albeit without support for automatic dependency tracking).])
  fi
  AS_UNSET([am_dirpart])
  AS_UNSET([am_filepart])
  AS_UNSET([am_mf])
  AS_UNSET([am_rc])
  rm -f conftest-deps.mk
}
])# _AM_OUTPUT_DEPENDENCY_COMMANDS


# AM_OUTPUT_DEPENDENCY_COMMANDS
# -----------------------------
# This macro should only be invoked once -- use via AC_REQUIRE.
#
# This code is only required when automatic dependency tracking is enabled.
# This creates each '.Po' and '.Plo' makefile fragment that we'll need in
# order to bootstrap the dependency handling code.
AC_DEFUN([AM_OUTPUT_DEPENDENCY_COMMANDS],
[AC_CONFIG_COMMANDS([depfiles],
     [test x"$AMDEP_TRUE" != x"" || _AM_OUTPUT_DEPENDENCY_COMMANDS],
     [AMDEP_TRUE="$AMDEP_TRUE" MAKE="${MAKE-make}"])])

# Do all the work for Automake.                             -*- Autoconf -*-

# Copyright (C) 1996-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This macro actually does too much.  Some checks are only needed if
# your package does certain things.  But this isn't really a big deal.

dnl Redefine AC_PROG_CC to automatically invoke _AM_PROG_CC_C_O.
m4_define([AC_PROG_CC],
m4_defn([AC_PROG_CC])
[_AM_PROG_CC_C_O
])

# AM_INIT_AUTOMAKE(PACKAGE, VERSION, [NO-DEFINE])
# AM_INIT_AUTOMAKE([OPTIONS])
# -----------------------------------------------
# The call with PACKAGE and VERSION arguments is the old style
# call (pre autoconf-2.50), which is being phased out.  PACKAGE
# and VERSION should now be passed to AC_INIT and removed from
# the call to AM_INIT_AUTOMAKE.
# We support both call styles for the transition.  After
# the next Automake release, Autoconf can make the AC_INIT
# arguments mandatory, and then we can depend on a new Autoconf
# release and drop the old call support.
AC_DEFUN([AM_INIT_AUTOMAKE],
[AC_PREREQ([2.65])dnl
dnl Autoconf wants to disallow AM_ names.  We explicitly allow
dnl the ones we care about.
m4_pattern_allow([^AM_[A-Z]+FLAGS$])dnl
AC_REQUIRE([AM_SET_CURRENT_AUTOMAKE_VERSION])dnl
AC_REQUIRE([AC_PROG_INSTALL])dnl
if test "`cd $srcdir && pwd`" != "`pwd`"; then
  # Use -I$(srcdir) only when $(srcdir) != ., so that make's output
  # is not polluted with repeated "-I."
  AC_SUBST([am__isrc], [' -I$(srcdir)'])_AM_SUBST_NOTMAKE([am__isrc])dnl
  # test to see if srcdir already configured
  if test -f $srcdir/config.status; then
    AC_MSG_ERROR([source directory already configured; run "make distclean" there first])
  fi
fi

# test whether we have cygpath
if test -z "$CYGPATH_W"; then
  if (cygpath --version) >/dev/null 2>/dev/null; then
    CYGPATH_W='cygpath -w'
  else
    CYGPATH_W=echo
  fi
fi
AC_SUBST([CYGPATH_W])

# Define the identity of the package.
dnl Distinguish between old-style and new-style calls.
m4_ifval([$2],
[AC_DIAGNOSE([obsolete],
             [$0: two- and three-arguments forms are deprecated.])
m4_ifval([$3], [_AM_SET_OPTION([no-define])])dnl
 AC_SUBST([PACKAGE], [$1])dnl
 AC_SUBST([VERSION], [$2])],
[_AM_SET_OPTIONS([$1])dnl
dnl Diagnose old-style AC_INIT with new-style AM_AUTOMAKE_INIT.
m4_if(
  m4_ifdef([AC_PACKAGE_NAME], [ok]):m4_ifdef([AC_PACKAGE_VERSION], [ok]),
  [ok:ok],,
  [m4_fatal([AC_INIT should be called with package and version arguments])])dnl
 AC_SUBST([PACKAGE], ['AC_PACKAGE_TARNAME'])dnl
 AC_SUBST([VERSION], ['AC_PACKAGE_VERSION'])])dnl

_AM_IF_OPTION([no-define],,
[AC_DEFINE_UNQUOTED([PACKAGE], ["$PACKAGE"], [Name of package])
 AC_DEFINE_UNQUOTED([VERSION], ["$VERSION"], [Version number of package])])dnl

# Some tools Automake needs.
AC_REQUIRE([AM_SANITY_CHECK])dnl
AC_REQUIRE([AC_ARG_PROGRAM])dnl
AM_MISSING_PROG([ACLOCAL], [aclocal-${am__api_version}])
AM_MISSING_PROG([AUTOCONF], [autoconf])
AM_MISSING_PROG([AUTOMAKE], [automake-${am__api_version}])
AM_MISSING_PROG([AUTOHEADER], [autoheader])
AM_MISSING_PROG([MAKEINFO], [makeinfo])
AC_REQUIRE([AM_PROG_INSTALL_SH])dnl
AC_REQUIRE([AM_PROG_INSTALL_STRIP])dnl
AC_REQUIRE([AC_PROG_MKDIR_P])dnl
# For better backward compatibility.  To be removed once Automake 1.9.x
# dies out for good.  For more background, see:
# <https://lists.gnu.org/archive/html/automake/2012-07/msg00001.html>
# <https://lists.gnu.org/archive/html/automake/2012-07/msg00014.html>
AC_SUBST([mkdir_p], ['$(MKDIR_P)'])
# We need awk for the "check" target (and possibly the TAP driver).  The
# system "awk" is bad on some platforms.
AC_REQUIRE([AC_PROG_AWK])dnl
AC_REQUIRE([AC_PROG_MAKE_SET])dnl
AC_REQUIRE([AM_SET_LEADING_DOT])dnl
_AM_IF_OPTION([tar-ustar], [_AM_PROG_TAR([ustar])],
	      [_AM_IF_OPTION([tar-pax], [_AM_PROG_TAR([pax])],
			     [_AM_PROG_TAR([v7])])])
_AM_IF_OPTION([no-dependencies],,
[AC_PROVIDE_IFELSE([AC_PROG_CC],
		  [_AM_DEPENDENCIES([CC])],
		  [m4_define([AC_PROG_CC],
			     m4_defn([AC_PROG_CC])[_AM_DEPENDENCIES([CC])])])dnl
AC_PROVIDE_IFELSE([AC_PROG_CXX],
		  [_AM_DEPENDENCIES([CXX])],
		  [m4_define([AC_PROG_CXX],
			     m4_defn([AC_PROG_CXX])[_AM_DEPENDENCIES([CXX])])])dnl
AC_PROVIDE_IFELSE([AC_PROG_OBJC],
		  [_AM_DEPENDENCIES([OBJC])],
		  [m4_define([AC_PROG_OBJC],
			     m4_defn([AC_PROG_OBJC])[_AM_DEPENDENCIES([OBJC])])])dnl
AC_PROVIDE_IFELSE([AC_PROG_OBJCXX],
		  [_AM_DEPENDENCIES([OBJCXX])],
		  [m4_define([AC_PROG_OBJCXX],
			     m4_defn([AC_PROG_OBJCXX])[_AM_DEPENDENCIES([OBJCXX])])])dnl
])
AC_REQUIRE([AM_SILENT_RULES])dnl
dnl The testsuite driver may need to know about EXEEXT, so add the
dnl 'am__EXEEXT' conditional if _AM_COMPILER_EXEEXT was seen.  This
dnl macro is hooked onto _AC_COMPILER_EXEEXT early, see below.
AC_CONFIG_COMMANDS_PRE(dnl
[m4_provide_if([_AM_COMPILER_EXEEXT],
  [AM_CONDITIONAL([am__EXEEXT], [test -n "$EXEEXT"])])])dnl

# POSIX will say in a future version that running "rm -f" with no argument
# is OK; and we want to be able to make that assumption in our Makefile
# recipes.  So use an aggressive probe to check that the usage we want is
# actually supported "in the wild" to an acceptable degree.
# See automake bug#10828.
# To make any issue more visible, cause the running configure to be aborted
# by default if the 'rm' program in use doesn't match our expectations; the
# user can still override this though.
if rm -f && rm -fr && rm -rf; then : OK; else
  cat >&2 <<'END'
Oops!

Your 'rm' program seems unable to run without file operands specified
on the command line, even when the '-f' option is present.  This is contrary
to the behaviour of most rm programs out there, and not conforming with
the upcoming POSIX standard: <http://austingroupbugs.net/view.php?id=542>

Please tell bug-automake@gnu.org about your system, including the value
of your $PATH and any error possibly output before this message.  This
can help us improve future automake versions.

END
  if test x"$ACCEPT_INFERIOR_RM_PROGRAM" = x"yes"; then
    echo 'Configuration will proceed anyway, since you have set the' >&2
    echo 'ACCEPT_INFERIOR_RM_PROGRAM variable to "yes"' >&2
    echo >&2
  else
    cat >&2 <<'END'
Aborting the configuration process, to ensure you take notice of the issue.

You can download and install GNU coreutils to get an 'rm' implementation
that behaves properly: <https://www.gnu.org/software/coreutils/>.

If you want to complete the configuration process using your problematic
'rm' anyway, export the environment variable ACCEPT_INFERIOR_RM_PROGRAM
to "yes", and re-run configure.

END
    AC_MSG_ERROR([Your 'rm' program is bad, sorry.])
  fi
fi
dnl The trailing newline in this macro's definition is deliberate, for
dnl backward compatibility and to allow trailing 'dnl'-style comments
dnl after the AM_INIT_AUTOMAKE invocation. See automake bug#16841.
])

dnl Hook into '_AC_COMPILER_EXEEXT' early to learn its expansion.  Do not
dnl add the conditional right here, as _AC_COMPILER_EXEEXT may be further
dnl mangled by Autoconf and run in a shell conditional statement.
m4_define([_AC_COMPILER_EXEEXT],
m4_defn([_AC_COMPILER_EXEEXT])[m4_provide([_AM_COMPILER_EXEEXT])])

# When config.status generates a header, we must update the stamp-h file.
# This file resides in the same directory as the config header
# that is generated.  The stamp files are numbered to have different names.

# Autoconf calls _AC_AM_CONFIG_HEADER_HOOK (when defined) in the
# loop where config.status creates the headers, so we can generate
# our stamp files there.
AC_DEFUN([_AC_AM_CONFIG_HEADER_HOOK],
[# Compute $1's index in $config_headers.
_am_arg=$1
_am_stamp_count=1
for _am_header in $config_headers :; do
  case $_am_header in
    $_am_arg | $_am_arg:* )
      break ;;
    * )
      _am_stamp_count=`expr $_am_stamp_count + 1` ;;
  esac
done
echo "timestamp for $_am_arg" >`AS_DIRNAME(["$_am_arg"])`/stamp-h[]$_am_stamp_count])

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_PROG_INSTALL_SH
# ------------------
# Define $install_sh.
AC_DEFUN([AM_PROG_INSTALL_SH],
[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
if test x"${install_sh+set}" != xset; then
  case $am_aux_dir in
  *\ * | *\	*)
    install_sh="\${SHELL} '$am_aux_dir/install-sh'" ;;
  *)
    install_sh="\${SHELL} $am_aux_dir/install-sh"
  esac
fi
AC_SUBST([install_sh])])

# Copyright (C) 2003-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# Check whether the underlying file-system supports filenames
# with a leading dot.  For instance MS-DOS doesn't.
AC_DEFUN([AM_SET_LEADING_DOT],
[rm -rf .tst 2>/dev/null
mkdir .tst 2>/dev/null
if test -d .tst; then
  am__leading_dot=.
else
  am__leading_dot=_
fi
rmdir .tst 2>/dev/null
AC_SUBST([am__leading_dot])])

# Check to see how 'make' treats includes.	            -*- Autoconf -*-

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_MAKE_INCLUDE()
# -----------------
# Check whether make has an 'include' directive that can support all
# the idioms we need for our automatic dependency tracking code.
AC_DEFUN([AM_MAKE_INCLUDE],
[AC_MSG_CHECKING([whether ${MAKE-make} supports the include directive])
cat > confinc.mk << 'END'
am__doit:
	@echo this is the am__doit target >confinc.out
.PHONY: am__doit
END
am__include="#"
am__quote=
# BSD make does it like this.
echo '.include "confinc.mk" # ignored' > confmf.BSD
# Other make implementations (GNU, Solaris 10, AIX) do it like this.
echo 'include confinc.mk # ignored' > confmf.GNU
_am_result=no
for s in GNU BSD; do
  AM_RUN_LOG([${MAKE-make} -f confmf.$s && cat confinc.out])
  AS_CASE([$?:`cat confinc.out 2>/dev/null`],
      ['0:this is the am__doit target'],
      [AS_CASE([$s],
          [BSD], [am__include='.include' am__quote='"'],
          [am__include='include' am__quote=''])])
  if test "$am__include" != "#"; then
    _am_result="yes ($s style)"
    break
  fi
done
rm -f confinc.* confmf.*
AC_MSG_RESULT([${_am_result}])
AC_SUBST([am__include])])
AC_SUBST([am__quote])])

# Fake the existence of programs that GNU maintainers use.  -*- Autoconf -*-

# Copyright (C) 1997-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_MISSING_PROG(NAME, PROGRAM)
# ------------------------------
AC_DEFUN([AM_MISSING_PROG],
[AC_REQUIRE([AM_MISSING_HAS_RUN])
$1=${$1-"${am_missing_run}$2"}
AC_SUBST($1)])

# AM_MISSING_HAS_RUN
# ------------------
# Define MISSING if not defined so far and test if it is modern enough.
# If it is, set am_missing_run to use it, otherwise, to nothing.
AC_DEFUN([AM_MISSING_HAS_RUN],
[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
AC_REQUIRE_AUX_FILE([missing])dnl
if test x"${MISSING+set}" != xset; then
  case $am_aux_dir in
  *\ * | *\	*)
    MISSING="\${SHELL} \"$am_aux_dir/missing\"" ;;
  *)
    MISSING="\${SHELL} $am_aux_dir/missing" ;;
  esac
fi
# Use eval to expand $SHELL
if eval "$MISSING --is-lightweight"; then
  am_missing_run="$MISSING "
else
  am_missing_run=
  AC_MSG_WARN(['missing' script is too old or missing])
fi
])

# Helper functions for option handling.                     -*- Autoconf -*-

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_MANGLE_OPTION(NAME)
# -----------------------
AC_DEFUN([_AM_MANGLE_OPTION],
[[_AM_OPTION_]m4_bpatsubst($1, [[^a-zA-Z0-9_]], [_])])

# _AM_SET_OPTION(NAME)
# --------------------
# Set option NAME.  Presently that only means defining a flag for this option.
AC_DEFUN([_AM_SET_OPTION],
[m4_define(_AM_MANGLE_OPTION([$1]), [1])])

# _AM_SET_OPTIONS(OPTIONS)
# ------------------------
# OPTIONS is a space-separated list of Automake options.
AC_DEFUN([_AM_SET_OPTIONS],
[m4_foreach_w([_AM_Option], [$1], [_AM_SET_OPTION(_AM_Option)])])

# _AM_IF_OPTION(OPTION, IF-SET, [IF-NOT-SET])
# -------------------------------------------
# Execute IF-SET if OPTION is set, IF-NOT-SET otherwise.
AC_DEFUN([_AM_IF_OPTION],
[m4_ifset(_AM_MANGLE_OPTION([$1]), [$2], [$3])])

# Copyright (C) 1999-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_PROG_CC_C_O
# ---------------
# Like AC_PROG_CC_C_O, but changed for automake.  We rewrite AC_PROG_CC
# to automatically call this.
AC_DEFUN([_AM_PROG_CC_C_O],
[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
AC_REQUIRE_AUX_FILE([compile])dnl
AC_LANG_PUSH([C])dnl
AC_CACHE_CHECK(
  [whether $CC understands -c and -o together],
  [am_cv_prog_cc_c_o],
  [AC_LANG_CONFTEST([AC_LANG_PROGRAM([])])
  # Make sure it works both with $CC and with simple cc.
  # Following AC_PROG_CC_C_O, we do the test twice because some
  # compilers refuse to overwrite an existing .o file with -o,
  # though they will create one.
  am_cv_prog_cc_c_o=yes
  for am_i in 1 2; do
    if AM_RUN_LOG([$CC -c conftest.$ac_ext -o conftest2.$ac_objext]) \
         && test -f conftest2.$ac_objext; then
      : OK
    else
      am_cv_prog_cc_c_o=no
      break
    fi
  done
  rm -f core conftest*
  unset am_i])
if test "$am_cv_prog_cc_c_o" != yes; then
   # Losing compiler, so override with the script.
   # FIXME: It is wrong to rewrite CC.
   # But if we don't then we get into trouble of one sort or another.
   # A longer-term fix would be to have automake use am__CC in this case,
   # and then we could set am__CC="\$(top_srcdir)/compile \$(CC)"
   CC="$am_aux_dir/compile $CC"
fi
AC_LANG_POP([C])])

# For backward compatibility.
AC_DEFUN_ONCE([AM_PROG_CC_C_O], [AC_REQUIRE([AC_PROG_CC])])

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_RUN_LOG(COMMAND)
# -------------------
# Run COMMAND, save the exit status in ac_status, and log it.
# (This has been adapted from Autoconf's _AC_RUN_LOG macro.)
AC_DEFUN([AM_RUN_LOG],
[{ echo "$as_me:$LINENO: $1" >&AS_MESSAGE_LOG_FD
   ($1) >&AS_MESSAGE_LOG_FD 2>&AS_MESSAGE_LOG_FD
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&AS_MESSAGE_LOG_FD
   (exit $ac_status); }])

# Check to make sure that the build environment is sane.    -*- Autoconf -*-

# Copyright (C) 1996-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_SANITY_CHECK
# ---------------
AC_DEFUN([AM_SANITY_CHECK],
[AC_MSG_CHECKING([whether build environment is sane])
# Reject unsafe characters in $srcdir or the absolute working directory
# name.  Accept space and tab only in the latter.
am_lf='
'
case `pwd` in
  *[[\\\"\#\$\&\'\`$am_lf]]*)
    AC_MSG_ERROR([unsafe absolute working directory name]);;
esac
case $srcdir in
  *[[\\\"\#\$\&\'\`$am_lf\ \	]]*)
    AC_MSG_ERROR([unsafe srcdir value: '$srcdir']);;
esac

# Do 'set' in a subshell so we don't clobber the current shell's
# arguments.  Must try -L first in case configure is actually a
# symlink; some systems play weird games with the mod time of symlinks
# (eg FreeBSD returns the mod time of the symlink's containing
# directory).
if (
   am_has_slept=no
   for am_try in 1 2; do
     echo "timestamp, slept: $am_has_slept" > conftest.file
     set X `ls -Lt "$srcdir/configure" conftest.file 2> /dev/null`
     if test "$[*]" = "X"; then
	# -L didn't work.
	set X `ls -t "$srcdir/configure" conftest.file`
     fi
     if test "$[*]" != "X $srcdir/configure conftest.file" \
	&& test "$[*]" != "X conftest.file $srcdir/configure"; then

	# If neither matched, then we have a broken ls.  This can happen
	# if, for instance, CONFIG_SHELL is bash and it inherits a
	# broken ls alias from the environment.  This has actually
	# happened.  Such a system could not be considered "sane".
	AC_MSG_ERROR([ls -t appears to fail.  Make sure there is not a broken
  alias in your environment])
     fi
     if test "$[2]" = conftest.file || test $am_try -eq 2; then
       break
     fi
     # Just in case.
     sleep 1
     am_has_slept=yes
   done
   test "$[2]" = conftest.file
   )
then
   # Ok.
   :
else
   AC_MSG_ERROR([newly created file is older than distributed files!
Check your system clock])
fi
AC_MSG_RESULT([yes])
# If we didn't sleep, we still need to ensure time stamps of config.status and
# generated files are strictly newer.
am_sleep_pid=
if grep 'slept: no' conftest.file >/dev/null 2>&1; then
  ( sleep 1 ) &
  am_sleep_pid=$!
fi
AC_CONFIG_COMMANDS_PRE(
  [AC_MSG_CHECKING([that generated files are newer than configure])
   if test -n "$am_sleep_pid"; then
     # Hide warnings about reused PIDs.
     wait $am_sleep_pid 2>/dev/null
   fi
   AC_MSG_RESULT([done])])
rm -f conftest.file
])

# Copyright (C) 2009-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_SILENT_RULES([DEFAULT])
# --------------------------
# Enable less verbose build rules; with the default set to DEFAULT
# ("yes" being less verbose, "no" or empty being verbose).
AC_DEFUN([AM_SILENT_RULES],
[AC_ARG_ENABLE([silent-rules], [dnl
AS_HELP_STRING(
  [--enable-silent-rules],
  [less verbose build output (undo: "make V=1")])
AS_HELP_STRING(
  [--disable-silent-rules],
  [verbose build output (undo: "make V=0")])dnl
])
case $enable_silent_rules in @%:@ (((
  yes) AM_DEFAULT_VERBOSITY=0;;
   no) AM_DEFAULT_VERBOSITY=1;;
    *) AM_DEFAULT_VERBOSITY=m4_if([$1], [yes], [0], [1]);;
esac
dnl
dnl A few 'make' implementations (e.g., NonStop OS and NextStep)
dnl do not support nested variable expansions.
dnl See automake bug#9928 and bug#10237.
am_make=${MAKE-make}
AC_CACHE_CHECK([whether $am_make supports nested variables],
   [am_cv_make_support_nested_variables],
   [if AS_ECHO([['TRUE=$(BAR$(V))
BAR0=false
BAR1=true
V=1
am__doit:
	@$(TRUE)
.PHONY: am__doit']]) | $am_make -f - >/dev/null 2>&1; then
  am_cv_make_support_nested_variables=yes
else
  am_cv_make_support_nested_variables=no
fi])
if test $am_cv_make_support_nested_variables = yes; then
  dnl Using '$V' instead of '$(V)' breaks IRIX make.
  AM_V='$(V)'
  AM_DEFAULT_V='$(AM_DEFAULT_VERBOSITY)'
else
  AM_V=$AM_DEFAULT_VERBOSITY
  AM_DEFAULT_V=$AM_DEFAULT_VERBOSITY
fi
AC_SUBST([AM_V])dnl
AM_SUBST_NOTMAKE([AM_V])dnl
AC_SUBST([AM_DEFAULT_V])dnl
AM_SUBST_NOTMAKE([AM_DEFAULT_V])dnl
AC_SUBST([AM_DEFAULT_VERBOSITY])dnl
AM_BACKSLASH='\'
AC_SUBST([AM_BACKSLASH])dnl
_AM_SUBST_NOTMAKE([AM_BACKSLASH])dnl
])

# Copyright (C) 2001-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# AM_PROG_INSTALL_STRIP
# ---------------------
# One issue with vendor 'install' (even GNU) is that you can't
# specify the program used to strip binaries.  This is especially
# annoying in cross-compiling environments, where the build's strip
# is unlikely to handle the host's binaries.
# Fortunately install-sh will honor a STRIPPROG variable, so we
# always use install-sh in "make install-strip", and initialize
# STRIPPROG with the value of the STRIP variable (set by the user).
AC_DEFUN([AM_PROG_INSTALL_STRIP],
[AC_REQUIRE([AM_PROG_INSTALL_SH])dnl
# Installed binaries are usually stripped using 'strip' when the user
# run "make install-strip".  However 'strip' might not be the right
# tool to use in cross-compilation environments, therefore Automake
# will honor the 'STRIP' environment variable to overrule this program.
dnl Don't test for $cross_compiling = yes, because it might be 'maybe'.
if test "$cross_compiling" != no; then
  AC_CHECK_TOOL([STRIP], [strip], :)
fi
INSTALL_STRIP_PROGRAM="\$(install_sh) -c -s"
AC_SUBST([INSTALL_STRIP_PROGRAM])])

# Copyright (C) 2006-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_SUBST_NOTMAKE(VARIABLE)
# ---------------------------
# Prevent Automake from outputting VARIABLE = @VARIABLE@ in Makefile.in.
# This macro is traced by Automake.
AC_DEFUN([_AM_SUBST_NOTMAKE])

# AM_SUBST_NOTMAKE(VARIABLE)
# --------------------------
# Public sister of _AM_SUBST_NOTMAKE.
AC_DEFUN([AM_SUBST_NOTMAKE], [_AM_SUBST_NOTMAKE($@)])

# Check how to create a tarball.                            -*- Autoconf -*-

# Copyright (C) 2004-2018 Free Software Foundation, Inc.
#
# This file is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# _AM_PROG_TAR(FORMAT)
# --------------------
# Check how to create a tarball in format FORMAT.
# FORMAT should be one of 'v7', 'ustar', or 'pax'.
#
# Substitute a variable $(am__tar) that is a command
# writing to stdout a FORMAT-tarball containing the directory
# $tardir.
#     tardir=directory && $(am__tar) > result.tar
#
# Substitute a variable $(am__untar) that extract such
# a tarball read from stdin.
#     $(am__untar) < result.tar
#
AC_DEFUN([_AM_PROG_TAR],
[# Always define AMTAR for backward compatibility.  Yes, it's still used
# in the wild :-(  We should find a proper way to deprecate it ...
AC_SUBST([AMTAR], ['$${TAR-tar}'])

# We'll loop over all known methods to create a tar archive until one works.
_am_tools='gnutar m4_if([$1], [ustar], [plaintar]) pax cpio none'

m4_if([$1], [v7],
  [am__tar='$${TAR-tar} chof - "$$tardir"' am__untar='$${TAR-tar} xf -'],

  [m4_case([$1],
    [ustar],
     [# The POSIX 1988 'ustar' format is defined with fixed-size fields.
      # There is notably a 21 bits limit for the UID and the GID.  In fact,
      # the 'pax' utility can hang on bigger UID/GID (see automake bug#8343
      # and bug#13588).
      am_max_uid=2097151 # 2^21 - 1
      am_max_gid=$am_max_uid
      # The $UID and $GID variables are not portable, so we need to resort
      # to the POSIX-mandated id(1) utility.  Errors in the 'id' calls
      # below are definitely unexpected, so allow the users to see them
      # (that is, avoid stderr redirection).
      am_uid=`id -u || echo unknown`
      am_gid=`id -g || echo unknown`
      AC_MSG_CHECKING([whether UID '$am_uid' is supported by ustar format])
      if test $am_uid -le $am_max_uid; then
         AC_MSG_RESULT([yes])
      else
         AC_MSG_RESULT([no])
         _am_tools=none
      fi
      AC_MSG_CHECKING([whether GID '$am_gid' is supported by ustar format])
      if test $am_gid -le $am_max_gid; then
         AC_MSG_RESULT([yes])
      else
        AC_MSG_RESULT([no])
        _am_tools=none
      fi],

  [pax],
    [],

  [m4_fatal([Unknown tar format])])

  AC_MSG_CHECKING([how to create a $1 tar archive])

  # Go ahead even if we have the value already cached.  We do so because we
  # need to set the values for the 'am__tar' and 'am__untar' variables.
  _am_tools=${am_cv_prog_tar_$1-$_am_tools}

  for _am_tool in $_am_tools; do
    case $_am_tool in
    gnutar)
      for _am_tar in tar gnutar gtar; do
        AM_RUN_LOG([$_am_tar --version]) && break
      done
      am__tar="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$$tardir"'
      am__tar_="$_am_tar --format=m4_if([$1], [pax], [posix], [$1]) -chf - "'"$tardir"'
      am__untar="$_am_tar -xf -"
      ;;
    plaintar)
      # Must skip GNU tar: if it does not support --format= it doesn't create
      # ustar tarball either.
      (tar --version) >/dev/null 2>&1 && continue
      am__tar='tar chf - "$$tardir"'
      am__tar_='tar chf - "$tardir"'
      am__untar='tar xf -'
      ;;
    pax)
      am__tar='pax -L -x $1 -w "$$tardir"'
      am__tar_='pax -L -x $1 -w "$tardir"'
      am__untar='pax -r'
      ;;
    cpio)
      am__tar='find "$$tardir" -print | cpio -o -H $1 -L'
      am__tar_='find "$tardir" -print | cpio -o -H $1 -L'
      am__untar='cpio -i -H $1 -d'
      ;;
    none)
      am__tar=false
      am__tar_=false
      am__untar=false
      ;;
    esac

    # If the value was cached, stop now.  We just wanted to have am__tar
    # and am__untar set.
    test -n "${am_cv_prog_tar_$1}" && break

    # tar/untar a dummy directory, and stop if the command works.
    rm -rf conftest.dir
    mkdir conftest.dir
    echo GrepMe > conftest.dir/file
    AM_RUN_LOG([tardir=conftest.dir && eval $am__tar_ >conftest.tar])
    rm -rf conftest.dir
    if test -s conftest.tar; then
      AM_RUN_LOG([$am__untar <conftest.tar])
      AM_RUN_LOG([cat conftest.dir/file])
      grep GrepMe conftest.dir/file >/dev/null 2>&1 && break
    fi
  done
  rm -rf conftest.dir

  AC_CACHE_VAL([am_cv_prog_tar_$1], [am_cv_prog_tar_$1=$_am_tool])
  AC_MSG_RESULT([$am_cv_prog_tar_$1])])

AC_SUBST([am__tar])
AC_SUBST([am__untar])
]) # _AM_PROG_TAR

+ echo == Makefile.am ==
== Makefile.am ==
+ cat Makefile.am
+ echo == configure.ac ==
== configure.ac ==
+ cat configure.ac
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
# Using AC_PROG_CC in configure.ac should be enough.
# No need to also define, say, xxx_PROGRAMS in Makefile.am.
AC_PROG_CC
+ echo Expected files: compile
Expected files: compile
+ mkdir build-aux
+ cd ..
+ set -x
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-4
+ ls -l generic
total 56
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 41888 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   230 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link compile]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link compile] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link compile] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link compile] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:7: error: required file 'build-aux/compile' not found
configure.ac:7:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[link compile] missing files, automake fails'
+ command_ok_ '[link compile] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link compile] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link compile] missing files, automake fails'
+ set +x
ok 82 - [link compile] missing files, automake fails
PASS: t/add-missing.tap 82 - [link compile] missing files, automake fails
+ for f in $files
+ command_ok_ '[link compile] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link compile] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:7: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[link compile] warn about missing file compile'
+ set +x
ok 83 - [link compile] warn about missing file compile
PASS: t/add-missing.tap 83 - [link compile] warn about missing file compile
+ command_ok_ '[link compile] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link compile] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:7:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[link compile] suggest --add-missing for compile'
+ set +x
ok 84 - [link compile] suggest --add-missing for compile
PASS: t/add-missing.tap 84 - [link compile] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link compile] no extra files installed'
+ set +x
ok 85 - [link compile] no extra files installed
PASS: t/add-missing.tap 85 - [link compile] no extra files installed
+ AUTOMAKE_run -d '[link compile] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link compile] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:7: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[link compile] automake run successfully'
+ command_ok_ '[link compile] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link compile] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link compile] automake run successfully'
+ set +x
ok 86 - [link compile] automake run successfully
PASS: t/add-missing.tap 86 - [link compile] automake run successfully
+ ls -l . build-aux
.:
total 80
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16792 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 41888 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   230 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   144 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 36 Nov 27 06:37 compile -> /sources/automake-1.16.1/lib/compile
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link compile] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link compile] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[link compile] file compile installed'
+ set +x
ok 87 - [link compile] file compile installed
PASS: t/add-missing.tap 87 - [link compile] file compile installed
+ for f in $files
+ command_ok_ '[link compile] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link compile] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:7: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[link compile] report installation of compile'
+ set +x
ok 88 - [link compile] report installation of compile
PASS: t/add-missing.tap 88 - [link compile] report installation of compile
+ all_files='install-sh missing  compile'
+ for f in $all_files
+ echo install-sh
+ sort
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo compile
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
compile
install-sh
missing
+ cat files.got
compile
install-sh
missing
+ command_ok_ '[link compile] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link compile] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link compile] all and only expected files installed'
+ set +x
ok 89 - [link compile] all and only expected files installed
PASS: t/add-missing.tap 89 - [link compile] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link compile] compile has been symlinked'
+ result_ ok '[link compile] compile has been symlinked'
+ set +x
ok 90 - [link compile] compile has been symlinked
PASS: t/add-missing.tap 90 - [link compile] compile has been symlinked
+ AUTOMAKE_run -d '[link compile] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link compile] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link compile] automake finds all added files'
+ command_ok_ '[link compile] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link compile] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link compile] automake finds all added files'
+ set +x
ok 91 - [link compile] automake finds all added files
PASS: t/add-missing.tap 91 - [link compile] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy compile]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy compile] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy compile] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy compile] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:7: error: required file 'build-aux/compile' not found
configure.ac:7:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[copy compile] missing files, automake fails'
+ command_ok_ '[copy compile] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy compile] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy compile] missing files, automake fails'
+ set +x
ok 92 - [copy compile] missing files, automake fails
PASS: t/add-missing.tap 92 - [copy compile] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy compile] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy compile] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:7: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[copy compile] warn about missing file compile'
+ set +x
ok 93 - [copy compile] warn about missing file compile
PASS: t/add-missing.tap 93 - [copy compile] warn about missing file compile
+ command_ok_ '[copy compile] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy compile] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:7:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[copy compile] suggest --add-missing for compile'
+ set +x
ok 94 - [copy compile] suggest --add-missing for compile
PASS: t/add-missing.tap 94 - [copy compile] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy compile] no extra files installed'
+ set +x
ok 95 - [copy compile] no extra files installed
PASS: t/add-missing.tap 95 - [copy compile] no extra files installed
+ AUTOMAKE_run -d '[copy compile] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy compile] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:7: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[copy compile] automake run successfully'
+ command_ok_ '[copy compile] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy compile] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy compile] automake run successfully'
+ set +x
ok 96 - [copy compile] automake run successfully
PASS: t/add-missing.tap 96 - [copy compile] automake run successfully
+ ls -l . build-aux
.:
total 80
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16792 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 41888 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   230 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   144 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 32
-rwxr-xr-x 1 root root  7383 Nov 27 06:37 compile
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy compile] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy compile] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[copy compile] file compile installed'
+ set +x
ok 97 - [copy compile] file compile installed
PASS: t/add-missing.tap 97 - [copy compile] file compile installed
+ for f in $files
+ command_ok_ '[copy compile] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy compile] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:7: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[copy compile] report installation of compile'
+ set +x
ok 98 - [copy compile] report installation of compile
PASS: t/add-missing.tap 98 - [copy compile] report installation of compile
+ all_files='install-sh missing  compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo compile
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
compile
install-sh
missing
+ cat files.got
compile
install-sh
missing
+ command_ok_ '[copy compile] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy compile] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy compile] all and only expected files installed'
+ set +x
ok 99 - [copy compile] all and only expected files installed
PASS: t/add-missing.tap 99 - [copy compile] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy compile] compile has not been symlinked'
+ result_ ok '[copy compile] compile has not been symlinked'
+ set +x
ok 100 - [copy compile] compile has not been symlinked
PASS: t/add-missing.tap 100 - [copy compile] compile has not been symlinked
+ AUTOMAKE_run -d '[copy compile] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy compile] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy compile] automake finds all added files'
+ command_ok_ '[copy compile] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy compile] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy compile] automake finds all added files'
+ set +x
ok 101 - [copy compile] automake finds all added files
PASS: t/add-missing.tap 101 - [copy compile] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ for mach in build host target system
++ echo build
++ LC_ALL=C
++ tr '[a-z]' '[A-Z]'
+ MACH=BUILD
+ check_
+ set +x
check count: 5
== Makefile.am ==
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_CANONICAL_BUILD
Expected files: config.sub config.guess
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-5
+ ls -l generic
total 60
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   125 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link cfg-build]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link cfg-build] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link cfg-build] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-build] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-build] missing files, automake fails'
+ command_ok_ '[link cfg-build] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link cfg-build] missing files, automake fails'
+ set +x
ok 102 - [link cfg-build] missing files, automake fails
PASS: t/add-missing.tap 102 - [link cfg-build] missing files, automake fails
+ for f in $files
+ command_ok_ '[link cfg-build] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[link cfg-build] warn about missing file config.sub'
+ set +x
ok 103 - [link cfg-build] warn about missing file config.sub
PASS: t/add-missing.tap 103 - [link cfg-build] warn about missing file config.sub
+ command_ok_ '[link cfg-build] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-build] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-build] suggest --add-missing for config.sub'
+ set +x
ok 104 - [link cfg-build] suggest --add-missing for config.sub
PASS: t/add-missing.tap 104 - [link cfg-build] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[link cfg-build] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[link cfg-build] warn about missing file config.guess'
+ set +x
ok 105 - [link cfg-build] warn about missing file config.guess
PASS: t/add-missing.tap 105 - [link cfg-build] warn about missing file config.guess
+ command_ok_ '[link cfg-build] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-build] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-build] suggest --add-missing for config.guess'
+ set +x
ok 106 - [link cfg-build] suggest --add-missing for config.guess
PASS: t/add-missing.tap 106 - [link cfg-build] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link cfg-build] no extra files installed'
+ set +x
ok 107 - [link cfg-build] no extra files installed
PASS: t/add-missing.tap 107 - [link cfg-build] no extra files installed
+ AUTOMAKE_run -d '[link cfg-build] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link cfg-build] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-build] automake run successfully'
+ command_ok_ '[link cfg-build] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-build] automake run successfully'
+ set +x
ok 108 - [link cfg-build] automake run successfully
PASS: t/add-missing.tap 108 - [link cfg-build] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16779 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   125 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   199 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 41 Nov 27 06:37 config.guess -> /sources/automake-1.16.1/lib/config.guess
lrwxrwxrwx 1 root root 39 Nov 27 06:37 config.sub -> /sources/automake-1.16.1/lib/config.sub
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link cfg-build] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-build] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[link cfg-build] file config.sub installed'
+ set +x
ok 109 - [link cfg-build] file config.sub installed
PASS: t/add-missing.tap 109 - [link cfg-build] file config.sub installed
+ for f in $files
+ command_ok_ '[link cfg-build] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-build] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[link cfg-build] file config.guess installed'
+ set +x
ok 110 - [link cfg-build] file config.guess installed
PASS: t/add-missing.tap 110 - [link cfg-build] file config.guess installed
+ for f in $files
+ command_ok_ '[link cfg-build] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-build] report installation of config.sub'
+ set +x
ok 111 - [link cfg-build] report installation of config.sub
PASS: t/add-missing.tap 111 - [link cfg-build] report installation of config.sub
+ for f in $files
+ command_ok_ '[link cfg-build] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-build] report installation of config.guess'
+ set +x
ok 112 - [link cfg-build] report installation of config.guess
PASS: t/add-missing.tap 112 - [link cfg-build] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ uniq
+ for f in $all_files
+ sort
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ sort
+ cd build-aux
+ ls
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[link cfg-build] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link cfg-build] all and only expected files installed'
+ set +x
ok 113 - [link cfg-build] all and only expected files installed
PASS: t/add-missing.tap 113 - [link cfg-build] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-build] config.sub has been symlinked'
+ result_ ok '[link cfg-build] config.sub has been symlinked'
+ set +x
ok 114 - [link cfg-build] config.sub has been symlinked
PASS: t/add-missing.tap 114 - [link cfg-build] config.sub has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-build] config.guess has been symlinked'
+ result_ ok '[link cfg-build] config.guess has been symlinked'
+ set +x
ok 115 - [link cfg-build] config.guess has been symlinked
PASS: t/add-missing.tap 115 - [link cfg-build] config.guess has been symlinked
+ AUTOMAKE_run -d '[link cfg-build] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-build] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link cfg-build] automake finds all added files'
+ command_ok_ '[link cfg-build] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-build] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-build] automake finds all added files'
+ set +x
ok 116 - [link cfg-build] automake finds all added files
PASS: t/add-missing.tap 116 - [link cfg-build] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy cfg-build]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy cfg-build] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy cfg-build] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-build] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-build] missing files, automake fails'
+ command_ok_ '[copy cfg-build] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy cfg-build] missing files, automake fails'
+ set +x
ok 117 - [copy cfg-build] missing files, automake fails
PASS: t/add-missing.tap 117 - [copy cfg-build] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy cfg-build] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[copy cfg-build] warn about missing file config.sub'
+ set +x
ok 118 - [copy cfg-build] warn about missing file config.sub
PASS: t/add-missing.tap 118 - [copy cfg-build] warn about missing file config.sub
+ command_ok_ '[copy cfg-build] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-build] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-build] suggest --add-missing for config.sub'
+ set +x
ok 119 - [copy cfg-build] suggest --add-missing for config.sub
PASS: t/add-missing.tap 119 - [copy cfg-build] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[copy cfg-build] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[copy cfg-build] warn about missing file config.guess'
+ set +x
ok 120 - [copy cfg-build] warn about missing file config.guess
PASS: t/add-missing.tap 120 - [copy cfg-build] warn about missing file config.guess
+ command_ok_ '[copy cfg-build] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-build] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-build] suggest --add-missing for config.guess'
+ set +x
ok 121 - [copy cfg-build] suggest --add-missing for config.guess
PASS: t/add-missing.tap 121 - [copy cfg-build] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy cfg-build] no extra files installed'
+ set +x
ok 122 - [copy cfg-build] no extra files installed
PASS: t/add-missing.tap 122 - [copy cfg-build] no extra files installed
+ AUTOMAKE_run -d '[copy cfg-build] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy cfg-build] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-build] automake run successfully'
+ command_ok_ '[copy cfg-build] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-build] automake run successfully'
+ set +x
ok 123 - [copy cfg-build] automake run successfully
PASS: t/add-missing.tap 123 - [copy cfg-build] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16779 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   125 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   199 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 104
-rwxr-xr-x 1 root root 44166 Nov 27 06:37 config.guess
-rwxr-xr-x 1 root root 36141 Nov 27 06:37 config.sub
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy cfg-build] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-build] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[copy cfg-build] file config.sub installed'
+ set +x
ok 124 - [copy cfg-build] file config.sub installed
PASS: t/add-missing.tap 124 - [copy cfg-build] file config.sub installed
+ for f in $files
+ command_ok_ '[copy cfg-build] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-build] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[copy cfg-build] file config.guess installed'
+ set +x
ok 125 - [copy cfg-build] file config.guess installed
PASS: t/add-missing.tap 125 - [copy cfg-build] file config.guess installed
+ for f in $files
+ command_ok_ '[copy cfg-build] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-build] report installation of config.sub'
+ set +x
ok 126 - [copy cfg-build] report installation of config.sub
PASS: t/add-missing.tap 126 - [copy cfg-build] report installation of config.sub
+ for f in $files
+ command_ok_ '[copy cfg-build] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-build] report installation of config.guess'
+ set +x
ok 127 - [copy cfg-build] report installation of config.guess
PASS: t/add-missing.tap 127 - [copy cfg-build] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ for f in $all_files
+ sort
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[copy cfg-build] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy cfg-build] all and only expected files installed'
+ set +x
ok 128 - [copy cfg-build] all and only expected files installed
PASS: t/add-missing.tap 128 - [copy cfg-build] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-build] config.sub has not been symlinked'
+ result_ ok '[copy cfg-build] config.sub has not been symlinked'
+ set +x
ok 129 - [copy cfg-build] config.sub has not been symlinked
PASS: t/add-missing.tap 129 - [copy cfg-build] config.sub has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-build] config.guess has not been symlinked'
+ result_ ok '[copy cfg-build] config.guess has not been symlinked'
+ set +x
ok 130 - [copy cfg-build] config.guess has not been symlinked
PASS: t/add-missing.tap 130 - [copy cfg-build] config.guess has not been symlinked
+ AUTOMAKE_run -d '[copy cfg-build] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-build] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-build] automake finds all added files'
+ command_ok_ '[copy cfg-build] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-build] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-build] automake finds all added files'
+ set +x
ok 131 - [copy cfg-build] automake finds all added files
PASS: t/add-missing.tap 131 - [copy cfg-build] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ for mach in build host target system
++ echo host
++ LC_ALL=C
++ tr '[a-z]' '[A-Z]'
+ MACH=HOST
+ check_
+ set +x
check count: 6
== Makefile.am ==
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_CANONICAL_HOST
Expected files: config.sub config.guess
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-6
+ ls -l generic
total 60
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   124 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link cfg-host]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link cfg-host] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link cfg-host] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-host] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-host] missing files, automake fails'
+ command_ok_ '[link cfg-host] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link cfg-host] missing files, automake fails'
+ set +x
ok 132 - [link cfg-host] missing files, automake fails
PASS: t/add-missing.tap 132 - [link cfg-host] missing files, automake fails
+ for f in $files
+ command_ok_ '[link cfg-host] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[link cfg-host] warn about missing file config.sub'
+ set +x
ok 133 - [link cfg-host] warn about missing file config.sub
PASS: t/add-missing.tap 133 - [link cfg-host] warn about missing file config.sub
+ command_ok_ '[link cfg-host] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-host] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-host] suggest --add-missing for config.sub'
+ set +x
ok 134 - [link cfg-host] suggest --add-missing for config.sub
PASS: t/add-missing.tap 134 - [link cfg-host] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[link cfg-host] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[link cfg-host] warn about missing file config.guess'
+ set +x
ok 135 - [link cfg-host] warn about missing file config.guess
PASS: t/add-missing.tap 135 - [link cfg-host] warn about missing file config.guess
+ command_ok_ '[link cfg-host] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-host] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-host] suggest --add-missing for config.guess'
+ set +x
ok 136 - [link cfg-host] suggest --add-missing for config.guess
PASS: t/add-missing.tap 136 - [link cfg-host] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link cfg-host] no extra files installed'
+ set +x
ok 137 - [link cfg-host] no extra files installed
PASS: t/add-missing.tap 137 - [link cfg-host] no extra files installed
+ AUTOMAKE_run -d '[link cfg-host] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link cfg-host] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-host] automake run successfully'
+ command_ok_ '[link cfg-host] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-host] automake run successfully'
+ set +x
ok 138 - [link cfg-host] automake run successfully
PASS: t/add-missing.tap 138 - [link cfg-host] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16885 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   124 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   199 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 41 Nov 27 06:37 config.guess -> /sources/automake-1.16.1/lib/config.guess
lrwxrwxrwx 1 root root 39 Nov 27 06:37 config.sub -> /sources/automake-1.16.1/lib/config.sub
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link cfg-host] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-host] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[link cfg-host] file config.sub installed'
+ set +x
ok 139 - [link cfg-host] file config.sub installed
PASS: t/add-missing.tap 139 - [link cfg-host] file config.sub installed
+ for f in $files
+ command_ok_ '[link cfg-host] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-host] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[link cfg-host] file config.guess installed'
+ set +x
ok 140 - [link cfg-host] file config.guess installed
PASS: t/add-missing.tap 140 - [link cfg-host] file config.guess installed
+ for f in $files
+ command_ok_ '[link cfg-host] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-host] report installation of config.sub'
+ set +x
ok 141 - [link cfg-host] report installation of config.sub
PASS: t/add-missing.tap 141 - [link cfg-host] report installation of config.sub
+ for f in $files
+ command_ok_ '[link cfg-host] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-host] report installation of config.guess'
+ set +x
ok 142 - [link cfg-host] report installation of config.guess
PASS: t/add-missing.tap 142 - [link cfg-host] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[link cfg-host] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link cfg-host] all and only expected files installed'
+ set +x
ok 143 - [link cfg-host] all and only expected files installed
PASS: t/add-missing.tap 143 - [link cfg-host] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-host] config.sub has been symlinked'
+ result_ ok '[link cfg-host] config.sub has been symlinked'
+ set +x
ok 144 - [link cfg-host] config.sub has been symlinked
PASS: t/add-missing.tap 144 - [link cfg-host] config.sub has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-host] config.guess has been symlinked'
+ result_ ok '[link cfg-host] config.guess has been symlinked'
+ set +x
ok 145 - [link cfg-host] config.guess has been symlinked
PASS: t/add-missing.tap 145 - [link cfg-host] config.guess has been symlinked
+ AUTOMAKE_run -d '[link cfg-host] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-host] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link cfg-host] automake finds all added files'
+ command_ok_ '[link cfg-host] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-host] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-host] automake finds all added files'
+ set +x
ok 146 - [link cfg-host] automake finds all added files
PASS: t/add-missing.tap 146 - [link cfg-host] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy cfg-host]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy cfg-host] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy cfg-host] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-host] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-host] missing files, automake fails'
+ command_ok_ '[copy cfg-host] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy cfg-host] missing files, automake fails'
+ set +x
ok 147 - [copy cfg-host] missing files, automake fails
PASS: t/add-missing.tap 147 - [copy cfg-host] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy cfg-host] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[copy cfg-host] warn about missing file config.sub'
+ set +x
ok 148 - [copy cfg-host] warn about missing file config.sub
PASS: t/add-missing.tap 148 - [copy cfg-host] warn about missing file config.sub
+ command_ok_ '[copy cfg-host] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-host] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-host] suggest --add-missing for config.sub'
+ set +x
ok 149 - [copy cfg-host] suggest --add-missing for config.sub
PASS: t/add-missing.tap 149 - [copy cfg-host] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[copy cfg-host] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[copy cfg-host] warn about missing file config.guess'
+ set +x
ok 150 - [copy cfg-host] warn about missing file config.guess
PASS: t/add-missing.tap 150 - [copy cfg-host] warn about missing file config.guess
+ command_ok_ '[copy cfg-host] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-host] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-host] suggest --add-missing for config.guess'
+ set +x
ok 151 - [copy cfg-host] suggest --add-missing for config.guess
PASS: t/add-missing.tap 151 - [copy cfg-host] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy cfg-host] no extra files installed'
+ set +x
ok 152 - [copy cfg-host] no extra files installed
PASS: t/add-missing.tap 152 - [copy cfg-host] no extra files installed
+ AUTOMAKE_run -d '[copy cfg-host] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy cfg-host] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-host] automake run successfully'
+ command_ok_ '[copy cfg-host] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-host] automake run successfully'
+ set +x
ok 153 - [copy cfg-host] automake run successfully
PASS: t/add-missing.tap 153 - [copy cfg-host] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 16885 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   124 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   199 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 104
-rwxr-xr-x 1 root root 44166 Nov 27 06:37 config.guess
-rwxr-xr-x 1 root root 36141 Nov 27 06:37 config.sub
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy cfg-host] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-host] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[copy cfg-host] file config.sub installed'
+ set +x
ok 154 - [copy cfg-host] file config.sub installed
PASS: t/add-missing.tap 154 - [copy cfg-host] file config.sub installed
+ for f in $files
+ command_ok_ '[copy cfg-host] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-host] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[copy cfg-host] file config.guess installed'
+ set +x
ok 155 - [copy cfg-host] file config.guess installed
PASS: t/add-missing.tap 155 - [copy cfg-host] file config.guess installed
+ for f in $files
+ command_ok_ '[copy cfg-host] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-host] report installation of config.sub'
+ set +x
ok 156 - [copy cfg-host] report installation of config.sub
PASS: t/add-missing.tap 156 - [copy cfg-host] report installation of config.sub
+ for f in $files
+ command_ok_ '[copy cfg-host] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-host] report installation of config.guess'
+ set +x
ok 157 - [copy cfg-host] report installation of config.guess
PASS: t/add-missing.tap 157 - [copy cfg-host] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[copy cfg-host] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy cfg-host] all and only expected files installed'
+ set +x
ok 158 - [copy cfg-host] all and only expected files installed
PASS: t/add-missing.tap 158 - [copy cfg-host] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-host] config.sub has not been symlinked'
+ result_ ok '[copy cfg-host] config.sub has not been symlinked'
+ set +x
ok 159 - [copy cfg-host] config.sub has not been symlinked
PASS: t/add-missing.tap 159 - [copy cfg-host] config.sub has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-host] config.guess has not been symlinked'
+ result_ ok '[copy cfg-host] config.guess has not been symlinked'
+ set +x
ok 160 - [copy cfg-host] config.guess has not been symlinked
PASS: t/add-missing.tap 160 - [copy cfg-host] config.guess has not been symlinked
+ AUTOMAKE_run -d '[copy cfg-host] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-host] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-host] automake finds all added files'
+ command_ok_ '[copy cfg-host] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-host] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-host] automake finds all added files'
+ set +x
ok 161 - [copy cfg-host] automake finds all added files
PASS: t/add-missing.tap 161 - [copy cfg-host] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ for mach in build host target system
++ echo target
++ LC_ALL=C
++ tr '[a-z]' '[A-Z]'
+ MACH=TARGET
+ check_
+ set +x
check count: 7
== Makefile.am ==
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_CANONICAL_TARGET
Expected files: config.sub config.guess
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-7
+ ls -l generic
total 60
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   126 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link cfg-target]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link cfg-target] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link cfg-target] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-target] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:5: the top level
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-target] missing files, automake fails'
+ command_ok_ '[link cfg-target] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link cfg-target] missing files, automake fails'
+ set +x
ok 162 - [link cfg-target] missing files, automake fails
PASS: t/add-missing.tap 162 - [link cfg-target] missing files, automake fails
+ for f in $files
+ command_ok_ '[link cfg-target] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[link cfg-target] warn about missing file config.sub'
+ set +x
ok 163 - [link cfg-target] warn about missing file config.sub
PASS: t/add-missing.tap 163 - [link cfg-target] warn about missing file config.sub
+ command_ok_ '[link cfg-target] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-target] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-target] suggest --add-missing for config.sub'
+ set +x
ok 164 - [link cfg-target] suggest --add-missing for config.sub
PASS: t/add-missing.tap 164 - [link cfg-target] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[link cfg-target] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[link cfg-target] warn about missing file config.guess'
+ set +x
ok 165 - [link cfg-target] warn about missing file config.guess
PASS: t/add-missing.tap 165 - [link cfg-target] warn about missing file config.guess
+ command_ok_ '[link cfg-target] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-target] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-target] suggest --add-missing for config.guess'
+ set +x
ok 166 - [link cfg-target] suggest --add-missing for config.guess
PASS: t/add-missing.tap 166 - [link cfg-target] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link cfg-target] no extra files installed'
+ set +x
ok 167 - [link cfg-target] no extra files installed
PASS: t/add-missing.tap 167 - [link cfg-target] no extra files installed
+ AUTOMAKE_run -d '[link cfg-target] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link cfg-target] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:5: the top level
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-target] automake run successfully'
+ command_ok_ '[link cfg-target] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-target] automake run successfully'
+ set +x
ok 168 - [link cfg-target] automake run successfully
PASS: t/add-missing.tap 168 - [link cfg-target] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 17011 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   126 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   383 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 41 Nov 27 06:37 config.guess -> /sources/automake-1.16.1/lib/config.guess
lrwxrwxrwx 1 root root 39 Nov 27 06:37 config.sub -> /sources/automake-1.16.1/lib/config.sub
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link cfg-target] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-target] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[link cfg-target] file config.sub installed'
+ set +x
ok 169 - [link cfg-target] file config.sub installed
PASS: t/add-missing.tap 169 - [link cfg-target] file config.sub installed
+ for f in $files
+ command_ok_ '[link cfg-target] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-target] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[link cfg-target] file config.guess installed'
+ set +x
ok 170 - [link cfg-target] file config.guess installed
PASS: t/add-missing.tap 170 - [link cfg-target] file config.guess installed
+ for f in $files
+ command_ok_ '[link cfg-target] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-target] report installation of config.sub'
+ set +x
ok 171 - [link cfg-target] report installation of config.sub
PASS: t/add-missing.tap 171 - [link cfg-target] report installation of config.sub
+ for f in $files
+ command_ok_ '[link cfg-target] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-target] report installation of config.guess'
+ set +x
ok 172 - [link cfg-target] report installation of config.guess
PASS: t/add-missing.tap 172 - [link cfg-target] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ sort
+ echo config.guess
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[link cfg-target] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link cfg-target] all and only expected files installed'
+ set +x
ok 173 - [link cfg-target] all and only expected files installed
PASS: t/add-missing.tap 173 - [link cfg-target] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-target] config.sub has been symlinked'
+ result_ ok '[link cfg-target] config.sub has been symlinked'
+ set +x
ok 174 - [link cfg-target] config.sub has been symlinked
PASS: t/add-missing.tap 174 - [link cfg-target] config.sub has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-target] config.guess has been symlinked'
+ result_ ok '[link cfg-target] config.guess has been symlinked'
+ set +x
ok 175 - [link cfg-target] config.guess has been symlinked
PASS: t/add-missing.tap 175 - [link cfg-target] config.guess has been symlinked
+ AUTOMAKE_run -d '[link cfg-target] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-target] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:5: the top level
+ cat stdout
+ test tap = none
+ test -z '[link cfg-target] automake finds all added files'
+ command_ok_ '[link cfg-target] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-target] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-target] automake finds all added files'
+ set +x
ok 176 - [link cfg-target] automake finds all added files
PASS: t/add-missing.tap 176 - [link cfg-target] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy cfg-target]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy cfg-target] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy cfg-target] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-target] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:5: the top level
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-target] missing files, automake fails'
+ command_ok_ '[copy cfg-target] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy cfg-target] missing files, automake fails'
+ set +x
ok 177 - [copy cfg-target] missing files, automake fails
PASS: t/add-missing.tap 177 - [copy cfg-target] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy cfg-target] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[copy cfg-target] warn about missing file config.sub'
+ set +x
ok 178 - [copy cfg-target] warn about missing file config.sub
PASS: t/add-missing.tap 178 - [copy cfg-target] warn about missing file config.sub
+ command_ok_ '[copy cfg-target] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-target] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-target] suggest --add-missing for config.sub'
+ set +x
ok 179 - [copy cfg-target] suggest --add-missing for config.sub
PASS: t/add-missing.tap 179 - [copy cfg-target] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[copy cfg-target] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[copy cfg-target] warn about missing file config.guess'
+ set +x
ok 180 - [copy cfg-target] warn about missing file config.guess
PASS: t/add-missing.tap 180 - [copy cfg-target] warn about missing file config.guess
+ command_ok_ '[copy cfg-target] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-target] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-target] suggest --add-missing for config.guess'
+ set +x
ok 181 - [copy cfg-target] suggest --add-missing for config.guess
PASS: t/add-missing.tap 181 - [copy cfg-target] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy cfg-target] no extra files installed'
+ set +x
ok 182 - [copy cfg-target] no extra files installed
PASS: t/add-missing.tap 182 - [copy cfg-target] no extra files installed
+ AUTOMAKE_run -d '[copy cfg-target] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy cfg-target] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:5: the top level
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-target] automake run successfully'
+ command_ok_ '[copy cfg-target] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-target] automake run successfully'
+ set +x
ok 183 - [copy cfg-target] automake run successfully
PASS: t/add-missing.tap 183 - [copy cfg-target] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 17011 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   126 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   383 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 104
-rwxr-xr-x 1 root root 44166 Nov 27 06:37 config.guess
-rwxr-xr-x 1 root root 36141 Nov 27 06:37 config.sub
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy cfg-target] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-target] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[copy cfg-target] file config.sub installed'
+ set +x
ok 184 - [copy cfg-target] file config.sub installed
PASS: t/add-missing.tap 184 - [copy cfg-target] file config.sub installed
+ for f in $files
+ command_ok_ '[copy cfg-target] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-target] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[copy cfg-target] file config.guess installed'
+ set +x
ok 185 - [copy cfg-target] file config.guess installed
PASS: t/add-missing.tap 185 - [copy cfg-target] file config.guess installed
+ for f in $files
+ command_ok_ '[copy cfg-target] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-target] report installation of config.sub'
+ set +x
ok 186 - [copy cfg-target] report installation of config.sub
PASS: t/add-missing.tap 186 - [copy cfg-target] report installation of config.sub
+ for f in $files
+ command_ok_ '[copy cfg-target] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-target] report installation of config.guess'
+ set +x
ok 187 - [copy cfg-target] report installation of config.guess
PASS: t/add-missing.tap 187 - [copy cfg-target] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ sort
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[copy cfg-target] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy cfg-target] all and only expected files installed'
+ set +x
ok 188 - [copy cfg-target] all and only expected files installed
PASS: t/add-missing.tap 188 - [copy cfg-target] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-target] config.sub has not been symlinked'
+ result_ ok '[copy cfg-target] config.sub has not been symlinked'
+ set +x
ok 189 - [copy cfg-target] config.sub has not been symlinked
PASS: t/add-missing.tap 189 - [copy cfg-target] config.sub has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-target] config.guess has not been symlinked'
+ result_ ok '[copy cfg-target] config.guess has not been symlinked'
+ set +x
ok 190 - [copy cfg-target] config.guess has not been symlinked
PASS: t/add-missing.tap 190 - [copy cfg-target] config.guess has not been symlinked
+ AUTOMAKE_run -d '[copy cfg-target] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-target] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1833: AC_CANONICAL_TARGET is expanded from...
configure.ac:5: the top level
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-target] automake finds all added files'
+ command_ok_ '[copy cfg-target] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-target] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-target] automake finds all added files'
+ set +x
ok 191 - [copy cfg-target] automake finds all added files
PASS: t/add-missing.tap 191 - [copy cfg-target] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ for mach in build host target system
++ echo system
++ LC_ALL=C
++ tr '[a-z]' '[A-Z]'
+ MACH=SYSTEM
+ check_
+ set +x
check count: 8
== Makefile.am ==
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_CANONICAL_SYSTEM
Expected files: config.sub config.guess
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-8
+ ls -l generic
total 60
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   126 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link cfg-system]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link cfg-system] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link cfg-system] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-system] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1857: AC_CANONICAL_SYSTEM is expanded from...
configure.ac:5: the top level
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-system] missing files, automake fails'
+ command_ok_ '[link cfg-system] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link cfg-system] missing files, automake fails'
+ set +x
ok 192 - [link cfg-system] missing files, automake fails
PASS: t/add-missing.tap 192 - [link cfg-system] missing files, automake fails
+ for f in $files
+ command_ok_ '[link cfg-system] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[link cfg-system] warn about missing file config.sub'
+ set +x
ok 193 - [link cfg-system] warn about missing file config.sub
PASS: t/add-missing.tap 193 - [link cfg-system] warn about missing file config.sub
+ command_ok_ '[link cfg-system] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-system] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-system] suggest --add-missing for config.sub'
+ set +x
ok 194 - [link cfg-system] suggest --add-missing for config.sub
PASS: t/add-missing.tap 194 - [link cfg-system] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[link cfg-system] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[link cfg-system] warn about missing file config.guess'
+ set +x
ok 195 - [link cfg-system] warn about missing file config.guess
PASS: t/add-missing.tap 195 - [link cfg-system] warn about missing file config.guess
+ command_ok_ '[link cfg-system] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-system] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-system] suggest --add-missing for config.guess'
+ set +x
ok 196 - [link cfg-system] suggest --add-missing for config.guess
PASS: t/add-missing.tap 196 - [link cfg-system] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link cfg-system] no extra files installed'
+ set +x
ok 197 - [link cfg-system] no extra files installed
PASS: t/add-missing.tap 197 - [link cfg-system] no extra files installed
+ AUTOMAKE_run -d '[link cfg-system] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link cfg-system] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1857: AC_CANONICAL_SYSTEM is expanded from...
configure.ac:5: the top level
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[link cfg-system] automake run successfully'
+ command_ok_ '[link cfg-system] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-system] automake run successfully'
+ set +x
ok 198 - [link cfg-system] automake run successfully
PASS: t/add-missing.tap 198 - [link cfg-system] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 17011 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   126 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   383 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 41 Nov 27 06:37 config.guess -> /sources/automake-1.16.1/lib/config.guess
lrwxrwxrwx 1 root root 39 Nov 27 06:37 config.sub -> /sources/automake-1.16.1/lib/config.sub
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
+ for f in $files
+ command_ok_ '[link cfg-system] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-system] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[link cfg-system] file config.sub installed'
+ set +x
ok 199 - [link cfg-system] file config.sub installed
PASS: t/add-missing.tap 199 - [link cfg-system] file config.sub installed
+ for f in $files
+ command_ok_ '[link cfg-system] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link cfg-system] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[link cfg-system] file config.guess installed'
+ set +x
ok 200 - [link cfg-system] file config.guess installed
PASS: t/add-missing.tap 200 - [link cfg-system] file config.guess installed
+ for f in $files
+ command_ok_ '[link cfg-system] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[link cfg-system] report installation of config.sub'
+ set +x
ok 201 - [link cfg-system] report installation of config.sub
PASS: t/add-missing.tap 201 - [link cfg-system] report installation of config.sub
+ for f in $files
+ command_ok_ '[link cfg-system] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[link cfg-system] report installation of config.guess'
+ set +x
ok 202 - [link cfg-system] report installation of config.guess
PASS: t/add-missing.tap 202 - [link cfg-system] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ sort
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[link cfg-system] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link cfg-system] all and only expected files installed'
+ set +x
ok 203 - [link cfg-system] all and only expected files installed
PASS: t/add-missing.tap 203 - [link cfg-system] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-system] config.sub has been symlinked'
+ result_ ok '[link cfg-system] config.sub has been symlinked'
+ set +x
ok 204 - [link cfg-system] config.sub has been symlinked
PASS: t/add-missing.tap 204 - [link cfg-system] config.sub has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link cfg-system] config.guess has been symlinked'
+ result_ ok '[link cfg-system] config.guess has been symlinked'
+ set +x
ok 205 - [link cfg-system] config.guess has been symlinked
PASS: t/add-missing.tap 205 - [link cfg-system] config.guess has been symlinked
+ AUTOMAKE_run -d '[link cfg-system] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link cfg-system] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1857: AC_CANONICAL_SYSTEM is expanded from...
configure.ac:5: the top level
+ cat stdout
+ test tap = none
+ test -z '[link cfg-system] automake finds all added files'
+ command_ok_ '[link cfg-system] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link cfg-system] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link cfg-system] automake finds all added files'
+ set +x
ok 206 - [link cfg-system] automake finds all added files
PASS: t/add-missing.tap 206 - [link cfg-system] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy cfg-system]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy cfg-system] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy cfg-system] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-system] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1857: AC_CANONICAL_SYSTEM is expanded from...
configure.ac:5: the top level
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-system] missing files, automake fails'
+ command_ok_ '[copy cfg-system] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy cfg-system] missing files, automake fails'
+ set +x
ok 207 - [copy cfg-system] missing files, automake fails
PASS: t/add-missing.tap 207 - [copy cfg-system] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy cfg-system] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[copy cfg-system] warn about missing file config.sub'
+ set +x
ok 208 - [copy cfg-system] warn about missing file config.sub
PASS: t/add-missing.tap 208 - [copy cfg-system] warn about missing file config.sub
+ command_ok_ '[copy cfg-system] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-system] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-system] suggest --add-missing for config.sub'
+ set +x
ok 209 - [copy cfg-system] suggest --add-missing for config.sub
PASS: t/add-missing.tap 209 - [copy cfg-system] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[copy cfg-system] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[copy cfg-system] warn about missing file config.guess'
+ set +x
ok 210 - [copy cfg-system] warn about missing file config.guess
PASS: t/add-missing.tap 210 - [copy cfg-system] warn about missing file config.guess
+ command_ok_ '[copy cfg-system] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-system] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-system] suggest --add-missing for config.guess'
+ set +x
ok 211 - [copy cfg-system] suggest --add-missing for config.guess
PASS: t/add-missing.tap 211 - [copy cfg-system] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy cfg-system] no extra files installed'
+ set +x
ok 212 - [copy cfg-system] no extra files installed
PASS: t/add-missing.tap 212 - [copy cfg-system] no extra files installed
+ AUTOMAKE_run -d '[copy cfg-system] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy cfg-system] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1857: AC_CANONICAL_SYSTEM is expanded from...
configure.ac:5: the top level
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-system] automake run successfully'
+ command_ok_ '[copy cfg-system] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-system] automake run successfully'
+ set +x
ok 213 - [copy cfg-system] automake run successfully
PASS: t/add-missing.tap 213 - [copy cfg-system] automake run successfully
+ ls -l . build-aux
.:
total 88
-rw-r--r-- 1 root root     0 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 17011 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   126 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   383 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 104
-rwxr-xr-x 1 root root 44166 Nov 27 06:37 config.guess
-rwxr-xr-x 1 root root 36141 Nov 27 06:37 config.sub
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
+ for f in $files
+ command_ok_ '[copy cfg-system] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-system] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[copy cfg-system] file config.sub installed'
+ set +x
ok 214 - [copy cfg-system] file config.sub installed
PASS: t/add-missing.tap 214 - [copy cfg-system] file config.sub installed
+ for f in $files
+ command_ok_ '[copy cfg-system] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy cfg-system] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[copy cfg-system] file config.guess installed'
+ set +x
ok 215 - [copy cfg-system] file config.guess installed
PASS: t/add-missing.tap 215 - [copy cfg-system] file config.guess installed
+ for f in $files
+ command_ok_ '[copy cfg-system] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[copy cfg-system] report installation of config.sub'
+ set +x
ok 216 - [copy cfg-system] report installation of config.sub
PASS: t/add-missing.tap 216 - [copy cfg-system] report installation of config.sub
+ for f in $files
+ command_ok_ '[copy cfg-system] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[copy cfg-system] report installation of config.guess'
+ set +x
ok 217 - [copy cfg-system] report installation of config.guess
PASS: t/add-missing.tap 217 - [copy cfg-system] report installation of config.guess
+ all_files='install-sh missing  config.sub config.guess'
+ uniq
+ for f in $all_files
+ sort
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ cd build-aux
+ ls
+ sort
+ cat files.exp
config.guess
config.sub
install-sh
missing
+ cat files.got
config.guess
config.sub
install-sh
missing
+ command_ok_ '[copy cfg-system] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy cfg-system] all and only expected files installed'
+ set +x
ok 218 - [copy cfg-system] all and only expected files installed
PASS: t/add-missing.tap 218 - [copy cfg-system] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-system] config.sub has not been symlinked'
+ result_ ok '[copy cfg-system] config.sub has not been symlinked'
+ set +x
ok 219 - [copy cfg-system] config.sub has not been symlinked
PASS: t/add-missing.tap 219 - [copy cfg-system] config.sub has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy cfg-system] config.guess has not been symlinked'
+ result_ ok '[copy cfg-system] config.guess has not been symlinked'
+ set +x
ok 220 - [copy cfg-system] config.guess has not been symlinked
PASS: t/add-missing.tap 220 - [copy cfg-system] config.guess has not been symlinked
+ AUTOMAKE_run -d '[copy cfg-system] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy cfg-system] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
configure.ac:5: warning: AC_ARG_PROGRAM was called before AC_CANONICAL_TARGET
../../lib/autoconf/general.m4:1857: AC_CANONICAL_SYSTEM is expanded from...
configure.ac:5: the top level
+ cat stdout
+ test tap = none
+ test -z '[copy cfg-system] automake finds all added files'
+ command_ok_ '[copy cfg-system] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy cfg-system] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy cfg-system] automake finds all added files'
+ set +x
ok 221 - [copy cfg-system] automake finds all added files
PASS: t/add-missing.tap 221 - [copy cfg-system] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ check_
+ set +x
check count: 9
== Makefile.am ==
AUTOMAKE_OPTIONS = no-dependencies
bin_PROGRAMS = foo
foo_SOURCES = foo.l
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_PROG_CC
AC_PROG_LEX
Expected files: ylwrap compile
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-9
+ ls -l generic
total 64
-rw-r--r-- 1 root root    74 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   129 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link ylwrap/Lex]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link ylwrap/Lex] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link ylwrap/Lex] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link ylwrap/Lex] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/compile' not found
configure.ac:5:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
configure.ac: error: required file 'build-aux/ylwrap' not found
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[link ylwrap/Lex] missing files, automake fails'
+ command_ok_ '[link ylwrap/Lex] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] missing files, automake fails'
+ set +x
ok 222 - [link ylwrap/Lex] missing files, automake fails
PASS: t/add-missing.tap 222 - [link ylwrap/Lex] missing files, automake fails
+ for f in $files
+ command_ok_ '[link ylwrap/Lex] warn about missing file ylwrap' /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] warn about missing file ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
configure.ac: error: required file 'build-aux/ylwrap' not found
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] warn about missing file ylwrap'
+ set +x
ok 223 - [link ylwrap/Lex] warn about missing file ylwrap
PASS: t/add-missing.tap 223 - [link ylwrap/Lex] warn about missing file ylwrap
+ command_ok_ '[link ylwrap/Lex] suggest --add-missing for ylwrap' grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Lex] suggest --add-missing for ylwrap'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] suggest --add-missing for ylwrap'
+ set +x
ok 224 - [link ylwrap/Lex] suggest --add-missing for ylwrap
PASS: t/add-missing.tap 224 - [link ylwrap/Lex] suggest --add-missing for ylwrap
+ for f in $files
+ command_ok_ '[link ylwrap/Lex] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] warn about missing file compile'
+ set +x
ok 225 - [link ylwrap/Lex] warn about missing file compile
PASS: t/add-missing.tap 225 - [link ylwrap/Lex] warn about missing file compile
+ command_ok_ '[link ylwrap/Lex] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Lex] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] suggest --add-missing for compile'
+ set +x
ok 226 - [link ylwrap/Lex] suggest --add-missing for compile
PASS: t/add-missing.tap 226 - [link ylwrap/Lex] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link ylwrap/Lex] no extra files installed'
+ set +x
ok 227 - [link ylwrap/Lex] no extra files installed
PASS: t/add-missing.tap 227 - [link ylwrap/Lex] no extra files installed
+ AUTOMAKE_run -d '[link ylwrap/Lex] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link ylwrap/Lex] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
configure.ac: installing 'build-aux/ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[link ylwrap/Lex] automake run successfully'
+ command_ok_ '[link ylwrap/Lex] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] automake run successfully'
+ set +x
ok 228 - [link ylwrap/Lex] automake run successfully
PASS: t/add-missing.tap 228 - [link ylwrap/Lex] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    74 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 22668 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   129 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   188 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 36 Nov 27 06:37 compile -> /sources/automake-1.16.1/lib/compile
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
lrwxrwxrwx 1 root root 35 Nov 27 06:37 ylwrap -> /sources/automake-1.16.1/lib/ylwrap
+ for f in $files
+ command_ok_ '[link ylwrap/Lex] file ylwrap installed' test -f build-aux/ylwrap
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Lex] file ylwrap installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/ylwrap
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] file ylwrap installed'
+ set +x
ok 229 - [link ylwrap/Lex] file ylwrap installed
PASS: t/add-missing.tap 229 - [link ylwrap/Lex] file ylwrap installed
+ for f in $files
+ command_ok_ '[link ylwrap/Lex] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Lex] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] file compile installed'
+ set +x
ok 230 - [link ylwrap/Lex] file compile installed
PASS: t/add-missing.tap 230 - [link ylwrap/Lex] file compile installed
+ for f in $files
+ command_ok_ '[link ylwrap/Lex] report installation of ylwrap' /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] report installation of ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
configure.ac: installing 'build-aux/ylwrap'
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] report installation of ylwrap'
+ set +x
ok 231 - [link ylwrap/Lex] report installation of ylwrap
PASS: t/add-missing.tap 231 - [link ylwrap/Lex] report installation of ylwrap
+ for f in $files
+ command_ok_ '[link ylwrap/Lex] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:5: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] report installation of compile'
+ set +x
ok 232 - [link ylwrap/Lex] report installation of compile
PASS: t/add-missing.tap 232 - [link ylwrap/Lex] report installation of compile
+ all_files='install-sh missing  ylwrap compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo ylwrap
+ for f in $all_files
+ echo compile
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
compile
install-sh
missing
ylwrap
+ cat files.got
compile
install-sh
missing
ylwrap
+ command_ok_ '[link ylwrap/Lex] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] all and only expected files installed'
+ set +x
ok 233 - [link ylwrap/Lex] all and only expected files installed
PASS: t/add-missing.tap 233 - [link ylwrap/Lex] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/ylwrap
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link ylwrap/Lex] ylwrap has been symlinked'
+ result_ ok '[link ylwrap/Lex] ylwrap has been symlinked'
+ set +x
ok 234 - [link ylwrap/Lex] ylwrap has been symlinked
PASS: t/add-missing.tap 234 - [link ylwrap/Lex] ylwrap has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link ylwrap/Lex] compile has been symlinked'
+ result_ ok '[link ylwrap/Lex] compile has been symlinked'
+ set +x
ok 235 - [link ylwrap/Lex] compile has been symlinked
PASS: t/add-missing.tap 235 - [link ylwrap/Lex] compile has been symlinked
+ AUTOMAKE_run -d '[link ylwrap/Lex] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link ylwrap/Lex] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link ylwrap/Lex] automake finds all added files'
+ command_ok_ '[link ylwrap/Lex] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Lex] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link ylwrap/Lex] automake finds all added files'
+ set +x
ok 236 - [link ylwrap/Lex] automake finds all added files
PASS: t/add-missing.tap 236 - [link ylwrap/Lex] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy ylwrap/Lex]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy ylwrap/Lex] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy ylwrap/Lex] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy ylwrap/Lex] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/compile' not found
configure.ac:5:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
configure.ac: error: required file 'build-aux/ylwrap' not found
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[copy ylwrap/Lex] missing files, automake fails'
+ command_ok_ '[copy ylwrap/Lex] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] missing files, automake fails'
+ set +x
ok 237 - [copy ylwrap/Lex] missing files, automake fails
PASS: t/add-missing.tap 237 - [copy ylwrap/Lex] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy ylwrap/Lex] warn about missing file ylwrap' /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] warn about missing file ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
configure.ac: error: required file 'build-aux/ylwrap' not found
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] warn about missing file ylwrap'
+ set +x
ok 238 - [copy ylwrap/Lex] warn about missing file ylwrap
PASS: t/add-missing.tap 238 - [copy ylwrap/Lex] warn about missing file ylwrap
+ command_ok_ '[copy ylwrap/Lex] suggest --add-missing for ylwrap' grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Lex] suggest --add-missing for ylwrap'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] suggest --add-missing for ylwrap'
+ set +x
ok 239 - [copy ylwrap/Lex] suggest --add-missing for ylwrap
PASS: t/add-missing.tap 239 - [copy ylwrap/Lex] suggest --add-missing for ylwrap
+ for f in $files
+ command_ok_ '[copy ylwrap/Lex] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] warn about missing file compile'
+ set +x
ok 240 - [copy ylwrap/Lex] warn about missing file compile
PASS: t/add-missing.tap 240 - [copy ylwrap/Lex] warn about missing file compile
+ command_ok_ '[copy ylwrap/Lex] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Lex] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] suggest --add-missing for compile'
+ set +x
ok 241 - [copy ylwrap/Lex] suggest --add-missing for compile
PASS: t/add-missing.tap 241 - [copy ylwrap/Lex] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy ylwrap/Lex] no extra files installed'
+ set +x
ok 242 - [copy ylwrap/Lex] no extra files installed
PASS: t/add-missing.tap 242 - [copy ylwrap/Lex] no extra files installed
+ AUTOMAKE_run -d '[copy ylwrap/Lex] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy ylwrap/Lex] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
configure.ac: installing 'build-aux/ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[copy ylwrap/Lex] automake run successfully'
+ command_ok_ '[copy ylwrap/Lex] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] automake run successfully'
+ set +x
ok 243 - [copy ylwrap/Lex] automake run successfully
PASS: t/add-missing.tap 243 - [copy ylwrap/Lex] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    74 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 22668 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   129 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   188 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 40
-rwxr-xr-x 1 root root  7383 Nov 27 06:37 compile
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
-rwxr-xr-x 1 root root  6860 Nov 27 06:37 ylwrap
+ for f in $files
+ command_ok_ '[copy ylwrap/Lex] file ylwrap installed' test -f build-aux/ylwrap
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Lex] file ylwrap installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/ylwrap
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] file ylwrap installed'
+ set +x
ok 244 - [copy ylwrap/Lex] file ylwrap installed
PASS: t/add-missing.tap 244 - [copy ylwrap/Lex] file ylwrap installed
+ for f in $files
+ command_ok_ '[copy ylwrap/Lex] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Lex] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] file compile installed'
+ set +x
ok 245 - [copy ylwrap/Lex] file compile installed
PASS: t/add-missing.tap 245 - [copy ylwrap/Lex] file compile installed
+ for f in $files
+ command_ok_ '[copy ylwrap/Lex] report installation of ylwrap' /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] report installation of ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
configure.ac: installing 'build-aux/ylwrap'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] report installation of ylwrap'
+ set +x
ok 246 - [copy ylwrap/Lex] report installation of ylwrap
PASS: t/add-missing.tap 246 - [copy ylwrap/Lex] report installation of ylwrap
+ for f in $files
+ command_ok_ '[copy ylwrap/Lex] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:5: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] report installation of compile'
+ set +x
ok 247 - [copy ylwrap/Lex] report installation of compile
PASS: t/add-missing.tap 247 - [copy ylwrap/Lex] report installation of compile
+ all_files='install-sh missing  ylwrap compile'
+ for f in $all_files
+ sort
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo ylwrap
+ for f in $all_files
+ echo compile
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
compile
install-sh
missing
ylwrap
+ cat files.got
compile
install-sh
missing
ylwrap
+ command_ok_ '[copy ylwrap/Lex] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] all and only expected files installed'
+ set +x
ok 248 - [copy ylwrap/Lex] all and only expected files installed
PASS: t/add-missing.tap 248 - [copy ylwrap/Lex] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/ylwrap
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy ylwrap/Lex] ylwrap has not been symlinked'
+ result_ ok '[copy ylwrap/Lex] ylwrap has not been symlinked'
+ set +x
ok 249 - [copy ylwrap/Lex] ylwrap has not been symlinked
PASS: t/add-missing.tap 249 - [copy ylwrap/Lex] ylwrap has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy ylwrap/Lex] compile has not been symlinked'
+ result_ ok '[copy ylwrap/Lex] compile has not been symlinked'
+ set +x
ok 250 - [copy ylwrap/Lex] compile has not been symlinked
PASS: t/add-missing.tap 250 - [copy ylwrap/Lex] compile has not been symlinked
+ AUTOMAKE_run -d '[copy ylwrap/Lex] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy ylwrap/Lex] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy ylwrap/Lex] automake finds all added files'
+ command_ok_ '[copy ylwrap/Lex] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Lex] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy ylwrap/Lex] automake finds all added files'
+ set +x
ok 251 - [copy ylwrap/Lex] automake finds all added files
PASS: t/add-missing.tap 251 - [copy ylwrap/Lex] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ check_
+ set +x
check count: 10
== Makefile.am ==
AUTOMAKE_OPTIONS = no-dependencies
bin_PROGRAMS = foo
foo_SOURCES = foo.y
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_PROG_CC
AC_PROG_YACC
Expected files: ylwrap compile
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-10
+ ls -l generic
total 64
-rw-r--r-- 1 root root    74 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   130 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link ylwrap/Yacc]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link ylwrap/Yacc] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link ylwrap/Yacc] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link ylwrap/Yacc] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/compile' not found
configure.ac:5:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
configure.ac: error: required file 'build-aux/ylwrap' not found
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[link ylwrap/Yacc] missing files, automake fails'
+ command_ok_ '[link ylwrap/Yacc] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] missing files, automake fails'
+ set +x
ok 252 - [link ylwrap/Yacc] missing files, automake fails
PASS: t/add-missing.tap 252 - [link ylwrap/Yacc] missing files, automake fails
+ for f in $files
+ command_ok_ '[link ylwrap/Yacc] warn about missing file ylwrap' /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] warn about missing file ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
configure.ac: error: required file 'build-aux/ylwrap' not found
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] warn about missing file ylwrap'
+ set +x
ok 253 - [link ylwrap/Yacc] warn about missing file ylwrap
PASS: t/add-missing.tap 253 - [link ylwrap/Yacc] warn about missing file ylwrap
+ command_ok_ '[link ylwrap/Yacc] suggest --add-missing for ylwrap' grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Yacc] suggest --add-missing for ylwrap'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] suggest --add-missing for ylwrap'
+ set +x
ok 254 - [link ylwrap/Yacc] suggest --add-missing for ylwrap
PASS: t/add-missing.tap 254 - [link ylwrap/Yacc] suggest --add-missing for ylwrap
+ for f in $files
+ command_ok_ '[link ylwrap/Yacc] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] warn about missing file compile'
+ set +x
ok 255 - [link ylwrap/Yacc] warn about missing file compile
PASS: t/add-missing.tap 255 - [link ylwrap/Yacc] warn about missing file compile
+ command_ok_ '[link ylwrap/Yacc] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Yacc] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] suggest --add-missing for compile'
+ set +x
ok 256 - [link ylwrap/Yacc] suggest --add-missing for compile
PASS: t/add-missing.tap 256 - [link ylwrap/Yacc] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link ylwrap/Yacc] no extra files installed'
+ set +x
ok 257 - [link ylwrap/Yacc] no extra files installed
PASS: t/add-missing.tap 257 - [link ylwrap/Yacc] no extra files installed
+ AUTOMAKE_run -d '[link ylwrap/Yacc] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link ylwrap/Yacc] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
configure.ac: installing 'build-aux/ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[link ylwrap/Yacc] automake run successfully'
+ command_ok_ '[link ylwrap/Yacc] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] automake run successfully'
+ set +x
ok 258 - [link ylwrap/Yacc] automake run successfully
PASS: t/add-missing.tap 258 - [link ylwrap/Yacc] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    74 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 22787 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   130 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   188 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 36 Nov 27 06:37 compile -> /sources/automake-1.16.1/lib/compile
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
lrwxrwxrwx 1 root root 35 Nov 27 06:37 ylwrap -> /sources/automake-1.16.1/lib/ylwrap
+ for f in $files
+ command_ok_ '[link ylwrap/Yacc] file ylwrap installed' test -f build-aux/ylwrap
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Yacc] file ylwrap installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/ylwrap
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] file ylwrap installed'
+ set +x
ok 259 - [link ylwrap/Yacc] file ylwrap installed
PASS: t/add-missing.tap 259 - [link ylwrap/Yacc] file ylwrap installed
+ for f in $files
+ command_ok_ '[link ylwrap/Yacc] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link ylwrap/Yacc] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] file compile installed'
+ set +x
ok 260 - [link ylwrap/Yacc] file compile installed
PASS: t/add-missing.tap 260 - [link ylwrap/Yacc] file compile installed
+ for f in $files
+ command_ok_ '[link ylwrap/Yacc] report installation of ylwrap' /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] report installation of ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
configure.ac: installing 'build-aux/ylwrap'
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] report installation of ylwrap'
+ set +x
ok 261 - [link ylwrap/Yacc] report installation of ylwrap
PASS: t/add-missing.tap 261 - [link ylwrap/Yacc] report installation of ylwrap
+ for f in $files
+ command_ok_ '[link ylwrap/Yacc] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:5: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] report installation of compile'
+ set +x
ok 262 - [link ylwrap/Yacc] report installation of compile
PASS: t/add-missing.tap 262 - [link ylwrap/Yacc] report installation of compile
+ all_files='install-sh missing  ylwrap compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo ylwrap
+ for f in $all_files
+ echo compile
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
compile
install-sh
missing
ylwrap
+ cat files.got
compile
install-sh
missing
ylwrap
+ command_ok_ '[link ylwrap/Yacc] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] all and only expected files installed'
+ set +x
ok 263 - [link ylwrap/Yacc] all and only expected files installed
PASS: t/add-missing.tap 263 - [link ylwrap/Yacc] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/ylwrap
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link ylwrap/Yacc] ylwrap has been symlinked'
+ result_ ok '[link ylwrap/Yacc] ylwrap has been symlinked'
+ set +x
ok 264 - [link ylwrap/Yacc] ylwrap has been symlinked
PASS: t/add-missing.tap 264 - [link ylwrap/Yacc] ylwrap has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link ylwrap/Yacc] compile has been symlinked'
+ result_ ok '[link ylwrap/Yacc] compile has been symlinked'
+ set +x
ok 265 - [link ylwrap/Yacc] compile has been symlinked
PASS: t/add-missing.tap 265 - [link ylwrap/Yacc] compile has been symlinked
+ AUTOMAKE_run -d '[link ylwrap/Yacc] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link ylwrap/Yacc] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link ylwrap/Yacc] automake finds all added files'
+ command_ok_ '[link ylwrap/Yacc] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link ylwrap/Yacc] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link ylwrap/Yacc] automake finds all added files'
+ set +x
ok 266 - [link ylwrap/Yacc] automake finds all added files
PASS: t/add-missing.tap 266 - [link ylwrap/Yacc] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy ylwrap/Yacc]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy ylwrap/Yacc] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy ylwrap/Yacc] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy ylwrap/Yacc] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/compile' not found
configure.ac:5:   'automake --add-missing' can install 'compile'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
configure.ac: error: required file 'build-aux/ylwrap' not found
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[copy ylwrap/Yacc] missing files, automake fails'
+ command_ok_ '[copy ylwrap/Yacc] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] missing files, automake fails'
+ set +x
ok 267 - [copy ylwrap/Yacc] missing files, automake fails
PASS: t/add-missing.tap 267 - [copy ylwrap/Yacc] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy ylwrap/Yacc] warn about missing file ylwrap' /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] warn about missing file ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
configure.ac: error: required file 'build-aux/ylwrap' not found
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] warn about missing file ylwrap'
+ set +x
ok 268 - [copy ylwrap/Yacc] warn about missing file ylwrap
PASS: t/add-missing.tap 268 - [copy ylwrap/Yacc] warn about missing file ylwrap
+ command_ok_ '[copy ylwrap/Yacc] suggest --add-missing for ylwrap' grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Yacc] suggest --add-missing for ylwrap'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] suggest --add-missing for ylwrap'
+ set +x
ok 269 - [copy ylwrap/Yacc] suggest --add-missing for ylwrap
PASS: t/add-missing.tap 269 - [copy ylwrap/Yacc] suggest --add-missing for ylwrap
+ for f in $files
+ command_ok_ '[copy ylwrap/Yacc] warn about missing file compile' /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] warn about missing file compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/compile'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/compile' not found
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] warn about missing file compile'
+ set +x
ok 270 - [copy ylwrap/Yacc] warn about missing file compile
PASS: t/add-missing.tap 270 - [copy ylwrap/Yacc] warn about missing file compile
+ command_ok_ '[copy ylwrap/Yacc] suggest --add-missing for compile' grep '.*--add-missing.* install .*'\''compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Yacc] suggest --add-missing for compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''compile'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'compile'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] suggest --add-missing for compile'
+ set +x
ok 271 - [copy ylwrap/Yacc] suggest --add-missing for compile
PASS: t/add-missing.tap 271 - [copy ylwrap/Yacc] suggest --add-missing for compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy ylwrap/Yacc] no extra files installed'
+ set +x
ok 272 - [copy ylwrap/Yacc] no extra files installed
PASS: t/add-missing.tap 272 - [copy ylwrap/Yacc] no extra files installed
+ AUTOMAKE_run -d '[copy ylwrap/Yacc] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy ylwrap/Yacc] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: installing 'build-aux/compile'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
configure.ac: installing 'build-aux/ylwrap'
+ cat stdout
+ test tap = none
+ test -z '[copy ylwrap/Yacc] automake run successfully'
+ command_ok_ '[copy ylwrap/Yacc] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] automake run successfully'
+ set +x
ok 273 - [copy ylwrap/Yacc] automake run successfully
PASS: t/add-missing.tap 273 - [copy ylwrap/Yacc] automake run successfully
+ ls -l . build-aux
.:
total 96
-rw-r--r-- 1 root root    74 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 22787 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   130 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   188 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 40
-rwxr-xr-x 1 root root  7383 Nov 27 06:37 compile
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
-rwxr-xr-x 1 root root  6860 Nov 27 06:37 ylwrap
+ for f in $files
+ command_ok_ '[copy ylwrap/Yacc] file ylwrap installed' test -f build-aux/ylwrap
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Yacc] file ylwrap installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/ylwrap
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] file ylwrap installed'
+ set +x
ok 274 - [copy ylwrap/Yacc] file ylwrap installed
PASS: t/add-missing.tap 274 - [copy ylwrap/Yacc] file ylwrap installed
+ for f in $files
+ command_ok_ '[copy ylwrap/Yacc] file compile installed' test -f build-aux/compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy ylwrap/Yacc] file compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/compile
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] file compile installed'
+ set +x
ok 275 - [copy ylwrap/Yacc] file compile installed
PASS: t/add-missing.tap 275 - [copy ylwrap/Yacc] file compile installed
+ for f in $files
+ command_ok_ '[copy ylwrap/Yacc] report installation of ylwrap' /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] report installation of ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
configure.ac: installing 'build-aux/ylwrap'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] report installation of ylwrap'
+ set +x
ok 276 - [copy ylwrap/Yacc] report installation of ylwrap
PASS: t/add-missing.tap 276 - [copy ylwrap/Yacc] report installation of ylwrap
+ for f in $files
+ command_ok_ '[copy ylwrap/Yacc] report installation of compile' /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] report installation of compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/compile'\''' stderr
configure.ac:5: installing 'build-aux/compile'
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] report installation of compile'
+ set +x
ok 277 - [copy ylwrap/Yacc] report installation of compile
PASS: t/add-missing.tap 277 - [copy ylwrap/Yacc] report installation of compile
+ all_files='install-sh missing  ylwrap compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ sort
+ echo missing
+ for f in $all_files
+ echo ylwrap
+ for f in $all_files
+ echo compile
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
compile
install-sh
missing
ylwrap
+ cat files.got
compile
install-sh
missing
ylwrap
+ command_ok_ '[copy ylwrap/Yacc] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] all and only expected files installed'
+ set +x
ok 278 - [copy ylwrap/Yacc] all and only expected files installed
PASS: t/add-missing.tap 278 - [copy ylwrap/Yacc] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/ylwrap
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy ylwrap/Yacc] ylwrap has not been symlinked'
+ result_ ok '[copy ylwrap/Yacc] ylwrap has not been symlinked'
+ set +x
ok 279 - [copy ylwrap/Yacc] ylwrap has not been symlinked
PASS: t/add-missing.tap 279 - [copy ylwrap/Yacc] ylwrap has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/compile
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy ylwrap/Yacc] compile has not been symlinked'
+ result_ ok '[copy ylwrap/Yacc] compile has not been symlinked'
+ set +x
ok 280 - [copy ylwrap/Yacc] compile has not been symlinked
PASS: t/add-missing.tap 280 - [copy ylwrap/Yacc] compile has not been symlinked
+ AUTOMAKE_run -d '[copy ylwrap/Yacc] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy ylwrap/Yacc] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy ylwrap/Yacc] automake finds all added files'
+ command_ok_ '[copy ylwrap/Yacc] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy ylwrap/Yacc] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy ylwrap/Yacc] automake finds all added files'
+ set +x
ok 281 - [copy ylwrap/Yacc] automake finds all added files
PASS: t/add-missing.tap 281 - [copy ylwrap/Yacc] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ echo '@setfilename foo.info'
+ check_ --fetch-file foo.texi
+ set +x
check count: 11
== Makefile.am ==
info_TEXINFOS = foo.texi
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
Expected files: texinfo.tex
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-11
+ ls -l generic
total 68
-rw-r--r-- 1 root root    25 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    22 Nov 27 06:37 foo.texi
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link Texinfo]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link Texinfo] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link Texinfo] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link Texinfo] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[link Texinfo] missing files, automake fails'
+ command_ok_ '[link Texinfo] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link Texinfo] missing files, automake fails'
+ set +x
ok 282 - [link Texinfo] missing files, automake fails
PASS: t/add-missing.tap 282 - [link Texinfo] missing files, automake fails
+ for f in $files
+ command_ok_ '[link Texinfo] warn about missing file texinfo.tex' /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo] warn about missing file texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
+ result_ ok -D '' -r '' -- '[link Texinfo] warn about missing file texinfo.tex'
+ set +x
ok 283 - [link Texinfo] warn about missing file texinfo.tex
PASS: t/add-missing.tap 283 - [link Texinfo] warn about missing file texinfo.tex
+ command_ok_ '[link Texinfo] suggest --add-missing for texinfo.tex' grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link Texinfo] suggest --add-missing for texinfo.tex'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ result_ ok -D '' -r '' -- '[link Texinfo] suggest --add-missing for texinfo.tex'
+ set +x
ok 284 - [link Texinfo] suggest --add-missing for texinfo.tex
PASS: t/add-missing.tap 284 - [link Texinfo] suggest --add-missing for texinfo.tex
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link Texinfo] no extra files installed'
+ set +x
ok 285 - [link Texinfo] no extra files installed
PASS: t/add-missing.tap 285 - [link Texinfo] no extra files installed
+ AUTOMAKE_run -d '[link Texinfo] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link Texinfo] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[link Texinfo] automake run successfully'
+ command_ok_ '[link Texinfo] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link Texinfo] automake run successfully'
+ set +x
ok 286 - [link Texinfo] automake run successfully
PASS: t/add-missing.tap 286 - [link Texinfo] automake run successfully
+ ls -l . build-aux
.:
total 104
-rw-r--r-- 1 root root    25 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 28300 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    22 Nov 27 06:37 foo.texi
-rw-r--r-- 1 root root   147 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
lrwxrwxrwx 1 root root 40 Nov 27 06:37 texinfo.tex -> /sources/automake-1.16.1/lib/texinfo.tex
+ for f in $files
+ command_ok_ '[link Texinfo] file texinfo.tex installed' test -f build-aux/texinfo.tex
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link Texinfo] file texinfo.tex installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/texinfo.tex
+ result_ ok -D '' -r '' -- '[link Texinfo] file texinfo.tex installed'
+ set +x
ok 287 - [link Texinfo] file texinfo.tex installed
PASS: t/add-missing.tap 287 - [link Texinfo] file texinfo.tex installed
+ for f in $files
+ command_ok_ '[link Texinfo] report installation of texinfo.tex' /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo] report installation of texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ result_ ok -D '' -r '' -- '[link Texinfo] report installation of texinfo.tex'
+ set +x
ok 288 - [link Texinfo] report installation of texinfo.tex
PASS: t/add-missing.tap 288 - [link Texinfo] report installation of texinfo.tex
+ all_files='install-sh missing  texinfo.tex'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo texinfo.tex
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
missing
texinfo.tex
+ cat files.got
install-sh
missing
texinfo.tex
+ command_ok_ '[link Texinfo] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link Texinfo] all and only expected files installed'
+ set +x
ok 289 - [link Texinfo] all and only expected files installed
PASS: t/add-missing.tap 289 - [link Texinfo] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/texinfo.tex
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link Texinfo] texinfo.tex has been symlinked'
+ result_ ok '[link Texinfo] texinfo.tex has been symlinked'
+ set +x
ok 290 - [link Texinfo] texinfo.tex has been symlinked
PASS: t/add-missing.tap 290 - [link Texinfo] texinfo.tex has been symlinked
+ AUTOMAKE_run -d '[link Texinfo] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link Texinfo] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link Texinfo] automake finds all added files'
+ command_ok_ '[link Texinfo] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link Texinfo] automake finds all added files'
+ set +x
ok 291 - [link Texinfo] automake finds all added files
PASS: t/add-missing.tap 291 - [link Texinfo] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy Texinfo]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy Texinfo] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy Texinfo] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy Texinfo] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[copy Texinfo] missing files, automake fails'
+ command_ok_ '[copy Texinfo] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy Texinfo] missing files, automake fails'
+ set +x
ok 292 - [copy Texinfo] missing files, automake fails
PASS: t/add-missing.tap 292 - [copy Texinfo] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy Texinfo] warn about missing file texinfo.tex' /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo] warn about missing file texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
+ result_ ok -D '' -r '' -- '[copy Texinfo] warn about missing file texinfo.tex'
+ set +x
ok 293 - [copy Texinfo] warn about missing file texinfo.tex
PASS: t/add-missing.tap 293 - [copy Texinfo] warn about missing file texinfo.tex
+ command_ok_ '[copy Texinfo] suggest --add-missing for texinfo.tex' grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy Texinfo] suggest --add-missing for texinfo.tex'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ result_ ok -D '' -r '' -- '[copy Texinfo] suggest --add-missing for texinfo.tex'
+ set +x
ok 294 - [copy Texinfo] suggest --add-missing for texinfo.tex
PASS: t/add-missing.tap 294 - [copy Texinfo] suggest --add-missing for texinfo.tex
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy Texinfo] no extra files installed'
+ set +x
ok 295 - [copy Texinfo] no extra files installed
PASS: t/add-missing.tap 295 - [copy Texinfo] no extra files installed
+ AUTOMAKE_run -d '[copy Texinfo] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy Texinfo] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[copy Texinfo] automake run successfully'
+ command_ok_ '[copy Texinfo] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy Texinfo] automake run successfully'
+ set +x
ok 296 - [copy Texinfo] automake run successfully
PASS: t/add-missing.tap 296 - [copy Texinfo] automake run successfully
+ ls -l . build-aux
.:
total 104
-rw-r--r-- 1 root root    25 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 28300 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    22 Nov 27 06:37 foo.texi
-rw-r--r-- 1 root root   147 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 400
-rwxr-xr-x 1 root root  15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root   6878 Nov 27 06:37 missing
-rw-r--r-- 1 root root 382211 Nov 27 06:37 texinfo.tex
+ for f in $files
+ command_ok_ '[copy Texinfo] file texinfo.tex installed' test -f build-aux/texinfo.tex
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy Texinfo] file texinfo.tex installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/texinfo.tex
+ result_ ok -D '' -r '' -- '[copy Texinfo] file texinfo.tex installed'
+ set +x
ok 297 - [copy Texinfo] file texinfo.tex installed
PASS: t/add-missing.tap 297 - [copy Texinfo] file texinfo.tex installed
+ for f in $files
+ command_ok_ '[copy Texinfo] report installation of texinfo.tex' /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo] report installation of texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ result_ ok -D '' -r '' -- '[copy Texinfo] report installation of texinfo.tex'
+ set +x
ok 298 - [copy Texinfo] report installation of texinfo.tex
PASS: t/add-missing.tap 298 - [copy Texinfo] report installation of texinfo.tex
+ all_files='install-sh missing  texinfo.tex'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo texinfo.tex
+ sort
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
install-sh
missing
texinfo.tex
+ cat files.got
install-sh
missing
texinfo.tex
+ command_ok_ '[copy Texinfo] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy Texinfo] all and only expected files installed'
+ set +x
ok 299 - [copy Texinfo] all and only expected files installed
PASS: t/add-missing.tap 299 - [copy Texinfo] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/texinfo.tex
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy Texinfo] texinfo.tex has not been symlinked'
+ result_ ok '[copy Texinfo] texinfo.tex has not been symlinked'
+ set +x
ok 300 - [copy Texinfo] texinfo.tex has not been symlinked
PASS: t/add-missing.tap 300 - [copy Texinfo] texinfo.tex has not been symlinked
+ AUTOMAKE_run -d '[copy Texinfo] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy Texinfo] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy Texinfo] automake finds all added files'
+ command_ok_ '[copy Texinfo] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy Texinfo] automake finds all added files'
+ set +x
ok 301 - [copy Texinfo] automake finds all added files
PASS: t/add-missing.tap 301 - [copy Texinfo] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ echo '@include version.texi'
+ check_ --fetch-file foo.texi
+ set +x
check count: 12
== Makefile.am ==
info_TEXINFOS = foo.texi
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
Expected files: mdate-sh texinfo.tex
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-12
+ ls -l generic
total 68
-rw-r--r-- 1 root root    25 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    44 Nov 27 06:37 foo.texi
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link Texinfo/mdate-sh]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link Texinfo/mdate-sh] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link Texinfo/mdate-sh] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link Texinfo/mdate-sh] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am:1: error: required file 'build-aux/mdate-sh' not found
Makefile.am:1:   'automake --add-missing' can install 'mdate-sh'
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[link Texinfo/mdate-sh] missing files, automake fails'
+ command_ok_ '[link Texinfo/mdate-sh] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] missing files, automake fails'
+ set +x
ok 302 - [link Texinfo/mdate-sh] missing files, automake fails
PASS: t/add-missing.tap 302 - [link Texinfo/mdate-sh] missing files, automake fails
+ for f in $files
+ command_ok_ '[link Texinfo/mdate-sh] warn about missing file mdate-sh' /bin/grep -F 'required file '\''build-aux/mdate-sh'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] warn about missing file mdate-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/mdate-sh'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/mdate-sh' not found
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] warn about missing file mdate-sh'
+ set +x
ok 303 - [link Texinfo/mdate-sh] warn about missing file mdate-sh
PASS: t/add-missing.tap 303 - [link Texinfo/mdate-sh] warn about missing file mdate-sh
+ command_ok_ '[link Texinfo/mdate-sh] suggest --add-missing for mdate-sh' grep '.*--add-missing.* install .*'\''mdate-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] suggest --add-missing for mdate-sh'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''mdate-sh'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'mdate-sh'
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] suggest --add-missing for mdate-sh'
+ set +x
ok 304 - [link Texinfo/mdate-sh] suggest --add-missing for mdate-sh
PASS: t/add-missing.tap 304 - [link Texinfo/mdate-sh] suggest --add-missing for mdate-sh
+ for f in $files
+ command_ok_ '[link Texinfo/mdate-sh] warn about missing file texinfo.tex' /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] warn about missing file texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] warn about missing file texinfo.tex'
+ set +x
ok 305 - [link Texinfo/mdate-sh] warn about missing file texinfo.tex
PASS: t/add-missing.tap 305 - [link Texinfo/mdate-sh] warn about missing file texinfo.tex
+ command_ok_ '[link Texinfo/mdate-sh] suggest --add-missing for texinfo.tex' grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] suggest --add-missing for texinfo.tex'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] suggest --add-missing for texinfo.tex'
+ set +x
ok 306 - [link Texinfo/mdate-sh] suggest --add-missing for texinfo.tex
PASS: t/add-missing.tap 306 - [link Texinfo/mdate-sh] suggest --add-missing for texinfo.tex
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link Texinfo/mdate-sh] no extra files installed'
+ set +x
ok 307 - [link Texinfo/mdate-sh] no extra files installed
PASS: t/add-missing.tap 307 - [link Texinfo/mdate-sh] no extra files installed
+ AUTOMAKE_run -d '[link Texinfo/mdate-sh] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link Texinfo/mdate-sh] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am:1: installing 'build-aux/mdate-sh'
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[link Texinfo/mdate-sh] automake run successfully'
+ command_ok_ '[link Texinfo/mdate-sh] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] automake run successfully'
+ set +x
ok 308 - [link Texinfo/mdate-sh] automake run successfully
PASS: t/add-missing.tap 308 - [link Texinfo/mdate-sh] automake run successfully
+ ls -l . build-aux
.:
total 108
-rw-r--r-- 1 root root    25 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 29383 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    44 Nov 27 06:37 foo.texi
-rw-r--r-- 1 root root   194 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 37 Nov 27 06:37 mdate-sh -> /sources/automake-1.16.1/lib/mdate-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
lrwxrwxrwx 1 root root 40 Nov 27 06:37 texinfo.tex -> /sources/automake-1.16.1/lib/texinfo.tex
+ for f in $files
+ command_ok_ '[link Texinfo/mdate-sh] file mdate-sh installed' test -f build-aux/mdate-sh
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] file mdate-sh installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/mdate-sh
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] file mdate-sh installed'
+ set +x
ok 309 - [link Texinfo/mdate-sh] file mdate-sh installed
PASS: t/add-missing.tap 309 - [link Texinfo/mdate-sh] file mdate-sh installed
+ for f in $files
+ command_ok_ '[link Texinfo/mdate-sh] file texinfo.tex installed' test -f build-aux/texinfo.tex
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] file texinfo.tex installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/texinfo.tex
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] file texinfo.tex installed'
+ set +x
ok 310 - [link Texinfo/mdate-sh] file texinfo.tex installed
PASS: t/add-missing.tap 310 - [link Texinfo/mdate-sh] file texinfo.tex installed
+ for f in $files
+ command_ok_ '[link Texinfo/mdate-sh] report installation of mdate-sh' /bin/grep -F ': installing '\''build-aux/mdate-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] report installation of mdate-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/mdate-sh'\''' stderr
Makefile.am:1: installing 'build-aux/mdate-sh'
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] report installation of mdate-sh'
+ set +x
ok 311 - [link Texinfo/mdate-sh] report installation of mdate-sh
PASS: t/add-missing.tap 311 - [link Texinfo/mdate-sh] report installation of mdate-sh
+ for f in $files
+ command_ok_ '[link Texinfo/mdate-sh] report installation of texinfo.tex' /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] report installation of texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] report installation of texinfo.tex'
+ set +x
ok 312 - [link Texinfo/mdate-sh] report installation of texinfo.tex
PASS: t/add-missing.tap 312 - [link Texinfo/mdate-sh] report installation of texinfo.tex
+ all_files='install-sh missing  mdate-sh texinfo.tex'
+ uniq
+ for f in $all_files
+ sort
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo mdate-sh
+ for f in $all_files
+ echo texinfo.tex
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
mdate-sh
missing
texinfo.tex
+ cat files.got
install-sh
mdate-sh
missing
texinfo.tex
+ command_ok_ '[link Texinfo/mdate-sh] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] all and only expected files installed'
+ set +x
ok 313 - [link Texinfo/mdate-sh] all and only expected files installed
PASS: t/add-missing.tap 313 - [link Texinfo/mdate-sh] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/mdate-sh
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link Texinfo/mdate-sh] mdate-sh has been symlinked'
+ result_ ok '[link Texinfo/mdate-sh] mdate-sh has been symlinked'
+ set +x
ok 314 - [link Texinfo/mdate-sh] mdate-sh has been symlinked
PASS: t/add-missing.tap 314 - [link Texinfo/mdate-sh] mdate-sh has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/texinfo.tex
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link Texinfo/mdate-sh] texinfo.tex has been symlinked'
+ result_ ok '[link Texinfo/mdate-sh] texinfo.tex has been symlinked'
+ set +x
ok 315 - [link Texinfo/mdate-sh] texinfo.tex has been symlinked
PASS: t/add-missing.tap 315 - [link Texinfo/mdate-sh] texinfo.tex has been symlinked
+ AUTOMAKE_run -d '[link Texinfo/mdate-sh] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link Texinfo/mdate-sh] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link Texinfo/mdate-sh] automake finds all added files'
+ command_ok_ '[link Texinfo/mdate-sh] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link Texinfo/mdate-sh] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link Texinfo/mdate-sh] automake finds all added files'
+ set +x
ok 316 - [link Texinfo/mdate-sh] automake finds all added files
PASS: t/add-missing.tap 316 - [link Texinfo/mdate-sh] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy Texinfo/mdate-sh]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy Texinfo/mdate-sh] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy Texinfo/mdate-sh] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy Texinfo/mdate-sh] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am:1: error: required file 'build-aux/mdate-sh' not found
Makefile.am:1:   'automake --add-missing' can install 'mdate-sh'
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[copy Texinfo/mdate-sh] missing files, automake fails'
+ command_ok_ '[copy Texinfo/mdate-sh] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] missing files, automake fails'
+ set +x
ok 317 - [copy Texinfo/mdate-sh] missing files, automake fails
PASS: t/add-missing.tap 317 - [copy Texinfo/mdate-sh] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy Texinfo/mdate-sh] warn about missing file mdate-sh' /bin/grep -F 'required file '\''build-aux/mdate-sh'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] warn about missing file mdate-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/mdate-sh'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/mdate-sh' not found
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] warn about missing file mdate-sh'
+ set +x
ok 318 - [copy Texinfo/mdate-sh] warn about missing file mdate-sh
PASS: t/add-missing.tap 318 - [copy Texinfo/mdate-sh] warn about missing file mdate-sh
+ command_ok_ '[copy Texinfo/mdate-sh] suggest --add-missing for mdate-sh' grep '.*--add-missing.* install .*'\''mdate-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] suggest --add-missing for mdate-sh'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''mdate-sh'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'mdate-sh'
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] suggest --add-missing for mdate-sh'
+ set +x
ok 319 - [copy Texinfo/mdate-sh] suggest --add-missing for mdate-sh
PASS: t/add-missing.tap 319 - [copy Texinfo/mdate-sh] suggest --add-missing for mdate-sh
+ for f in $files
+ command_ok_ '[copy Texinfo/mdate-sh] warn about missing file texinfo.tex' /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] warn about missing file texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/texinfo.tex'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/texinfo.tex' not found
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] warn about missing file texinfo.tex'
+ set +x
ok 320 - [copy Texinfo/mdate-sh] warn about missing file texinfo.tex
PASS: t/add-missing.tap 320 - [copy Texinfo/mdate-sh] warn about missing file texinfo.tex
+ command_ok_ '[copy Texinfo/mdate-sh] suggest --add-missing for texinfo.tex' grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] suggest --add-missing for texinfo.tex'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''texinfo.tex'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'texinfo.tex'
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] suggest --add-missing for texinfo.tex'
+ set +x
ok 321 - [copy Texinfo/mdate-sh] suggest --add-missing for texinfo.tex
PASS: t/add-missing.tap 321 - [copy Texinfo/mdate-sh] suggest --add-missing for texinfo.tex
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy Texinfo/mdate-sh] no extra files installed'
+ set +x
ok 322 - [copy Texinfo/mdate-sh] no extra files installed
PASS: t/add-missing.tap 322 - [copy Texinfo/mdate-sh] no extra files installed
+ AUTOMAKE_run -d '[copy Texinfo/mdate-sh] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy Texinfo/mdate-sh] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am:1: installing 'build-aux/mdate-sh'
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ cat stdout
+ test tap = none
+ test -z '[copy Texinfo/mdate-sh] automake run successfully'
+ command_ok_ '[copy Texinfo/mdate-sh] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] automake run successfully'
+ set +x
ok 323 - [copy Texinfo/mdate-sh] automake run successfully
PASS: t/add-missing.tap 323 - [copy Texinfo/mdate-sh] automake run successfully
+ ls -l . build-aux
.:
total 108
-rw-r--r-- 1 root root    25 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 29383 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   106 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root    44 Nov 27 06:37 foo.texi
-rw-r--r-- 1 root root   194 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 408
-rwxr-xr-x 1 root root  15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root   6106 Nov 27 06:37 mdate-sh
-rwxr-xr-x 1 root root   6878 Nov 27 06:37 missing
-rw-r--r-- 1 root root 382211 Nov 27 06:37 texinfo.tex
+ for f in $files
+ command_ok_ '[copy Texinfo/mdate-sh] file mdate-sh installed' test -f build-aux/mdate-sh
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] file mdate-sh installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/mdate-sh
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] file mdate-sh installed'
+ set +x
ok 324 - [copy Texinfo/mdate-sh] file mdate-sh installed
PASS: t/add-missing.tap 324 - [copy Texinfo/mdate-sh] file mdate-sh installed
+ for f in $files
+ command_ok_ '[copy Texinfo/mdate-sh] file texinfo.tex installed' test -f build-aux/texinfo.tex
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] file texinfo.tex installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/texinfo.tex
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] file texinfo.tex installed'
+ set +x
ok 325 - [copy Texinfo/mdate-sh] file texinfo.tex installed
PASS: t/add-missing.tap 325 - [copy Texinfo/mdate-sh] file texinfo.tex installed
+ for f in $files
+ command_ok_ '[copy Texinfo/mdate-sh] report installation of mdate-sh' /bin/grep -F ': installing '\''build-aux/mdate-sh'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] report installation of mdate-sh'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/mdate-sh'\''' stderr
Makefile.am:1: installing 'build-aux/mdate-sh'
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] report installation of mdate-sh'
+ set +x
ok 326 - [copy Texinfo/mdate-sh] report installation of mdate-sh
PASS: t/add-missing.tap 326 - [copy Texinfo/mdate-sh] report installation of mdate-sh
+ for f in $files
+ command_ok_ '[copy Texinfo/mdate-sh] report installation of texinfo.tex' /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] report installation of texinfo.tex'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/texinfo.tex'\''' stderr
Makefile.am:1: installing 'build-aux/texinfo.tex'
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] report installation of texinfo.tex'
+ set +x
ok 327 - [copy Texinfo/mdate-sh] report installation of texinfo.tex
PASS: t/add-missing.tap 327 - [copy Texinfo/mdate-sh] report installation of texinfo.tex
+ all_files='install-sh missing  mdate-sh texinfo.tex'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo mdate-sh
+ for f in $all_files
+ echo texinfo.tex
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
mdate-sh
missing
texinfo.tex
+ cat files.got
install-sh
mdate-sh
missing
texinfo.tex
+ command_ok_ '[copy Texinfo/mdate-sh] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] all and only expected files installed'
+ set +x
ok 328 - [copy Texinfo/mdate-sh] all and only expected files installed
PASS: t/add-missing.tap 328 - [copy Texinfo/mdate-sh] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/mdate-sh
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy Texinfo/mdate-sh] mdate-sh has not been symlinked'
+ result_ ok '[copy Texinfo/mdate-sh] mdate-sh has not been symlinked'
+ set +x
ok 329 - [copy Texinfo/mdate-sh] mdate-sh has not been symlinked
PASS: t/add-missing.tap 329 - [copy Texinfo/mdate-sh] mdate-sh has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/texinfo.tex
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy Texinfo/mdate-sh] texinfo.tex has not been symlinked'
+ result_ ok '[copy Texinfo/mdate-sh] texinfo.tex has not been symlinked'
+ set +x
ok 330 - [copy Texinfo/mdate-sh] texinfo.tex has not been symlinked
PASS: t/add-missing.tap 330 - [copy Texinfo/mdate-sh] texinfo.tex has not been symlinked
+ AUTOMAKE_run -d '[copy Texinfo/mdate-sh] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy Texinfo/mdate-sh] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy Texinfo/mdate-sh] automake finds all added files'
+ command_ok_ '[copy Texinfo/mdate-sh] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy Texinfo/mdate-sh] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy Texinfo/mdate-sh] automake finds all added files'
+ set +x
ok 331 - [copy Texinfo/mdate-sh] automake finds all added files
PASS: t/add-missing.tap 331 - [copy Texinfo/mdate-sh] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ rm -f foo.texi
+ check_
+ set +x
check count: 13
== Makefile.am ==
python_PYTHON = foo.py
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AM_PATH_PYTHON
Expected files: py-compile
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-13
+ ls -l generic
total 64
-rw-r--r-- 1 root root    23 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   121 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link py-compile]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link py-compile] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link py-compile] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link py-compile] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am:1: error: required file 'build-aux/py-compile' not found
Makefile.am:1:   'automake --add-missing' can install 'py-compile'
+ cat stdout
+ test tap = none
+ test -z '[link py-compile] missing files, automake fails'
+ command_ok_ '[link py-compile] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link py-compile] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link py-compile] missing files, automake fails'
+ set +x
ok 332 - [link py-compile] missing files, automake fails
PASS: t/add-missing.tap 332 - [link py-compile] missing files, automake fails
+ for f in $files
+ command_ok_ '[link py-compile] warn about missing file py-compile' /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link py-compile] warn about missing file py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/py-compile' not found
+ result_ ok -D '' -r '' -- '[link py-compile] warn about missing file py-compile'
+ set +x
ok 333 - [link py-compile] warn about missing file py-compile
PASS: t/add-missing.tap 333 - [link py-compile] warn about missing file py-compile
+ command_ok_ '[link py-compile] suggest --add-missing for py-compile' grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link py-compile] suggest --add-missing for py-compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'py-compile'
+ result_ ok -D '' -r '' -- '[link py-compile] suggest --add-missing for py-compile'
+ set +x
ok 334 - [link py-compile] suggest --add-missing for py-compile
PASS: t/add-missing.tap 334 - [link py-compile] suggest --add-missing for py-compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link py-compile] no extra files installed'
+ set +x
ok 335 - [link py-compile] no extra files installed
PASS: t/add-missing.tap 335 - [link py-compile] no extra files installed
+ AUTOMAKE_run -d '[link py-compile] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link py-compile] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am:1: installing 'build-aux/py-compile'
+ cat stdout
+ test tap = none
+ test -z '[link py-compile] automake run successfully'
+ command_ok_ '[link py-compile] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link py-compile] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link py-compile] automake run successfully'
+ set +x
ok 336 - [link py-compile] automake run successfully
PASS: t/add-missing.tap 336 - [link py-compile] automake run successfully
+ ls -l . build-aux
.:
total 92
-rw-r--r-- 1 root root    23 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 20088 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   121 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   146 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
lrwxrwxrwx 1 root root 39 Nov 27 06:37 py-compile -> /sources/automake-1.16.1/lib/py-compile
+ for f in $files
+ command_ok_ '[link py-compile] file py-compile installed' test -f build-aux/py-compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link py-compile] file py-compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/py-compile
+ result_ ok -D '' -r '' -- '[link py-compile] file py-compile installed'
+ set +x
ok 337 - [link py-compile] file py-compile installed
PASS: t/add-missing.tap 337 - [link py-compile] file py-compile installed
+ for f in $files
+ command_ok_ '[link py-compile] report installation of py-compile' /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link py-compile] report installation of py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
Makefile.am:1: installing 'build-aux/py-compile'
+ result_ ok -D '' -r '' -- '[link py-compile] report installation of py-compile'
+ set +x
ok 338 - [link py-compile] report installation of py-compile
PASS: t/add-missing.tap 338 - [link py-compile] report installation of py-compile
+ all_files='install-sh missing  py-compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo py-compile
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
missing
py-compile
+ cat files.got
install-sh
missing
py-compile
+ command_ok_ '[link py-compile] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link py-compile] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link py-compile] all and only expected files installed'
+ set +x
ok 339 - [link py-compile] all and only expected files installed
PASS: t/add-missing.tap 339 - [link py-compile] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/py-compile
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link py-compile] py-compile has been symlinked'
+ result_ ok '[link py-compile] py-compile has been symlinked'
+ set +x
ok 340 - [link py-compile] py-compile has been symlinked
PASS: t/add-missing.tap 340 - [link py-compile] py-compile has been symlinked
+ AUTOMAKE_run -d '[link py-compile] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link py-compile] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link py-compile] automake finds all added files'
+ command_ok_ '[link py-compile] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link py-compile] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link py-compile] automake finds all added files'
+ set +x
ok 341 - [link py-compile] automake finds all added files
PASS: t/add-missing.tap 341 - [link py-compile] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy py-compile]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy py-compile] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy py-compile] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy py-compile] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am:1: error: required file 'build-aux/py-compile' not found
Makefile.am:1:   'automake --add-missing' can install 'py-compile'
+ cat stdout
+ test tap = none
+ test -z '[copy py-compile] missing files, automake fails'
+ command_ok_ '[copy py-compile] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy py-compile] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy py-compile] missing files, automake fails'
+ set +x
ok 342 - [copy py-compile] missing files, automake fails
PASS: t/add-missing.tap 342 - [copy py-compile] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy py-compile] warn about missing file py-compile' /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy py-compile] warn about missing file py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
Makefile.am:1: error: required file 'build-aux/py-compile' not found
+ result_ ok -D '' -r '' -- '[copy py-compile] warn about missing file py-compile'
+ set +x
ok 343 - [copy py-compile] warn about missing file py-compile
PASS: t/add-missing.tap 343 - [copy py-compile] warn about missing file py-compile
+ command_ok_ '[copy py-compile] suggest --add-missing for py-compile' grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy py-compile] suggest --add-missing for py-compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
Makefile.am:1:   'automake --add-missing' can install 'py-compile'
+ result_ ok -D '' -r '' -- '[copy py-compile] suggest --add-missing for py-compile'
+ set +x
ok 344 - [copy py-compile] suggest --add-missing for py-compile
PASS: t/add-missing.tap 344 - [copy py-compile] suggest --add-missing for py-compile
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy py-compile] no extra files installed'
+ set +x
ok 345 - [copy py-compile] no extra files installed
PASS: t/add-missing.tap 345 - [copy py-compile] no extra files installed
+ AUTOMAKE_run -d '[copy py-compile] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy py-compile] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am:1: installing 'build-aux/py-compile'
+ cat stdout
+ test tap = none
+ test -z '[copy py-compile] automake run successfully'
+ command_ok_ '[copy py-compile] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy py-compile] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy py-compile] automake run successfully'
+ set +x
ok 346 - [copy py-compile] automake run successfully
PASS: t/add-missing.tap 346 - [copy py-compile] automake run successfully
+ ls -l . build-aux
.:
total 92
-rw-r--r-- 1 root root    23 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 20088 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   121 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   146 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 32
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
-rwxr-xr-x 1 root root  4672 Nov 27 06:37 py-compile
+ for f in $files
+ command_ok_ '[copy py-compile] file py-compile installed' test -f build-aux/py-compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy py-compile] file py-compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/py-compile
+ result_ ok -D '' -r '' -- '[copy py-compile] file py-compile installed'
+ set +x
ok 347 - [copy py-compile] file py-compile installed
PASS: t/add-missing.tap 347 - [copy py-compile] file py-compile installed
+ for f in $files
+ command_ok_ '[copy py-compile] report installation of py-compile' /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy py-compile] report installation of py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
Makefile.am:1: installing 'build-aux/py-compile'
+ result_ ok -D '' -r '' -- '[copy py-compile] report installation of py-compile'
+ set +x
ok 348 - [copy py-compile] report installation of py-compile
PASS: t/add-missing.tap 348 - [copy py-compile] report installation of py-compile
+ all_files='install-sh missing  py-compile'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo py-compile
+ sort
+ uniq
+ cd build-aux
+ ls
+ sort
+ cat files.exp
install-sh
missing
py-compile
+ cat files.got
install-sh
missing
py-compile
+ command_ok_ '[copy py-compile] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy py-compile] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy py-compile] all and only expected files installed'
+ set +x
ok 349 - [copy py-compile] all and only expected files installed
PASS: t/add-missing.tap 349 - [copy py-compile] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/py-compile
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy py-compile] py-compile has not been symlinked'
+ result_ ok '[copy py-compile] py-compile has not been symlinked'
+ set +x
ok 350 - [copy py-compile] py-compile has not been symlinked
PASS: t/add-missing.tap 350 - [copy py-compile] py-compile has not been symlinked
+ AUTOMAKE_run -d '[copy py-compile] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy py-compile] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy py-compile] automake finds all added files'
+ command_ok_ '[copy py-compile] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy py-compile] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy py-compile] automake finds all added files'
+ set +x
ok 351 - [copy py-compile] automake finds all added files
PASS: t/add-missing.tap 351 - [copy py-compile] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ check_
+ set +x
check count: 14
== Makefile.am ==
PYTHON = python
pythondir = $(prefix)/py
YACC = bison -y
bin_PROGRAMS = foo
foo_SOURCES = bar.yxx baz.c++
python_PYTHON = zardoz.py
== configure.ac ==
AC_INIT([add-missing], [1.0])
AC_CONFIG_AUX_DIR([build-aux])
AM_INIT_AUTOMAKE
AC_CONFIG_FILES([Makefile])
AC_CANONICAL_BUILD
AC_CANONICAL_HOST
AC_PROG_CXX
Expected files: py-compile depcomp ylwrap config.sub config.guess
+ pwd
/sources/automake-1.16.1/t/add-missing.dir/testdir-14
+ ls -l generic
total 64
-rw-r--r-- 1 root root   132 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   155 Nov 27 06:37 configure.ac
+ for action in link copy
+ case $action in
+ opts=--add-missing
+ pfx='[link misc]'
+ cp -R generic link
+ cd link
+ AUTOMAKE_fails -d '[link misc] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[link misc] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link misc] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am: error: required file 'build-aux/depcomp' not found
Makefile.am:   'automake --add-missing' can install 'depcomp'
configure.ac: error: required file 'build-aux/ylwrap' not found
configure.ac:   'automake --add-missing' can install 'ylwrap'
Makefile.am:6: error: required file 'build-aux/py-compile' not found
Makefile.am:6:   'automake --add-missing' can install 'py-compile'
+ cat stdout
+ test tap = none
+ test -z '[link misc] missing files, automake fails'
+ command_ok_ '[link misc] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[link misc] missing files, automake fails'
+ set +x
ok 352 - [link misc] missing files, automake fails
PASS: t/add-missing.tap 352 - [link misc] missing files, automake fails
+ for f in $files
+ command_ok_ '[link misc] warn about missing file py-compile' /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] warn about missing file py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
Makefile.am:6: error: required file 'build-aux/py-compile' not found
+ result_ ok -D '' -r '' -- '[link misc] warn about missing file py-compile'
+ set +x
ok 353 - [link misc] warn about missing file py-compile
PASS: t/add-missing.tap 353 - [link misc] warn about missing file py-compile
+ command_ok_ '[link misc] suggest --add-missing for py-compile' grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] suggest --add-missing for py-compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
Makefile.am:6:   'automake --add-missing' can install 'py-compile'
+ result_ ok -D '' -r '' -- '[link misc] suggest --add-missing for py-compile'
+ set +x
ok 354 - [link misc] suggest --add-missing for py-compile
PASS: t/add-missing.tap 354 - [link misc] suggest --add-missing for py-compile
+ for f in $files
+ command_ok_ '[link misc] warn about missing file depcomp' /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] warn about missing file depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
Makefile.am: error: required file 'build-aux/depcomp' not found
+ result_ ok -D '' -r '' -- '[link misc] warn about missing file depcomp'
+ set +x
ok 355 - [link misc] warn about missing file depcomp
PASS: t/add-missing.tap 355 - [link misc] warn about missing file depcomp
+ command_ok_ '[link misc] suggest --add-missing for depcomp' grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] suggest --add-missing for depcomp'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ result_ ok -D '' -r '' -- '[link misc] suggest --add-missing for depcomp'
+ set +x
ok 356 - [link misc] suggest --add-missing for depcomp
PASS: t/add-missing.tap 356 - [link misc] suggest --add-missing for depcomp
+ for f in $files
+ command_ok_ '[link misc] warn about missing file ylwrap' /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] warn about missing file ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
configure.ac: error: required file 'build-aux/ylwrap' not found
+ result_ ok -D '' -r '' -- '[link misc] warn about missing file ylwrap'
+ set +x
ok 357 - [link misc] warn about missing file ylwrap
PASS: t/add-missing.tap 357 - [link misc] warn about missing file ylwrap
+ command_ok_ '[link misc] suggest --add-missing for ylwrap' grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] suggest --add-missing for ylwrap'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ result_ ok -D '' -r '' -- '[link misc] suggest --add-missing for ylwrap'
+ set +x
ok 358 - [link misc] suggest --add-missing for ylwrap
PASS: t/add-missing.tap 358 - [link misc] suggest --add-missing for ylwrap
+ for f in $files
+ command_ok_ '[link misc] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[link misc] warn about missing file config.sub'
+ set +x
ok 359 - [link misc] warn about missing file config.sub
PASS: t/add-missing.tap 359 - [link misc] warn about missing file config.sub
+ command_ok_ '[link misc] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[link misc] suggest --add-missing for config.sub'
+ set +x
ok 360 - [link misc] suggest --add-missing for config.sub
PASS: t/add-missing.tap 360 - [link misc] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[link misc] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[link misc] warn about missing file config.guess'
+ set +x
ok 361 - [link misc] warn about missing file config.guess
PASS: t/add-missing.tap 361 - [link misc] warn about missing file config.guess
+ command_ok_ '[link misc] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[link misc] suggest --add-missing for config.guess'
+ set +x
ok 362 - [link misc] suggest --add-missing for config.guess
PASS: t/add-missing.tap 362 - [link misc] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[link misc] no extra files installed'
+ set +x
ok 363 - [link misc] no extra files installed
PASS: t/add-missing.tap 363 - [link misc] no extra files installed
+ AUTOMAKE_run -d '[link misc] automake run successfully' -- --add-missing
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__desc='[link misc] automake run successfully'
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
configure.ac: installing 'build-aux/ylwrap'
Makefile.am:6: installing 'build-aux/py-compile'
+ cat stdout
+ test tap = none
+ test -z '[link misc] automake run successfully'
+ command_ok_ '[link misc] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link misc] automake run successfully'
+ set +x
ok 364 - [link misc] automake run successfully
PASS: t/add-missing.tap 364 - [link misc] automake run successfully
+ ls -l . build-aux
.:
total 104
-rw-r--r-- 1 root root   132 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 29135 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   155 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   336 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 0
lrwxrwxrwx 1 root root 41 Nov 27 06:37 config.guess -> /sources/automake-1.16.1/lib/config.guess
lrwxrwxrwx 1 root root 39 Nov 27 06:37 config.sub -> /sources/automake-1.16.1/lib/config.sub
lrwxrwxrwx 1 root root 36 Nov 27 06:37 depcomp -> /sources/automake-1.16.1/lib/depcomp
lrwxrwxrwx 1 root root 39 Nov 27 06:37 install-sh -> /sources/automake-1.16.1/lib/install-sh
lrwxrwxrwx 1 root root 36 Nov 27 06:37 missing -> /sources/automake-1.16.1/lib/missing
lrwxrwxrwx 1 root root 39 Nov 27 06:37 py-compile -> /sources/automake-1.16.1/lib/py-compile
lrwxrwxrwx 1 root root 35 Nov 27 06:37 ylwrap -> /sources/automake-1.16.1/lib/ylwrap
+ for f in $files
+ command_ok_ '[link misc] file py-compile installed' test -f build-aux/py-compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] file py-compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/py-compile
+ result_ ok -D '' -r '' -- '[link misc] file py-compile installed'
+ set +x
ok 365 - [link misc] file py-compile installed
PASS: t/add-missing.tap 365 - [link misc] file py-compile installed
+ for f in $files
+ command_ok_ '[link misc] file depcomp installed' test -f build-aux/depcomp
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] file depcomp installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/depcomp
+ result_ ok -D '' -r '' -- '[link misc] file depcomp installed'
+ set +x
ok 366 - [link misc] file depcomp installed
PASS: t/add-missing.tap 366 - [link misc] file depcomp installed
+ for f in $files
+ command_ok_ '[link misc] file ylwrap installed' test -f build-aux/ylwrap
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] file ylwrap installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/ylwrap
+ result_ ok -D '' -r '' -- '[link misc] file ylwrap installed'
+ set +x
ok 367 - [link misc] file ylwrap installed
PASS: t/add-missing.tap 367 - [link misc] file ylwrap installed
+ for f in $files
+ command_ok_ '[link misc] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[link misc] file config.sub installed'
+ set +x
ok 368 - [link misc] file config.sub installed
PASS: t/add-missing.tap 368 - [link misc] file config.sub installed
+ for f in $files
+ command_ok_ '[link misc] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[link misc] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[link misc] file config.guess installed'
+ set +x
ok 369 - [link misc] file config.guess installed
PASS: t/add-missing.tap 369 - [link misc] file config.guess installed
+ for f in $files
+ command_ok_ '[link misc] report installation of py-compile' /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] report installation of py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
Makefile.am:6: installing 'build-aux/py-compile'
+ result_ ok -D '' -r '' -- '[link misc] report installation of py-compile'
+ set +x
ok 370 - [link misc] report installation of py-compile
PASS: t/add-missing.tap 370 - [link misc] report installation of py-compile
+ for f in $files
+ command_ok_ '[link misc] report installation of depcomp' /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] report installation of depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
Makefile.am: installing 'build-aux/depcomp'
+ result_ ok -D '' -r '' -- '[link misc] report installation of depcomp'
+ set +x
ok 371 - [link misc] report installation of depcomp
PASS: t/add-missing.tap 371 - [link misc] report installation of depcomp
+ for f in $files
+ command_ok_ '[link misc] report installation of ylwrap' /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] report installation of ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
configure.ac: installing 'build-aux/ylwrap'
+ result_ ok -D '' -r '' -- '[link misc] report installation of ylwrap'
+ set +x
ok 372 - [link misc] report installation of ylwrap
PASS: t/add-missing.tap 372 - [link misc] report installation of ylwrap
+ for f in $files
+ command_ok_ '[link misc] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[link misc] report installation of config.sub'
+ set +x
ok 373 - [link misc] report installation of config.sub
PASS: t/add-missing.tap 373 - [link misc] report installation of config.sub
+ for f in $files
+ command_ok_ '[link misc] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[link misc] report installation of config.guess'
+ set +x
ok 374 - [link misc] report installation of config.guess
PASS: t/add-missing.tap 374 - [link misc] report installation of config.guess
+ all_files='install-sh missing  py-compile depcomp ylwrap config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo py-compile
+ for f in $all_files
+ echo depcomp
+ sort
+ for f in $all_files
+ echo ylwrap
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
config.guess
config.sub
depcomp
install-sh
missing
py-compile
ylwrap
+ cat files.got
config.guess
config.sub
depcomp
install-sh
missing
py-compile
ylwrap
+ command_ok_ '[link misc] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[link misc] all and only expected files installed'
+ set +x
ok 375 - [link misc] all and only expected files installed
PASS: t/add-missing.tap 375 - [link misc] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/py-compile
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link misc] py-compile has been symlinked'
+ result_ ok '[link misc] py-compile has been symlinked'
+ set +x
ok 376 - [link misc] py-compile has been symlinked
PASS: t/add-missing.tap 376 - [link misc] py-compile has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/depcomp
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link misc] depcomp has been symlinked'
+ result_ ok '[link misc] depcomp has been symlinked'
+ set +x
ok 377 - [link misc] depcomp has been symlinked
PASS: t/add-missing.tap 377 - [link misc] depcomp has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/ylwrap
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link misc] ylwrap has been symlinked'
+ result_ ok '[link misc] ylwrap has been symlinked'
+ set +x
ok 378 - [link misc] ylwrap has been symlinked
PASS: t/add-missing.tap 378 - [link misc] ylwrap has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link misc] config.sub has been symlinked'
+ result_ ok '[link misc] config.sub has been symlinked'
+ set +x
ok 379 - [link misc] config.sub has been symlinked
PASS: t/add-missing.tap 379 - [link misc] config.sub has been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=yes
+ case $action,$is_symlink in
+ ok_ '[link misc] config.guess has been symlinked'
+ result_ ok '[link misc] config.guess has been symlinked'
+ set +x
ok 380 - [link misc] config.guess has been symlinked
PASS: t/add-missing.tap 380 - [link misc] config.guess has been symlinked
+ AUTOMAKE_run -d '[link misc] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[link misc] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[link misc] automake finds all added files'
+ command_ok_ '[link misc] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[link misc] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[link misc] automake finds all added files'
+ set +x
ok 381 - [link misc] automake finds all added files
PASS: t/add-missing.tap 381 - [link misc] automake finds all added files
+ cd ..
+ for action in link copy
+ case $action in
+ opts='-a --copy'
+ pfx='[copy misc]'
+ cp -R generic copy
+ cd copy
+ AUTOMAKE_fails -d '[copy misc] missing files, automake fails'
+ AUTOMAKE_run -e 1 -d '[copy misc] missing files, automake fails'
+ am__desc=
+ am__exp_rc=0
+ test 4 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy misc] missing files, automake fails'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
configure.ac:5:   'automake --add-missing' can install 'config.guess'
configure.ac:5: error: required file 'build-aux/config.sub' not found
configure.ac:5:   'automake --add-missing' can install 'config.sub'
configure.ac:3: error: required file 'build-aux/install-sh' not found
configure.ac:3:   'automake --add-missing' can install 'install-sh'
configure.ac:3: error: required file 'build-aux/missing' not found
configure.ac:3:   'automake --add-missing' can install 'missing'
Makefile.am: error: required file 'build-aux/depcomp' not found
Makefile.am:   'automake --add-missing' can install 'depcomp'
configure.ac: error: required file 'build-aux/ylwrap' not found
configure.ac:   'automake --add-missing' can install 'ylwrap'
Makefile.am:6: error: required file 'build-aux/py-compile' not found
Makefile.am:6:   'automake --add-missing' can install 'py-compile'
+ cat stdout
+ test tap = none
+ test -z '[copy misc] missing files, automake fails'
+ command_ok_ '[copy misc] missing files, automake fails' test 1 -eq 1
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] missing files, automake fails'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 1 -eq 1
+ result_ ok -D '' -r '' -- '[copy misc] missing files, automake fails'
+ set +x
ok 382 - [copy misc] missing files, automake fails
PASS: t/add-missing.tap 382 - [copy misc] missing files, automake fails
+ for f in $files
+ command_ok_ '[copy misc] warn about missing file py-compile' /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] warn about missing file py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/py-compile'\'' not found' stderr
Makefile.am:6: error: required file 'build-aux/py-compile' not found
+ result_ ok -D '' -r '' -- '[copy misc] warn about missing file py-compile'
+ set +x
ok 383 - [copy misc] warn about missing file py-compile
PASS: t/add-missing.tap 383 - [copy misc] warn about missing file py-compile
+ command_ok_ '[copy misc] suggest --add-missing for py-compile' grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] suggest --add-missing for py-compile'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''py-compile'\''' stderr
Makefile.am:6:   'automake --add-missing' can install 'py-compile'
+ result_ ok -D '' -r '' -- '[copy misc] suggest --add-missing for py-compile'
+ set +x
ok 384 - [copy misc] suggest --add-missing for py-compile
PASS: t/add-missing.tap 384 - [copy misc] suggest --add-missing for py-compile
+ for f in $files
+ command_ok_ '[copy misc] warn about missing file depcomp' /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] warn about missing file depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/depcomp'\'' not found' stderr
Makefile.am: error: required file 'build-aux/depcomp' not found
+ result_ ok -D '' -r '' -- '[copy misc] warn about missing file depcomp'
+ set +x
ok 385 - [copy misc] warn about missing file depcomp
PASS: t/add-missing.tap 385 - [copy misc] warn about missing file depcomp
+ command_ok_ '[copy misc] suggest --add-missing for depcomp' grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] suggest --add-missing for depcomp'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''depcomp'\''' stderr
Makefile.am:   'automake --add-missing' can install 'depcomp'
+ result_ ok -D '' -r '' -- '[copy misc] suggest --add-missing for depcomp'
+ set +x
ok 386 - [copy misc] suggest --add-missing for depcomp
PASS: t/add-missing.tap 386 - [copy misc] suggest --add-missing for depcomp
+ for f in $files
+ command_ok_ '[copy misc] warn about missing file ylwrap' /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] warn about missing file ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/ylwrap'\'' not found' stderr
configure.ac: error: required file 'build-aux/ylwrap' not found
+ result_ ok -D '' -r '' -- '[copy misc] warn about missing file ylwrap'
+ set +x
ok 387 - [copy misc] warn about missing file ylwrap
PASS: t/add-missing.tap 387 - [copy misc] warn about missing file ylwrap
+ command_ok_ '[copy misc] suggest --add-missing for ylwrap' grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] suggest --add-missing for ylwrap'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''ylwrap'\''' stderr
configure.ac:   'automake --add-missing' can install 'ylwrap'
+ result_ ok -D '' -r '' -- '[copy misc] suggest --add-missing for ylwrap'
+ set +x
ok 388 - [copy misc] suggest --add-missing for ylwrap
PASS: t/add-missing.tap 388 - [copy misc] suggest --add-missing for ylwrap
+ for f in $files
+ command_ok_ '[copy misc] warn about missing file config.sub' /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] warn about missing file config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.sub'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.sub' not found
+ result_ ok -D '' -r '' -- '[copy misc] warn about missing file config.sub'
+ set +x
ok 389 - [copy misc] warn about missing file config.sub
PASS: t/add-missing.tap 389 - [copy misc] warn about missing file config.sub
+ command_ok_ '[copy misc] suggest --add-missing for config.sub' grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] suggest --add-missing for config.sub'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.sub'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.sub'
+ result_ ok -D '' -r '' -- '[copy misc] suggest --add-missing for config.sub'
+ set +x
ok 390 - [copy misc] suggest --add-missing for config.sub
PASS: t/add-missing.tap 390 - [copy misc] suggest --add-missing for config.sub
+ for f in $files
+ command_ok_ '[copy misc] warn about missing file config.guess' /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] warn about missing file config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F 'required file '\''build-aux/config.guess'\'' not found' stderr
configure.ac:5: error: required file 'build-aux/config.guess' not found
+ result_ ok -D '' -r '' -- '[copy misc] warn about missing file config.guess'
+ set +x
ok 391 - [copy misc] warn about missing file config.guess
PASS: t/add-missing.tap 391 - [copy misc] warn about missing file config.guess
+ command_ok_ '[copy misc] suggest --add-missing for config.guess' grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] suggest --add-missing for config.guess'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ grep '.*--add-missing.* install .*'\''config.guess'\''' stderr
configure.ac:5:   'automake --add-missing' can install 'config.guess'
+ result_ ok -D '' -r '' -- '[copy misc] suggest --add-missing for config.guess'
+ set +x
ok 392 - [copy misc] suggest --add-missing for config.guess
PASS: t/add-missing.tap 392 - [copy misc] suggest --add-missing for config.guess
+ ls build-aux
+ grep .
+ r=ok
+ result_ ok '[copy misc] no extra files installed'
+ set +x
ok 393 - [copy misc] no extra files installed
PASS: t/add-missing.tap 393 - [copy misc] no extra files installed
+ AUTOMAKE_run -d '[copy misc] automake run successfully' -- -a --copy
+ am__desc=
+ am__exp_rc=0
+ test 5 -gt 0
+ case $1 in
+ am__desc='[copy misc] automake run successfully'
+ shift
+ shift
+ test 3 -gt 0
+ case $1 in
+ shift
+ break
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall -a --copy
+ cat stderr
configure.ac:5: installing 'build-aux/config.guess'
configure.ac:5: installing 'build-aux/config.sub'
configure.ac:3: installing 'build-aux/install-sh'
configure.ac:3: installing 'build-aux/missing'
Makefile.am: installing 'build-aux/depcomp'
configure.ac: installing 'build-aux/ylwrap'
Makefile.am:6: installing 'build-aux/py-compile'
+ cat stdout
+ test tap = none
+ test -z '[copy misc] automake run successfully'
+ command_ok_ '[copy misc] automake run successfully' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] automake run successfully'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy misc] automake run successfully'
+ set +x
ok 394 - [copy misc] automake run successfully
PASS: t/add-missing.tap 394 - [copy misc] automake run successfully
+ ls -l . build-aux
.:
total 104
-rw-r--r-- 1 root root   132 Nov 27 06:37 Makefile.am
-rw-r--r-- 1 root root 29135 Nov 27 06:37 Makefile.in
-rw-r--r-- 1 root root 52814 Nov 27 06:37 aclocal.m4
drwxr-xr-x 2 root root  4096 Nov 27 06:37 autom4te.cache
drwxr-xr-x 2 root root  4096 Nov 27 06:37 build-aux
-rw-r--r-- 1 root root   155 Nov 27 06:37 configure.ac
-rw-r--r-- 1 root root   336 Nov 27 06:37 stderr
-rw-r--r-- 1 root root     0 Nov 27 06:37 stdout

build-aux:
total 144
-rwxr-xr-x 1 root root 44166 Nov 27 06:37 config.guess
-rwxr-xr-x 1 root root 36141 Nov 27 06:37 config.sub
-rwxr-xr-x 1 root root 23568 Nov 27 06:37 depcomp
-rwxr-xr-x 1 root root 15368 Nov 27 06:37 install-sh
-rwxr-xr-x 1 root root  6878 Nov 27 06:37 missing
-rwxr-xr-x 1 root root  4672 Nov 27 06:37 py-compile
-rwxr-xr-x 1 root root  6860 Nov 27 06:37 ylwrap
+ for f in $files
+ command_ok_ '[copy misc] file py-compile installed' test -f build-aux/py-compile
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] file py-compile installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/py-compile
+ result_ ok -D '' -r '' -- '[copy misc] file py-compile installed'
+ set +x
ok 395 - [copy misc] file py-compile installed
PASS: t/add-missing.tap 395 - [copy misc] file py-compile installed
+ for f in $files
+ command_ok_ '[copy misc] file depcomp installed' test -f build-aux/depcomp
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] file depcomp installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/depcomp
+ result_ ok -D '' -r '' -- '[copy misc] file depcomp installed'
+ set +x
ok 396 - [copy misc] file depcomp installed
PASS: t/add-missing.tap 396 - [copy misc] file depcomp installed
+ for f in $files
+ command_ok_ '[copy misc] file ylwrap installed' test -f build-aux/ylwrap
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] file ylwrap installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/ylwrap
+ result_ ok -D '' -r '' -- '[copy misc] file ylwrap installed'
+ set +x
ok 397 - [copy misc] file ylwrap installed
PASS: t/add-missing.tap 397 - [copy misc] file ylwrap installed
+ for f in $files
+ command_ok_ '[copy misc] file config.sub installed' test -f build-aux/config.sub
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] file config.sub installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.sub
+ result_ ok -D '' -r '' -- '[copy misc] file config.sub installed'
+ set +x
ok 398 - [copy misc] file config.sub installed
PASS: t/add-missing.tap 398 - [copy misc] file config.sub installed
+ for f in $files
+ command_ok_ '[copy misc] file config.guess installed' test -f build-aux/config.guess
+ tap_directive_=
+ tap_reason_=
+ test 4 -gt 0
+ tap_description_='[copy misc] file config.guess installed'
+ shift
+ test 3 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test -f build-aux/config.guess
+ result_ ok -D '' -r '' -- '[copy misc] file config.guess installed'
+ set +x
ok 399 - [copy misc] file config.guess installed
PASS: t/add-missing.tap 399 - [copy misc] file config.guess installed
+ for f in $files
+ command_ok_ '[copy misc] report installation of py-compile' /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] report installation of py-compile'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/py-compile'\''' stderr
Makefile.am:6: installing 'build-aux/py-compile'
+ result_ ok -D '' -r '' -- '[copy misc] report installation of py-compile'
+ set +x
ok 400 - [copy misc] report installation of py-compile
PASS: t/add-missing.tap 400 - [copy misc] report installation of py-compile
+ for f in $files
+ command_ok_ '[copy misc] report installation of depcomp' /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] report installation of depcomp'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/depcomp'\''' stderr
Makefile.am: installing 'build-aux/depcomp'
+ result_ ok -D '' -r '' -- '[copy misc] report installation of depcomp'
+ set +x
ok 401 - [copy misc] report installation of depcomp
PASS: t/add-missing.tap 401 - [copy misc] report installation of depcomp
+ for f in $files
+ command_ok_ '[copy misc] report installation of ylwrap' /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] report installation of ylwrap'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/ylwrap'\''' stderr
configure.ac: installing 'build-aux/ylwrap'
+ result_ ok -D '' -r '' -- '[copy misc] report installation of ylwrap'
+ set +x
ok 402 - [copy misc] report installation of ylwrap
PASS: t/add-missing.tap 402 - [copy misc] report installation of ylwrap
+ for f in $files
+ command_ok_ '[copy misc] report installation of config.sub' /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] report installation of config.sub'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.sub'\''' stderr
configure.ac:5: installing 'build-aux/config.sub'
+ result_ ok -D '' -r '' -- '[copy misc] report installation of config.sub'
+ set +x
ok 403 - [copy misc] report installation of config.sub
PASS: t/add-missing.tap 403 - [copy misc] report installation of config.sub
+ for f in $files
+ command_ok_ '[copy misc] report installation of config.guess' /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] report installation of config.guess'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ /bin/grep -F ': installing '\''build-aux/config.guess'\''' stderr
configure.ac:5: installing 'build-aux/config.guess'
+ result_ ok -D '' -r '' -- '[copy misc] report installation of config.guess'
+ set +x
ok 404 - [copy misc] report installation of config.guess
PASS: t/add-missing.tap 404 - [copy misc] report installation of config.guess
+ all_files='install-sh missing  py-compile depcomp ylwrap config.sub config.guess'
+ for f in $all_files
+ echo install-sh
+ for f in $all_files
+ echo missing
+ for f in $all_files
+ echo py-compile
+ for f in $all_files
+ echo depcomp
+ for f in $all_files
+ echo ylwrap
+ for f in $all_files
+ echo config.sub
+ for f in $all_files
+ echo config.guess
+ sort
+ uniq
+ cd build-aux
+ sort
+ ls
+ cat files.exp
config.guess
config.sub
depcomp
install-sh
missing
py-compile
ylwrap
+ cat files.got
config.guess
config.sub
depcomp
install-sh
missing
py-compile
ylwrap
+ command_ok_ '[copy misc] all and only expected files installed' diff -u files.exp files.got
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] all and only expected files installed'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ diff -u files.exp files.got
+ result_ ok -D '' -r '' -- '[copy misc] all and only expected files installed'
+ set +x
ok 405 - [copy misc] all and only expected files installed
PASS: t/add-missing.tap 405 - [copy misc] all and only expected files installed
+ for f in $files
+ test yes = no
+ test -h build-aux/py-compile
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy misc] py-compile has not been symlinked'
+ result_ ok '[copy misc] py-compile has not been symlinked'
+ set +x
ok 406 - [copy misc] py-compile has not been symlinked
PASS: t/add-missing.tap 406 - [copy misc] py-compile has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/depcomp
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy misc] depcomp has not been symlinked'
+ result_ ok '[copy misc] depcomp has not been symlinked'
+ set +x
ok 407 - [copy misc] depcomp has not been symlinked
PASS: t/add-missing.tap 407 - [copy misc] depcomp has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/ylwrap
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy misc] ylwrap has not been symlinked'
+ result_ ok '[copy misc] ylwrap has not been symlinked'
+ set +x
ok 408 - [copy misc] ylwrap has not been symlinked
PASS: t/add-missing.tap 408 - [copy misc] ylwrap has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.sub
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy misc] config.sub has not been symlinked'
+ result_ ok '[copy misc] config.sub has not been symlinked'
+ set +x
ok 409 - [copy misc] config.sub has not been symlinked
PASS: t/add-missing.tap 409 - [copy misc] config.sub has not been symlinked
+ for f in $files
+ test yes = no
+ test -h build-aux/config.guess
+ is_symlink=no
+ case $action,$is_symlink in
+ ok_ '[copy misc] config.guess has not been symlinked'
+ result_ ok '[copy misc] config.guess has not been symlinked'
+ set +x
ok 410 - [copy misc] config.guess has not been symlinked
PASS: t/add-missing.tap 410 - [copy misc] config.guess has not been symlinked
+ AUTOMAKE_run -d '[copy misc] automake finds all added files'
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__desc='[copy misc] automake finds all added files'
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ cat stderr
+ cat stdout
+ test tap = none
+ test -z '[copy misc] automake finds all added files'
+ command_ok_ '[copy misc] automake finds all added files' test 0 -eq 0
+ tap_directive_=
+ tap_reason_=
+ test 5 -gt 0
+ tap_description_='[copy misc] automake finds all added files'
+ shift
+ test 4 -gt 0
+ case $1 in
+ break
+ tap_result_=ok
+ test 0 -eq 0
+ result_ ok -D '' -r '' -- '[copy misc] automake finds all added files'
+ set +x
ok 411 - [copy misc] automake finds all added files
PASS: t/add-missing.tap 411 - [copy misc] automake finds all added files
+ cd ..
+ cd /sources/automake-1.16.1/t/add-missing.dir
+ :
+ am_exit_trap 0
+ exit_status=0
+ set +e
+ cd /sources/automake-1.16.1
+ test tap = tap
+ test later = later
+ test 0 -eq 0
+ plan_ now
+ test 1 -eq 0
+ test 1 -ge 2
+ test xlater '!=' xnone
+ test xlater '!=' xlater
+ test xnow = xunknown
+ test xnow = xlater
+ test xnow = xlazy
+ test xnow = xnow
+ planned_=411
+ echo 1..411
1..411
+ test 0 -eq 0
+ test 411 -eq 411
+ am_keeping_testdirs
+ case $keep_testdirs in
+ return 1
+ rm_rf_ t/add-missing.dir
+ test 1 -gt 0
+ /usr/bin/perl /sources/automake-1.16.1/t/ax/deltree.pl t/add-missing.dir
+ set +x
