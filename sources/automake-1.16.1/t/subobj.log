Running from installcheck: no
Test Protocol: none
PATH = /sources/automake-1.16.1/bin:/sources/automake-1.16.1/t/ax:/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin
++ pwd
/sources/automake-1.16.1/t/subobj.dir
+ cat
+ aclocal-1.16 -Werror
+ :
+ cat
+ mkdir sub
+ cat
+ AUTOMAKE_fails
+ AUTOMAKE_run -e 1
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
automake-1.16: warnings are treated as errors
Makefile.am:3: warning: source file 'generic/a.c' is in a subdirectory,
Makefile.am:3: but option 'subdir-objects' is disabled
automake-1.16: warning: possible forward-incompatibility.
automake-1.16: At least a source file is in a subdirectory, but the 'subdir-objects'
automake-1.16: automake option hasn't been enabled.  For now, the corresponding output
automake-1.16: object file(s) will be placed in the top-level directory.  However,
automake-1.16: this behaviour will change in future Automake versions: they will
automake-1.16: unconditionally cause object files to be placed in the same subdirectory
automake-1.16: of the corresponding sources.
automake-1.16: You are advised to start using 'subdir-objects' option throughout your
automake-1.16: project, to avoid future incompatibilities.
Makefile.am:3: warning: source file 'another/z.cxx' is in a subdirectory,
Makefile.am:3: but option 'subdir-objects' is disabled
sub/Makefile.am:1: warning: source file 'generic/b.c' is in a subdirectory,
sub/Makefile.am:1: but option 'subdir-objects' is disabled
sub/Makefile.am:1: warning: source file 'more/r.y' is in a subdirectory,
sub/Makefile.am:1: but option 'subdir-objects' is disabled
+ cat stdout
+ test none = none
+ test 1 -eq 1
+ return
+ grep '^Makefile\.am:3:.*'\''generic/a\.c'\''.* in a subdirectory' stderr
Makefile.am:3: warning: source file 'generic/a.c' is in a subdirectory,
+ grep '^Makefile\.am:[34]:.*'\''another/z\.cxx'\''.* in a subdirectory' stderr
Makefile.am:3: warning: source file 'another/z.cxx' is in a subdirectory,
+ grep '^sub/Makefile\.am:1:.*'\''generic/b\.c'\''.* in a subdirectory' stderr
sub/Makefile.am:1: warning: source file 'generic/b.c' is in a subdirectory,
+ grep 'option '\''subdir-objects'\'' is disabled' stderr
Makefile.am:3: but option 'subdir-objects' is disabled
Makefile.am:3: but option 'subdir-objects' is disabled
sub/Makefile.am:1: but option 'subdir-objects' is disabled
sub/Makefile.am:1: but option 'subdir-objects' is disabled
+ for msg in "possible forward-incompatibility" "advi[sc]e.* 'subdir-objects' option throughout" "unconditionally.* object file.* same subdirectory"
++ grep -c 'possible forward-incompatibility' stderr
+ test 1 -eq 1
+ for msg in "possible forward-incompatibility" "advi[sc]e.* 'subdir-objects' option throughout" "unconditionally.* object file.* same subdirectory"
++ grep -c 'advi[sc]e.* '\''subdir-objects'\'' option throughout' stderr
+ test 1 -eq 1
+ for msg in "possible forward-incompatibility" "advi[sc]e.* 'subdir-objects' option throughout" "unconditionally.* object file.* same subdirectory"
++ grep -c 'unconditionally.* object file.* same subdirectory' stderr
+ test 1 -eq 1
+ grep 'subdir-object([^s]|$)' stderr
+ automake-1.16 --foreign -Werror -Wall -Wno-unsupported
+ echo AUTOMAKE_OPTIONS = subdir-objects
+ AUTOMAKE_fails
+ AUTOMAKE_run -e 1
+ am__desc=
+ am__exp_rc=0
+ test 2 -gt 0
+ case $1 in
+ am__exp_rc=1
+ shift
+ shift
+ test 0 -gt 0
+ am__got_rc=0
+ automake-1.16 --foreign -Werror -Wall
+ am__got_rc=1
+ cat stderr
automake-1.16: warnings are treated as errors
sub/Makefile.am:1: warning: source file 'generic/b.c' is in a subdirectory,
sub/Makefile.am:1: but option 'subdir-objects' is disabled
automake-1.16: warning: possible forward-incompatibility.
automake-1.16: At least a source file is in a subdirectory, but the 'subdir-objects'
automake-1.16: automake option hasn't been enabled.  For now, the corresponding output
automake-1.16: object file(s) will be placed in the top-level directory.  However,
automake-1.16: this behaviour will change in future Automake versions: they will
automake-1.16: unconditionally cause object files to be placed in the same subdirectory
automake-1.16: of the corresponding sources.
automake-1.16: You are advised to start using 'subdir-objects' option throughout your
automake-1.16: project, to avoid future incompatibilities.
sub/Makefile.am:1: warning: source file 'more/r.y' is in a subdirectory,
sub/Makefile.am:1: but option 'subdir-objects' is disabled
+ cat stdout
+ test none = none
+ test 1 -eq 1
+ return
+ grep '^Makefile\.am' stderr
+ grep '^sub/Makefile\.am:.*'\''generic/b\.c'\''.* in a subdirectory' stderr
sub/Makefile.am:1: warning: source file 'generic/b.c' is in a subdirectory,
+ grep 'option '\''subdir-objects'\'' is disabled' stderr
sub/Makefile.am:1: but option 'subdir-objects' is disabled
sub/Makefile.am:1: but option 'subdir-objects' is disabled
+ sed 's/^AM_INIT_AUTOMAKE/&([subdir-objects])/' configure.ac
+ mv -f configure.tmp configure.ac
+ aclocal-1.16 -Werror --force
+ automake-1.16 --foreign -Werror -Wall
+ rm -f compile
+ automake-1.16 --foreign -Werror -Wall --add-missing
+ cat stderr
configure.ac:4: installing './compile'
+ grep '^configure\.ac:[48]:.*install.*compile' stderr
configure.ac:4: installing './compile'
+ test -f compile
+ grep '^generic/a\.\$(OBJEXT):' Makefile.in
generic/a.$(OBJEXT): generic/$(am__dirstamp) \
+ grep '^generic/b\.\$(OBJEXT):' sub/Makefile.in
generic/b.$(OBJEXT): generic/$(am__dirstamp) \
+ grep '^another/z\.\$(OBJEXT):' Makefile.in
another/z.$(OBJEXT): another/$(am__dirstamp) \
+ /bin/grep -E '(^|[^/])[abz]\.\$(OBJEXT)' Makefile.in sub/Makefile.in
+ grep '^another/z\.\$(OBJEXT):.*dirstamp' Makefile.in
another/z.$(OBJEXT): another/$(am__dirstamp) \
+ grep '^generic/b\.\$(OBJEXT):.*dirstamp' sub/Makefile.in
generic/b.$(OBJEXT): generic/$(am__dirstamp) \
+ :
+ am_exit_trap 0
+ exit_status=0
+ set +e
+ cd /sources/automake-1.16.1
+ test none = tap
+ case $am_explicit_skips in
+ test 0 -eq 0
+ am_keeping_testdirs
+ case $keep_testdirs in
+ return 1
+ rm_rf_ t/subobj.dir
+ test 1 -gt 0
+ /usr/bin/perl /sources/automake-1.16.1/t/ax/deltree.pl t/subobj.dir
+ set +x
PASS t/subobj.sh (exit status: 0)
